(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cd200c1"],{5514:function(t,e,a){"use strict";var i=a("b532"),s=a.n(i);s.a},6638:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".wx-info[data-v-58cbb242]{width:100%;position:absolute;left:0;top:100px;bottom:0;overflow:hidden}.wx-info[data-v-58cbb242]::-webkit-scrollbar{width:2px;height:100%}.wx-info[data-v-58cbb242]::-webkit-scrollbar-track-piece{background-color:#fff}.wx-info[data-v-58cbb242]::-webkit-scrollbar-thumb{background:#fff}#components-layout-demo-basic[data-v-58cbb242]{height:100%}#components-layout-demo-basic .ant-layout-header[data-v-58cbb242]{background:#fff;border-bottom:1px solid #e2e2e2;height:50px;min-width:885px;width:100%;line-height:50px}[data-v-58cbb242] .ant-layout-header{padding:0 20px;font-size:16px;text-align:left}#components-layout-demo-basic .ant-layout-sider[data-v-58cbb242]{background:#fff;-webkit-box-flex:0!important;-ms-flex:0 0 250px!important;flex:0 0 250px!important;max-width:250px!important;min-width:250px!important;width:250px!important;border-right:1px solid #e2e2e2}#components-layout-demo-basic .ant-layout-content[data-v-58cbb242]{margin:0 20px 20px;min-width:885px;width:100%;padding-right:40px}.content-hd[data-v-58cbb242]{height:60px;width:100%;min-width:885px;line-height:60px}.content-msg[data-v-58cbb242]{width:100%;border:1px solid #ffdda6;background:#fff2db;padding:10px;margin-top:12px}.msg-info[data-v-58cbb242]{color:#ffdda6;margin-right:10px}.content-bd[data-v-58cbb242]{background:#fff;min-height:120px;border:1px solid #e2e2e2;min-width:885px;width:100%}#components-layout-demo-basic>.ant-layout[data-v-58cbb242]{margin-bottom:48px}#components-layout-demo-basic>.ant-layout[data-v-58cbb242]:last-child{margin:0}.ant-layout.ant-layout-has-sider[data-v-58cbb242],.list[data-v-58cbb242]{height:100%}.content-hd-left[data-v-58cbb242]{float:left}.content-hd-right[data-v-58cbb242]{float:right}.btn-primary[data-v-58cbb242]{margin-left:20px}.sider-one[data-v-58cbb242]{padding:0 20px}.sider-one-txt[data-v-58cbb242]{height:60px;line-height:60px;text-align:left}.selectWx[data-v-58cbb242]{width:200px;margin-left:20px;height:50px;line-height:50px;cursor:pointer;padding-left:10px}.active[data-v-58cbb242]{background:#1e90ff;color:#fff}.tag-name[data-v-58cbb242]{padding:6px 14px;height:34px;font-size:13px;border:1px solid #d9d9d9;background-color:transparent!important;color:rgba(0,0,0,.65)}[data-v-58cbb242] .dark-row{background:#fafafa}[data-v-58cbb242] .light-row{background:#fff}",""])},b532:function(t,e,a){var i=a("6638");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("b03aac82",i,!0,{sourceMap:!1,shadowMode:!1})},e79c:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("div",{attrs:{id:"components-layout-demo-basic"}},[a("a-layout",{staticStyle:{position:"relative",height:"100%",overflow:"hidden"}},[t.wxLen>1?a("a-layout-sider",[a("div",{staticClass:"sider-one"},[a("div",{staticClass:"sider-one-txt"},[t._v("选择公众号")]),t.wxInfo[0]?a("a-select",{staticStyle:{width:"200px","margin-bottom":"20px"},attrs:{showSearch:"",optionFilterProp:"children"},on:{change:t.handleChange},model:{value:t.changeBackground,callback:function(e){t.changeBackground=e},expression:"changeBackground"}},[t._l(t.wxInfo,(function(e){return[a("a-select-option",{attrs:{value:e.wx_id}},[t._v(t._s(e.nick_name))])]}))],2):t._e(),a("div",{ref:"wxInfo",staticClass:"wx-info",on:{mousemove:t.wxInfoMouseOver,mouseout:t.wxInfoMouseOut}},[t._l(t.wxInfo,(function(e,i){return[a("div",{staticClass:"selectWx",class:{active:t.changeBackground==e.wx_id},on:{click:function(a){return t.selectWx(e.wx_id,e.authorizer_type,e.nick_name,e.verify_type)}}},[a("a-avatar",{attrs:{src:e.head_img,shape:"square"}}),a("span",{staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden",float:"right",width:"calc(100% - 35px)"}},[t._v(t._s(e.nick_name))])],1)]}))],2)],1)]):t._e(),a("a-layout",{staticClass:"scroll",staticStyle:{position:"absolute",top:"0",bottom:"0",right:"0","overflow-x":"hidden","overflow-y":"auto"},style:t.wxLen>1?{left:"250px"}:{left:"0px"}},[a("a-layout-header",[t._v("标签管理")]),a("a-layout-content",[a("div",{staticClass:"content-msg"},[a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t\t1、在本系统内创建的标签会自动同步到微信公众平台，微信公众平台产生的标签需要进行手动同步到本系统内，标签的同步保证了粉丝数据的一致性。")]),a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t\t2、若公众平台已存在某微信标签，而在本系统内又尚无手动同步过该标签。此时，在本系统内新建该标签名，则会提示“该标签名称与微信标签重复，请手动同步微信标签即可。”")]),a("p",{staticStyle:{"margin-bottom":"0"}},[t._v("3、标签总数量最多为 100 个，每个粉丝最多被打上 20 个标签。")])]),a("div",{staticClass:"content-hd"},[a("div",{staticClass:"content-hd-left"},[t._v("\n\t\t\t\t\t\t\t\t共有\n\t\t\t\t\t\t\t\t"),a("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.total))]),t._v("个标签\n\t\t\t\t\t\t\t")]),a("div",{staticClass:"content-hd-right"},[t.lastTagTime?a("label",[t._v("最后一次同步时间："+t._s(t.lastTagTime))]):t._e(),"unauthorized"!=this.$store.state.authorizer_type&&t.verify_service?a("a-button",{directives:[{name:"has",rawName:"v-has",value:"tag-wx-sync",expression:"'tag-wx-sync'"}],staticClass:"btn-primary",attrs:{icon:"reload"},on:{click:function(e){return t.sysTag()}}},[t._v("\n\t\t\t\t\t\t\t\t\t同步微信标签\n\t\t\t\t\t\t\t\t")]):t._e(),"unauthorized"!=this.$store.state.authorizer_type&&t.verify_service?t._e():a("a-button",{directives:[{name:"has",rawName:"v-has",value:"tag-wx-sync",expression:"'tag-wx-sync'"}],staticClass:"btn-primary",attrs:{icon:"reload"},on:{click:t.showConfirmWx}},[t._v("\n\t\t\t\t\t\t\t\t\t同步微信标签\n\t\t\t\t\t\t\t\t")]),"unauthorized"!=this.$store.state.authorizer_type&&t.verify_service?a("a-button",{directives:[{name:"has",rawName:"v-has",value:"tag-add",expression:"'tag-add'"}],staticClass:"btn-primary",attrs:{icon:"plus",type:"primary"},on:{click:function(e){return t.showModal("add")}}},[t._v("\n\t\t\t\t\t\t\t\t\t新建标签\n\t\t\t\t\t\t\t\t")]):t._e(),"unauthorized"!=this.$store.state.authorizer_type&&t.verify_service?t._e():a("a-button",{directives:[{name:"has",rawName:"v-has",value:"tag-add",expression:"'tag-add'"}],staticClass:"btn-primary",attrs:{icon:"plus",type:"primary"},on:{click:t.showConfirmWx}},[t._v("\n\t\t\t\t\t\t\t\t\t新建标签\n\t\t\t\t\t\t\t\t")]),a("a-modal",{attrs:{title:"新建标签",confirmLoading:t.confirmLoading3},on:{ok:function(e){return t.handleOk(t.inputValue)},cancel:t.cancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("p",{staticStyle:{margin:"0px 0px 10px 0","font-size":"13px",color:"#909399"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t每个标签名称最多6个字。同时新建多个标签时，请用“空格”隔开")]),a("a-input",{attrs:{placeholder:"请输入标签（不得超过6个字符）"},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}})],1)],1)]),a("div",{staticClass:"content-bd"},[a("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[a("a-table",{directives:[{name:"has",rawName:"v-has",value:"tag-list",expression:"'tag-list'"}],attrs:{columns:t.columns,dataSource:t.tagsList,pagination:!1,rowClassName:t.rowClassName},scopedSlots:t._u([{key:"tags",fn:function(e){return a("span",{},[a("a-tag",{staticClass:"tag-name",attrs:{color:"#2db7f5"}},[t._v(t._s(e))])],1)}},{key:"action",fn:function(e,i){return a("span",{},["unauthorized"!=t.$store.state.authorizer_type&&t.verify_service?a("span",{directives:[{name:"has",rawName:"v-has",value:"tag-edit",expression:"'tag-edit'"}],staticStyle:{color:"#1890FF","margin-right":"25px",cursor:"pointer"},on:{click:function(a){return t.showModal2(e,i)}}},[t._v("编辑")]):t._e(),"unauthorized"!=t.$store.state.authorizer_type&&t.verify_service?t._e():a("span",{directives:[{name:"has",rawName:"v-has",value:"tag-edit",expression:"'tag-edit'"}],staticStyle:{color:"#1890FF","margin-right":"25px",cursor:"pointer"},on:{click:t.showConfirmWx}},[t._v("编辑")]),"unauthorized"!=t.$store.state.authorizer_type&&t.verify_service?a("span",{directives:[{name:"has",rawName:"v-has",value:"tag-delete",expression:"'tag-delete'"}],staticStyle:{color:"#1890FF",cursor:"pointer"},on:{click:function(a){return t.showModal3(e,i)}}},[t._v("删除")]):t._e(),"unauthorized"!=t.$store.state.authorizer_type&&t.verify_service?t._e():a("span",{directives:[{name:"has",rawName:"v-has",value:"tag-delete",expression:"'tag-delete'"}],staticStyle:{color:"#1890FF",cursor:"pointer"},on:{click:t.showConfirmWx}},[t._v("删除")])])}}])},[a("span",{attrs:{slot:"customTitle"},slot:"customTitle"},[t._v("\n                  微信后台粉丝数\n                  "),a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v("在本系统上操作的标签，可以自动同步到微信后台。如因在其他平台操作所导致的差别较大，请手动同步粉丝。")])]),a("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1)]),a("a-modal",{attrs:{title:"修改标签名称",confirmLoading:t.confirmLoading},on:{ok:t.handleOk2},model:{value:t.visible2,callback:function(e){t.visible2=e},expression:"visible2"}},[a("a-input",{attrs:{placeholder:"请输入标签",maxLength:6},model:{value:t.inputValue2,callback:function(e){t.inputValue2=e},expression:"inputValue2"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[a("span",[t._v(t._s(t.inputValue2.length))]),t._v("/6\n                  ")])])],1),a("a-modal",{attrs:{title:"删除粉丝标签",confirmLoading:t.confirmLoading2},on:{ok:t.handleOk3},model:{value:t.visible3,callback:function(e){t.visible3=e},expression:"visible3"}},[a("div",{staticStyle:{margin:"19px 0px"}},[a("a-icon",{staticStyle:{color:"#F7BA2A","font-size":"25px","margin-right":"10px"},attrs:{type:"exclamation-circle"}}),a("span",{staticStyle:{display:"inline-block",width:"90%","line-height":"26px","vertical-align":"top","white-space":"normal","word-break":"break-all"}},[a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.inputValue3))]),t._v("  标签删除后，则相应的用户失去了该标签属性。确定删除吗？")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"},{name:"has",rawName:"v-has",value:"tag-list",expression:"'tag-list'"}],staticClass:"pagination",staticStyle:{margin:"20px auto",height:"32px"}},[a("a-pagination",{attrs:{total:t.total,showSizeChanger:"",showQuickJumper:t.quickJumper,current:t.page,pageSize:t.pageSize,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage,showSizeChange:t.showSizeChange}})],1)],1)],1)])],1)],1)],1)])},s=[],n=(a("7f7f"),a("96cf"),a("3b8d")),o=(a("28a5"),a("f64c")),r=[{title:"标签名称",dataIndex:"name",width:"25%",scopedSlots:{customRender:"tags"},key:"name"},{title:"粉丝数",dataIndex:"fans_num",width:"25%",key:"fans_num"},{dataIndex:"wx_fans_num",key:"wx_fans_num",slots:{title:"customTitle"},scopedSlots:{customRender:"wx_fans_num"}},{title:"操作",dataIndex:"action",width:"25%",key:"action",scopedSlots:{customRender:"action"}}],c={data:function(){var t=localStorage.getItem("wxNum")?localStorage.getItem("wxNum"):"";return{lastTagTime:"",tagsList:[],isLoading:!0,columns:r,wxLen:JSON.parse(localStorage.getItem("wxArr")).length,wxInfo:[],verify_service:!1,visible:!1,inputValue:"",newTagList:[],visible2:!1,inputValue2:"",tagId:"",visible3:!1,inputValue3:"",total:1,quickJumper:!1,page:1,page_size:15,pageSize:15,changeBackground:t,confirmLoading:!1,confirmLoading2:!1,confirmLoading3:!1,oldValue:""}},methods:{rowClassName:function(t,e){var a="dark-row";return e%2===0&&(a="light-row"),a},wxInfoMouseOver:function(){this.$refs.wxInfo.style.overflowY="auto"},wxInfoMouseOut:function(){this.$refs.wxInfo.style.overflowY="hidden"},handleChange:function(t){var e=this;this.verify_service=!1,this.wxInfo.map((function(a){t==a.wx_id&&(e.$store.commit("changeAuthorizerType",a.authorizer_type),e.$store.commit("changeWxNickName",a.nick_name),"已认证"==a.verify_type&&(e.verify_service=!0))})),this.$store.dispatch("changeWxNum",t),this.getTags(),this.isLoading=!0,this.changeBackground=t,2==localStorage.getItem("isMasterAccount")&&this.$store.dispatch("getPermissionButton")},selectWx:function(t,e,a,i){this.verify_service=!1,"已认证"==i&&(this.verify_service=!0),this.$store.dispatch("changeWxNum",t),this.getTags(),this.isLoading=!0,this.changeBackground=t,this.$store.commit("changeAuthorizerType",e),this.$store.commit("changeWxNickName",a),2==localStorage.getItem("isMasterAccount")&&this.$store.dispatch("getPermissionButton")},showConfirmWx:function(){if("unauthorized"!=this.$store.state.authorizer_type)return this.$success({title:"仅针对认证的订阅号或服务号开放使用"}),!1;this.$success({title:this.$store.state.wxNickName+"已取消授权，无法操作"})},showModal:function(){this.visible=!0},handleOk:function(t){var e=this;if(e.confirmLoading3=!0,e.tagsList.length>=100)return e.$message.warning("每个公众号最多添加100个标签！"),e.confirmLoading3=!1,!1;if(""==t)return e.$message.warning("不能为空"),e.confirmLoading3=!1,!1;for(var a=0;a<t.split(" ").length;a++){if(t.split(" ")[a].length>6)return e.$message.error("每个标签最多6个字"),e.confirmLoading3=!1,e.inputValue="",!1;t.split(" ")[a].length>0&&(e.newTagList.push(t.split(" ")[a]),e.confirmLoading3=!1)}e.addTags(),e.newTagList=[],e.inputValue=""},addTags:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("tags/tags-create",{wx_id:localStorage.getItem("wxNum"),tag_name:this.newTagList});case 2:e=t.sent,a=e.data,0!=a.error?"标签名非法，请注意不能和其他标签重名"==a.error_msg?this.$message.error("该标签名称与微信标签重复，请手动同步微信标签即可。"):this.$message.error(a.error_msg):(this.isLoading=!0,this.getTags(),this.inputValue="",this.newTagList=[]);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),cancel:function(){this.inputValue="",this.visible=!1},showModal2:function(t,e){this.visible2=!0,this.oldValue=e.name,this.inputValue2=e.name,this.tagId=e.key},handleOk2:function(t){if(this.confirmLoading=!0,""==this.inputValue2)return this.$message.error("请填写标签名称"),this.confirmLoading=!1,!1;this.inputValue2==this.oldValue?(this.$message.success("提交成功"),this.confirmLoading=!1,this.visible2=!1):this.editTag()},editTag:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("tags/tags-update",{wx_id:localStorage.getItem("wxNum"),tag_name:this.inputValue2,tag_id:this.tagId});case 2:e=t.sent,a=e.data,0!=a.error?(this.$message.error(a.error_msg),this.confirmLoading=!1):(this.$message.success("修改成功"),this.getTags(this.page,this.pageSize));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showModal3:function(t,e){this.visible3=!0,this.tagId=e.key,this.inputValue3=e.name},handleOk3:function(t){this.confirmLoading2=!0,this.deleteTags()},deleteTags:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("tags/tags-del",{wx_id:localStorage.getItem("wxNum"),tag_id:this.tagId});case 2:e=t.sent,a=e.data,0!=a.error?(this.$message.error(a.error_msg),this.confirmLoading2=!1):this.page>1&&1==this.tagsList.length?this.getTags(this.page-1,this.pageSize):this.getTags(this.page,this.pageSize);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),sysTag:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.next=3,this.axios.post("tags/refresh-tags-list",{wx_id:localStorage.getItem("wxNum")});case 3:e=t.sent,a=e.data,0!=a.error?(this.isLoading=!1,this.$message.info("已进入后台刷新中，请耐心等待...",2.5).then((function(){return i.$message.error(a.error_msg,2.5)}))):(o["a"].info("已进入后台刷新中，请耐心等待..."),this.getTags());case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getTags:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:1,a=n.length>1&&void 0!==n[1]?n[1]:this.pageSize,this.wxInfo=this.$store.state.wxArr,t.next=5,this.axios.post("tags/tags-get-all",{wx_id:localStorage.getItem("wxNum"),page:e,pageSize:a});case 5:i=t.sent,s=i.data,0!=s.error?(this.isLoading=!1,this.$message.error(s.error_msg),this.confirmLoading=!1):(this.tagsList=s.data.info,this.lastTagTime=s.data.last_tag_time,this.isLoading=!1,this.total=parseInt(s.data.count),this.page=e,this.pageSize=a,this.quickJumper=this.total>this.pageSize,this.confirmLoading=!1,this.visible2=!1,this.confirmLoading2=!1,this.visible3=!1,this.confirmLoading3=!1,this.visible=!1);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changePage:function(t,e){this.getTags(t,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,120)}))},showSizeChange:function(t,e){this.getTags(1,e)}},created:function(){var t=this;this.$store.dispatch("getWx",(function(e){t.wxInfo=e,!t.changeBackground&&t.wxInfo.length>0&&(t.changeBackground=t.$store.state.wxNum)})),this.verify_service="已认证"===this.wxInfo[this.$store.state.wxNumIndex].verify_type,this.getTags()}},l=c,h=(a("5514"),a("2877")),u=Object(h["a"])(l,i,s,!1,null,"58cbb242",null);e["default"]=u.exports}}]);