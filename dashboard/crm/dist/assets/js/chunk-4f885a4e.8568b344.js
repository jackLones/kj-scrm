(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f885a4e"],{"07c76":function(t,a,e){var n=e("915d");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("499e").default;i("7a3a2abe",n,!0,{sourceMap:!1,shadowMode:!1})},"8d15":function(t,a,e){"use strict";var n=e("07c76"),i=e.n(n);i.a},"915d":function(t,a,e){a=t.exports=e("2350")(!1),a.push([t.i,".current0[data-v-186cebe9]{margin-bottom:1.5%}[data-v-186cebe9] .ant-spin-container{height:100%}[data-v-186cebe9] .ant-input-number-handler-wrap{display:none}[data-v-186cebe9] .ant-input-affix-wrapper .ant-input:not(:last-child){padding-right:50px}",""])},f9f1:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"100%","overflow-y":"auto",position:"absolute",width:"100%"}},[e("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[e("div",{staticStyle:{height:"50px","line-height":"50px","background-color":"#FFFFFF",padding:"0 20px","font-size":"16px"}},[t.editId?t._e():e("span",[t._v("新建")]),t.editId?e("span",[t._v("编辑")]):t._e(),t._v("红包规则\n\t\t\t"),e("a-button",{staticStyle:{"font-size":"14px",float:"right","margin-top":"9px"},attrs:{type:"primary",icon:"rollback"},on:{click:t.goBack}},[t._v("返回列表\n\t\t\t")])],1),e("div",{staticStyle:{"background-color":"#FFFFFF",margin:"10px 20px 80px 20px"}},[e("a-form",{staticStyle:{padding:"20px"}},[e("a-form-item",{staticClass:"current0",attrs:{"label-col":{span:3},"wrapper-col":{span:19}}},[e("span",{attrs:{slot:"label"},slot:"label"},[e("span",{staticStyle:{color:"#FF562D"}},[t._v("*")]),t._v("规则名称\n\t\t\t\t")]),e("a-input",{staticStyle:{width:"340px"},attrs:{placeholder:"请输入红包规则",maxLength:30},model:{value:t.name,callback:function(a){t.name=a},expression:"name"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[e("span",[t._v(t._s(t.name.length))]),t._v("/30\n                        ")])])],1),e("a-form-item",{staticClass:"current0",attrs:{"label-col":{span:3},"wrapper-col":{span:19}}},[e("span",{attrs:{slot:"label"},slot:"label"},[e("span",{staticStyle:{color:"#FF562D"}},[t._v("*")]),t._v("单个红包金额\n\t\t\t\t")]),e("a-radio-group",{attrs:{name:"radioGroup",value:t.type},on:{change:t.changeType}},[e("a-radio",{staticStyle:{display:"inline-block",height:"35px","line-height":"35px"},attrs:{value:1}},[t._v("定额\n\t\t\t\t\t\t\t"),1==t.type?e("span",[e("a-input-number",{staticStyle:{width:"140px",margin:"0 5px"},attrs:{step:0,precision:2,min:.3,max:200},model:{value:t.fixed_amount,callback:function(a){t.fixed_amount=a},expression:"fixed_amount"}}),t._v("元\n\t\t\t\t\t\t\t")],1):t._e()]),e("a-radio",{staticStyle:{display:"inline-block",height:"35px","line-height":"35px","margin-left":"25px"},attrs:{value:2}},[t._v("\n\t\t\t\t\t\t\t按随机金额\n\t\t\t\t\t\t\t"),2==t.type?e("span",[e("a-input-number",{staticStyle:{width:"100px",margin:"0 5px"},attrs:{step:0,precision:2,min:.3,max:200},model:{value:t.min_random_amount,callback:function(a){t.min_random_amount=a},expression:"min_random_amount"}}),t._v("元 ——\n\t\t\t\t\t\t\t"),e("a-input-number",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{step:0,precision:2,min:.3,max:200},model:{value:t.max_random_amount,callback:function(a){t.max_random_amount=a},expression:"max_random_amount"}}),t._v("元\n\t\t\t\t\t\t")],1):t._e()])],1),e("div",{staticStyle:{color:"#F56C6C"}},[t._v("（一旦发布，不可修改。精确到小数点后两位，可输入0.30~200.00）")])],1),e("a-form-item",{staticClass:"current0",attrs:{label:"红包封面","label-col":{span:3},"wrapper-col":{span:19}}},[e("a-upload",{attrs:{action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",showUploadList:!1,beforeUpload:t.beforeUpload}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.pic_url,expression:"!pic_url"}]},[e("a-button",[e("a-icon",{attrs:{type:t.loading?"loading":"upload"}}),t._v("\n\t\t\t\t\t\t\t\t上传封面\n\t\t\t\t\t\t\t")],1)],1),e("img",{directives:[{name:"show",rawName:"v-show",value:t.pic_url,expression:"pic_url"}],staticStyle:{"max-width":"128px","max-height":"128px"},attrs:{src:t.commonUrl+t.pic_url}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.pic_url,expression:"pic_url"}],staticStyle:{display:"inline-block","vertical-align":"bottom","margin-left":"5px"}},[e("a-button",[e("a-icon",{attrs:{type:t.loading?"loading":"upload"}}),t._v("\n\t\t\t\t\t\t\t\t替换\n\t\t\t\t\t\t\t")],1)],1),e("div",{staticStyle:{"margin-top":"10px"}},[t._v("\n\t\t\t\t\t\t\t图片像素建议为200px*200px，格式为jpg、jpeg、png，大小不超过2M\n\t\t\t\t\t\t")])])],1),e("a-form-item",{staticClass:"current0",attrs:{"label-col":{span:3},"wrapper-col":{span:19}}},[e("span",{attrs:{slot:"label"},slot:"label"},[e("span",{staticStyle:{color:"#FF562D"}},[t._v("*")]),t._v("标题\n\t\t\t\t")]),e("a-input",{staticStyle:{width:"340px"},attrs:{placeholder:"请填写标题",maxLength:32},model:{value:t.title,callback:function(a){t.title=a},expression:"title"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[e("span",[t._v(t._s(t.title.length))]),t._v("/32\n\t\t\t\t\t")])])],1),e("a-form-item",{staticClass:"current0",attrs:{label:"添加描述","label-col":{span:3},"wrapper-col":{span:19}}},[e("div",[e("a-textarea",{staticStyle:{"max-width":"500px"},attrs:{placeholder:"请填写描述",maxLength:128,rows:4},model:{value:t.des,callback:function(a){t.des=a},expression:"des"}})],1),e("div",{staticStyle:{"max-width":"500px","text-align":"right"}},[e("span",[t._v(t._s(t.des.length))]),t._v("/128\n\t\t\t\t\t")])]),e("a-form-item",{staticClass:"current0",attrs:{label:"感谢语","label-col":{span:3},"wrapper-col":{span:19}}},[e("a-input",{staticStyle:{width:"340px"},attrs:{placeholder:"恭喜发财，大吉大利",maxLength:32},model:{value:t.thanking,callback:function(a){t.thanking=a},expression:"thanking"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[e("span",[t._v(t._s(t.thanking.length))]),t._v("/32\n\t\t\t\t\t")])])],1)],1),e("a-button",{staticStyle:{"margin-left":"50%",transform:"translate(-50%, 0%)","margin-bottom":"10px"},attrs:{type:"primary",loading:t.loading1},on:{click:t.createRule}},[t._v("\n\t\t\t\t提交\n\t\t\t")])],1)])],1)},i=[],r=(e("7f7f"),e("96cf"),e("3b8d")),s=e("c758"),o={name:"RuleAdd",components:{TemplateList:s["default"]},data:function(){return{isLoading:!1,loading1:!1,editId:"",commonUrl:this.$store.state.commonUrl,loading:!1,name:"",type:1,fixed_amount:.3,min_random_amount:"",max_random_amount:"",pic_url:"/static/image/default-redpacket.png",title:"恭喜发财，大吉大利",des:"戳我领取红包~",thanking:"恭喜发财，大吉大利"}},mounted:function(){this.editId=this.$route.query.id?this.$route.query.id:"",this.editId&&(localStorage.setItem("notAllow",1),localStorage.setItem("backUrl","/redForNew/rule"),this.getDetail())},methods:{getDetail:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var a,e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.next=3,this.axios.post("red-pack-rule/rule-info",{uid:localStorage.getItem("uid"),id:this.editId});case 3:a=t.sent,e=a.data,0!=e.error?(this.isLoading=!1,this.$message.error(e.error_msg)):(this.name=e.data.name,this.type=e.data.type,this.fixed_amount=e.data.fixed_amount,this.min_random_amount=e.data.min_random_amount,this.max_random_amount=e.data.max_random_amount,this.pic_url=e.data.pic_url,this.title=e.data.title,this.des=e.data.des,this.thanking=e.data.thanking,this.isLoading=!1);case 6:case"end":return t.stop()}}),t,this)})));function a(){return t.apply(this,arguments)}return a}(),goBack:function(){localStorage.removeItem("notAllow"),localStorage.removeItem("backUrl"),this.$router.push("/redForNew/rule?isRefresh=1")},changeType:function(t){this.type=t.target.value},beforeUpload:function(t){var a="image/jpeg"===t.type||"image/png"===t.type;if(!a)return this.$message.error("封面仅支持jpg、jpeg、png格式！"),!1;var e=t.size/1024/1024<2;if(!e)return this.$message.error("图片大小不超过2M"),!1;this.uploadImage(t)},uploadImage:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a){var e,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e=new FormData,e.append("uid",localStorage.getItem("uid")),e.append("fileInfo",a),t.next=6,this.axios.post("sub-user/upload-image",e);case 6:n=t.sent,i=n.data,0!=i.error?(this.$message.error(i.error_msg),this.loading=!1):(this.pic_url=i.data.local_path,this.loading=!1);case 9:case"end":return t.stop()}}),t,this)})));function a(a){return t.apply(this,arguments)}return a}(),createRule:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var a,e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.loading1=!0,""!=this.name){t.next=6;break}return this.$message.destroy(),this.$message.warning("请输入规则名称"),this.loading1=!1,t.abrupt("return",!1);case 6:if(1!=this.type){t.next=12;break}if(""!=this.fixed_amount){t.next=12;break}return this.$message.destroy(),this.$message.warning("请输入红包金额"),this.loading1=!1,t.abrupt("return",!1);case 12:if(2!=this.type){t.next=25;break}if(""!=this.min_random_amount&&""!=this.max_random_amount){t.next=20;break}return this.$message.destroy(),this.$message.warning("请输入红包金额"),this.loading1=!1,t.abrupt("return",!1);case 20:if(!(this.min_random_amount>=this.max_random_amount)){t.next=25;break}return this.$message.destroy(),this.$message.warning("随机金额最大值必须大于最小值"),this.loading1=!1,t.abrupt("return",!1);case 25:if(""!=this.title.trim()){t.next=30;break}return this.$message.destroy(),this.$message.warning("请填写标题"),this.loading1=!1,t.abrupt("return",!1);case 30:return t.next=32,this.axios.post("red-pack-rule/rule-add",{uid:localStorage.getItem("uid"),id:this.editId,name:this.name,type:this.type,fixed_amount:this.fixed_amount,min_random_amount:this.min_random_amount,max_random_amount:this.max_random_amount,pic_url:this.pic_url,title:this.title,des:this.des,thanking:this.thanking||"恭喜发财，大吉大利"});case 32:a=t.sent,e=a.data,0!=e.error?(this.$message.error(e.error_msg),this.loading1=!1):(this.loading1=!1,this.editId?this.$router.push("/redForNew/rule?isRefresh=1"):this.$router.push("/redForNew/rule"));case 35:case"end":return t.stop()}}),t,this)})));function a(){return t.apply(this,arguments)}return a}()}},l=o,p=(e("8d15"),e("2877")),c=Object(p["a"])(l,n,i,!1,null,"186cebe9",null);a["default"]=c.exports}}]);