(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10c43fac"],{"527b":function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,"#components-layout-demo-basic[data-v-4d2c19c4]{height:100%}#components-layout-demo-basic .ant-layout-header[data-v-4d2c19c4]{background:#fff;border-bottom:1px solid #e2e2e2;height:50px;min-width:885px;width:100%;line-height:50px}[data-v-4d2c19c4] .ant-layout-header{padding:0 20px;font-size:16px;text-align:left}#components-layout-demo-basic .ant-layout-sider[data-v-4d2c19c4]{background:#fff;-webkit-box-flex:0!important;-ms-flex:0 0 250px!important;flex:0 0 250px!important;max-width:250px!important;min-width:250px!important;width:250px!important;border-right:1px solid #e2e2e2}#components-layout-demo-basic .ant-layout-content[data-v-4d2c19c4]{margin:0 20px 20px;min-width:885px;width:100%;padding-right:40px}.content-msg[data-v-4d2c19c4]{width:100%;border:1px solid #ffdda6;background:#fff2db;padding:10px;margin-top:12px}.content-bd[data-v-4d2c19c4],.content-hd[data-v-4d2c19c4]{width:100%;min-width:885px}.content-bd[data-v-4d2c19c4]{background:#fff;min-height:120px;border:1px solid #e2e2e2}#components-layout-demo-basic>.ant-layout[data-v-4d2c19c4]{margin-bottom:48px}#components-layout-demo-basic>.ant-layout[data-v-4d2c19c4]:last-child{margin:0}.ant-layout.ant-layout-has-sider[data-v-4d2c19c4],.list[data-v-4d2c19c4]{height:100%}.btn-primary[data-v-4d2c19c4]{margin-left:20px}[data-v-4d2c19c4] .dark-row{background:#fafafa}[data-v-4d2c19c4] .light-row{background:#fff}[data-v-4d2c19c4] .ant-radio-button-wrapper{width:90px;margin:0;text-align:center}",""])},"5e88":function(t,e,a){var i=a("527b");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("0740c21a",i,!0,{sourceMap:!1,shadowMode:!1})},8179:function(t,e,a){"use strict";var i=a("5e88"),s=a.n(i);s.a},f0d4:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("div",{attrs:{id:"components-layout-demo-basic"}},[a("a-layout",{staticStyle:{position:"relative",height:"100%",overflow:"hidden"}},[a("a-layout",{staticClass:"scroll",staticStyle:{position:"absolute",top:"0",bottom:"0",right:"0","overflow-x":"hidden","overflow-y":"auto"}},[a("a-layout-header",[t._v("红包裂变")]),a("a-layout-content",[a("div",{staticClass:"content-msg"},[t._v("\n\t\t\t\t\t\t玩法：用户拆裂变红包时，会获得首拆红包金额，并立刻入账至用户的微信零钱里，此时在规定时间内，若分享给好友帮拆，好友可获得金额不等的红包作为奖励，即刻到账。当凑齐了相应的好友人数，用户可以获得剩下的红包。反之，如果用户没有分享领取完的话，裂变的红包剩余金额在超过规定时间后则会失效。\n\t\t\t\t\t\t"),a("div",{staticStyle:{margin:"10px 0 2px"}},[t._v("自动发送欢迎语，可能失败的原因\n\t\t\t\t\t\t\t"),a("a-tooltip",{attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("p",{staticStyle:{"margin-bottom":"2px","font-size":"13px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t1、如果企业在企业微信后台为相关成员配置了可用的欢迎语，使用第三方系统配置欢迎语，均不起效，推送的还是企业微信官方的。")]),a("p",{staticStyle:{"margin-bottom":"10px","font-size":"13px"}}),a("p",{staticStyle:{"margin-bottom":"2px","font-size":"13px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t2、客户和企业成员已经开始聊天的场景下，不能发送欢迎语。")]),a("p",{staticStyle:{"margin-bottom":"10px","font-size":"13px"}}),a("p",{staticStyle:{"margin-bottom":"2px","font-size":"13px"}},[t._v("3、客户之前添加过A企业成员，\n\t\t\t\t\t\t\t\t\t\t不论客户是否将该成员删除，但凡再通过裂变活动添加上该A企业成员，受限于企业微信官方规则，可能会造成推送其他渠道（包含正在进行中的裂变活动）的欢迎语，也有可能不再推送。")]),a("p",{staticStyle:{"margin-bottom":"10px","font-size":"13px"}}),a("p",{staticStyle:{"margin-bottom":"0","font-size":"13px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t4、每次添加新的客户时，当存在多个企业自建应用或是第三方应用设置了欢迎语，那么企业微信官方采取优先权的推送，所以存在有的客户接收不到欢迎语。请商户根据实际使用需求，合理配置，避免冲突。")])]),a("a-icon",{attrs:{type:"question-circle"}})],2)],1),a("p",{staticStyle:{margin:"10px 0 2px",color:"red"}},[t._v("\n\t\t\t\t\t\t\t在使用派发红包功能前，需要商户完成以下配置：\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t1、前往"),a("a",{attrs:{href:"https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F",target:"_blank"}},[t._v("【微信支付商户平台】")]),t._v("注册微信支付商户号\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t2、登录"),a("a",{attrs:{href:"https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome_baidu",target:"_blank"}},[t._v("【企业微信后台】")]),t._v("开通企业支付，绑定已有商户号（"),a("a",{attrs:{href:"https://support.qq.com/products/104790/faqs/66072",target:"_blank"}},[t._v("查看教程")]),t._v("）\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t3、登录"),a("a",{attrs:{href:"https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F",target:"_blank"}},[t._v("【微信支付商户平台】")]),t._v("开通【企业付款到零钱】（"),a("a",{attrs:{href:"https://support.qq.com/products/104790/faqs/66076",target:"_blank"}},[t._v("查看教程")]),t._v("）\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t4、在本系统，进入【应用中心】--【企业支付】，点击，填入企业支付的应用ID和Secret\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t5、在本系统，进入【应用中心】--【企业支付】，点击，完成支付配置。（"),a("a",{attrs:{href:"https://support.qq.com/products/104790/faqs/66058",target:"_blank"}},[t._v("查看教程")]),t._v("）\n\t\t\t\t\t\t")])]),a("div",{staticClass:"content-hd"},[a("div",{staticStyle:{overflow:"hidden",margin:"20px 0"}},[a("a-col",{staticStyle:{float:"left"}},[t.corpLen>1?a("a-select",{staticStyle:{width:"210px","margin-right":"10px"},attrs:{showSearch:"",optionFilterProp:"children"},on:{change:t.handleChange},model:{value:t.corpId,callback:function(e){t.corpId=e},expression:"corpId"}},[t._l(t.corpInfo,(function(e){return[a("a-select-option",{attrs:{value:e.corpid}},[t._v(t._s(e.corp_full_name||e.corp_name)+"\n\t\t\t\t\t\t\t\t\t\t")])]}))],2):t._e(),a("a-select",{staticStyle:{width:"120px"},attrs:{placeholder:"活动状态"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("a-select-option",{attrs:{value:"1"}},[t._v("未开始")]),a("a-select-option",{attrs:{value:"2"}},[t._v("进行中")]),a("a-select-option",{attrs:{value:"3"}},[t._v("已结束")])],1),a("a-input",{staticStyle:{width:"150px",margin:"0px 10px"},attrs:{placeholder:"搜索活动名称"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.find(e)}},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),a("a-range-picker",{staticStyle:{width:"300px"},on:{change:t.changeTime},model:{value:t.activityTime,callback:function(e){t.activityTime=e},expression:"activityTime"}}),a("a-button",{staticStyle:{margin:"0px 10px"},attrs:{type:"primary"},on:{click:t.find}},[t._v("查找")]),a("a-button",{on:{click:t.clear}},[t._v("清空")])],1),a("a-col",{staticStyle:{float:"right"}},[a("a-button",{directives:[{name:"has",rawName:"v-has",value:"redFission-add",expression:"'redFission-add'"}],staticClass:"btn-primary",attrs:{icon:"plus",type:"primary"},on:{click:t.addWelcomeText}},[t._v("\n\t\t\t\t\t\t\t\t\t新建活动\n\t\t\t\t\t\t\t\t")])],1)],1),t.redFissionNum>0?a("div",{staticClass:"content-msg",staticStyle:{"margin-bottom":"20px"}},[t._v("当前套餐版本仅支持"),a("span",{staticStyle:{color:"red"}},[t._v("单场活动")]),t._v("用户参与人数上限"),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.redFissionNum))]),t._v("人，达到上限后活动将自动结束。更多套餐信息可联系平台了解哦！\n\t\t\t\t\t\t")]):t._e()]),a("div",{staticClass:"content-bd"},[a("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[a("a-table",{directives:[{name:"has",rawName:"v-has",value:"redFission-list",expression:"'redFission-list'"}],attrs:{columns:t.columns,dataSource:t.activityList,pagination:!1,rowClassName:t.rowClassName},scopedSlots:t._u([{key:"qr_code",fn:function(t,e,i){return a("span",{},[a("div",{ref:"qrcode"+i,staticStyle:{width:"100px",margin:"0 auto",float:"left"},attrs:{id:"qrcode"+i}})])}},{key:"title2",fn:function(e,i){return a("span",{},[a("div",{staticStyle:{width:"140px"}},[t._v(t._s(i.title))])])}},{key:"member_str",fn:function(e,i){return a("span",{},[t._l(i.user,(function(e){return[e.scopedSlots&&e.scopedSlots.title&&"custom"==e.scopedSlots.title?a("a-tag",{staticStyle:{"margin-top":"5px"},attrs:{color:"orange"}},[t._v(t._s(e.title))]):t._e()]})),t._l(i.user,(function(e){return[e.scopedSlots&&e.scopedSlots.title&&"custom"!=e.scopedSlots.title?a("a-tag",{staticStyle:{"margin-top":"5px"},attrs:{color:"blue"}},[t._v(t._s(e.title))]):t._e()]})),0==i.user.length?a("span",[t._v("--")]):t._e()],2)}},{key:"date_str",fn:function(e,i){return a("span",{},[a("div",{staticStyle:{width:"125px"}},[t._v(t._s(i.start_time)+"至")]),a("div",[t._v(t._s(i.end_time))])])}},{key:"status_str",fn:function(e,i){return a("span",{},[a("div",[t._v(t._s(i.status_str))]),"已结束"==i.status_str?a("div",{staticStyle:{width:"128px"}},[t._v("（"+t._s(i.reason_str)+"）")]):t._e()])}},{key:"give_out",fn:function(e,i){return a("span",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(i.give_out)+"元/"+t._s(i.total_amount)+"元\n\t\t\t\t\t\t\t\t")])}},{key:"action",fn:function(e,i,s){return a("div",{staticStyle:{width:"150px"}},[a("a-button",{directives:[{name:"show",rawName:"v-show",value:2==i.status,expression:"record.status == 2"},{name:"has",rawName:"v-has",value:"redFission-valid",expression:"'redFission-valid'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.failure(i.id)}}},[t._v("使失效\n\t\t\t\t\t\t\t\t\t")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:1==i.status,expression:"record.status == 1"},{name:"has",rawName:"v-has",value:"redFission-release",expression:"'redFission-release'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.releaseActivity(i.id)}}},[t._v("发布\n\t\t\t\t\t\t\t\t\t")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:1==i.status||2==i.status,expression:"record.status == 1 || record.status == 2"},{name:"has",rawName:"v-has",value:"redFission-edit",expression:"'redFission-edit'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.edit(i.id)}}},[t._v("编辑\n\t\t\t\t\t\t\t\t\t")]),a("a-button",{directives:[{name:"has",rawName:"v-has",value:"redFission-applyer",expression:"'redFission-applyer'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.participants(i.id,i.title)}}},[t._v("参与者\n\t\t\t\t\t\t\t\t\t")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:"进行中"!=i.status_str,expression:"record.status_str != '进行中'"},{name:"has",rawName:"v-has",value:"redFission-del",expression:"'redFission-del'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.deleteActivity(i.id)}}},[t._v("删除\n\t\t\t\t\t\t\t\t\t")]),a("a-button",{directives:[{name:"show",rawName:"v-show",value:2==i.status,expression:"record.status == 2"},{name:"has",rawName:"v-has",value:"redFission-down",expression:"'redFission-down'"}],staticClass:"actionBtn",attrs:{"data-url":i.qr_code,"data-name":i.title,"data-id":"qrcode"+s},on:{click:t.downLoadWay}},[t._v("下载\n\t\t\t\t\t\t\t\t\t")])],1)}}])}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"},{name:"has",rawName:"v-has",value:"redFission-list",expression:"'redFission-list'"}],staticClass:"pagination",staticStyle:{width:"100%",position:"absolute",margin:"20px 0px"}},[a("div",{staticStyle:{height:"32px",float:"left","line-height":"32px"}},[t._v("\n\t\t\t\t\t\t\t\t\t共\n\t\t\t\t\t\t\t\t\t"),a("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.total))]),t._v("条\n\t\t\t\t\t\t\t\t")]),a("div",{staticClass:"pagination",staticStyle:{height:"32px",float:"right"}},[a("a-pagination",{attrs:{total:t.total,showSizeChanger:"",showQuickJumper:t.quickJumper,current:t.page,pageSize:t.pageSize,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage,showSizeChange:t.showSizeChange}})],1)])],1)],1)])],1)],1)],1)])},s=[],n=(a("a481"),a("7f7f"),a("96cf"),a("3b8d")),o=(a("c5f6"),a("641c")),r=a("c1df"),c=a.n(r),d=a("d044"),l=a.n(d),p=[{title:"二维码",dataIndex:"qr_code",key:"qr_code",width:"120px",scopedSlots:{customRender:"qr_code"}},{title:"活动名称",dataIndex:"title",key:"title",scopedSlots:{customRender:"title2"}},{title:"活动时间",dataIndex:"date_str",key:"date_str",scopedSlots:{customRender:"date_str"}},{title:"裂变红包金额",dataIndex:"red_pack_str",key:"red_pack_str",width:"180px"},{title:"活动限制",dataIndex:"limit_str",width:"180px",key:"limit_str"},{title:"引流成员",dataIndex:"member_str",width:"180px",key:"member_str",scopedSlots:{customRender:"member_str"}},{title:"状态",dataIndex:"status_str",key:"status_str",scopedSlots:{customRender:"status_str"}},{title:"已发放/预计发放",dataIndex:"give_out2",width:"180px",key:"give_out",scopedSlots:{customRender:"give_out"}},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"}}],u={name:"redFissionList",components:{MyIcon:o["a"]},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{suite_id:1,corpId:t,corpInfo:[],status:[],title:"",activityTime:[],activityList:[],isLoading:!0,columns:p,total:0,quickJumper:!1,page:1,page_size:15,pageSize:15,corpLen:JSON.parse(localStorage.getItem("corpArr")).length,redFissionNum:Number(this.$store.state.packageDetail.redFissionNum)}},methods:{handleChange:function(t){this.corpId=t},rowClassName:function(t,e){var a="dark-row";return e%2===0&&(a="light-row"),a},changeTime:function(t,e){this.activityTime=t},find:function(){this.getActivityList()},clear:function(){this.status=[],this.title="",this.activityTime=[],this.page=1,this.pageSize=15,this.corpId=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"",this.getActivityList()},addWelcomeText:function(){this.$router.push("/redFission/add")},getActivityList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,i,s,n,o=this,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:1,a=r.length>1&&void 0!==r[1]?r[1]:this.pageSize,this.isLoading=!0,t.next=5,this.axios.post("red-pack/list",{uid:localStorage.getItem("uid"),corp_id:this.corpId,status:this.status,title:this.title,start_date:this.activityTime.length>0?c()(this.activityTime[0]).format("YYYY-MM-DD"):"",end_date:this.activityTime.length>0?c()(this.activityTime[1]).format("YYYY-MM-DD"):"",page:e,pageSize:a});case 5:i=t.sent,s=i.data,0!=s.error?(this.isLoading=!1,this.$message.error(s.error_msg)):(this.isLoading=!1,this.activityList=s.data.redPack,this.total=parseInt(s.data.count),this.page=e,this.pageSize=a,this.quickJumper=this.total>this.pageSize,n=this,this.$nextTick((function(){for(var t=0;t<o.activityList.length;t++)document.getElementById("qrcode"+t).innerHTML="";for(var e=0;e<o.activityList.length;e++)n.qrcode(o.activityList[e].h5Url,e)})));case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),qrcode:function(t,e){new l.a("qrcode"+e,{width:100,height:100,text:t,colorDark:"#000",colorLight:"#FFF"})},failure:function(t){var e=this;e.$confirm({title:"确定结束该活动？",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){e.isLoading=!0,e.changeStatus(t,5)}})},releaseActivity:function(t){var e=this;e.$confirm({title:"确定发布该活动？",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){e.isLoading=!0,e.changeStatus(t,2)}})},deleteActivity:function(t){var e=this;e.$confirm({title:"确定删除该活动？",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){e.isLoading=!0,e.changeStatus(t,0)}})},changeStatus:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,a){var i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("red-pack/change-status",{uid:localStorage.getItem("uid"),id:e,status:a});case 2:i=t.sent,s=i.data,0!=s.error?(this.isLoading=!1,this.$message.error(s.error_msg)):(this.selectedRowKeys=[],0==a&&1==this.activityList.length&&this.page>1?this.getActivityList(this.page-1,this.pageSize):this.getActivityList(this.page,this.pageSize));case 5:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),downLoadWay:function(t){var e=this,a=new Image;a.setAttribute("crossOrigin","anonymous");document.getElementById(t.target.dataset.id);a.src=document.getElementById(t.target.dataset.id).getElementsByTagName("img")[0].getAttribute("src"),a.onload=function(){var i=document.createElement("canvas");i.width=200,i.height=200;var s=i.getContext("2d");s.drawImage(a,0,0,200,200),i.toBlob((function(a){var i=URL.createObjectURL(a);e.download(i,t.target.dataset.name),URL.revokeObjectURL(i)}))}},download:function(t,e){var a=document.createElement("a");a.download=e,a.href=t,a.click(),a.remove()},edit:function(t){this.$router.push("/redFission/add?id="+t)},participants:function(t,e){var a=encodeURIComponent(t),i=encodeURIComponent(e.replace(/%/g,"%25"));this.$router.push("/redFission/participants?fid="+a+"&title="+i)},statistical:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),changePage:function(t,e){this.getActivityList(t,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,280)}))},showSizeChange:function(t,e){this.getActivityList(1,e)}},mounted:function(){var t=this;this.$store.dispatch("getCorp",(function(e){t.corpInfo=e,t.getActivityList()}))},beforeRouteEnter:function(t,e,a){"/redFission/add"==e.path&&"undefined"!=typeof t.query.isRefresh&&"1"==t.query.isRefresh?a((function(t){t.getActivityList(t.page,t.pageSize)})):("/redFission/add"==e.path&&"undefined"==typeof t.query.isRefresh||"/redFission/participants"!=e.path)&&a((function(t){t.status=[],t.title="",t.activityTime=[],t.page=1,t.pageSize=15,t.corpId=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"",t.getActivityList()})),a()}},m=u,h=(a("8179"),a("2877")),g=Object(h["a"])(m,i,s,!1,null,"4d2c19c4",null);e["default"]=g.exports}}]);