(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d2fbfc6e"],{"0094":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-modal",{attrs:{title:"选择企业微信",width:"888"},on:{ok:t.handleOk,cancel:t.handleCancel},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[s("div",{staticStyle:{height:"270px"}},[t.corpInfo[0]?s("a-select",{staticStyle:{width:"200px","margin-bottom":"20px","margin-left":"5px"},attrs:{showSearch:"",optionFilterProp:"children"},on:{change:t.changeWx},model:{value:t.changeBackground,callback:function(e){t.changeBackground=e},expression:"changeBackground"}},[t._l(t.corpInfo,(function(e){return[s("a-select-option",{attrs:{value:e.corpid}},[t._v("\n\t\t\t\t\t\t"+t._s(e.corp_name)+"\n\t\t\t\t\t")])]}))],2):t._e(),s("div",{staticClass:"wxtpl",staticStyle:{height:"230px"}},[t._l(t.corpInfo,(function(e,a){return["scene"!=t.routeName&&"template"!=t.routeName?[s("a-radio-group",{on:{change:function(i){return t.changeWx2(e.corpid,e.corp_name)}},model:{value:t.changeBackground,callback:function(e){t.changeBackground=e},expression:"changeBackground"}},[s("a-radio-button",{attrs:{value:e.corpid}},[s("div",[s("img",{staticStyle:{"border-radius":"4px",width:"32px"},attrs:{src:i("de05"),alt:""}}),s("span",{staticClass:"text"},[t._v(t._s(e.corp_name))])])])],1)]:t._e(),"scene"==t.routeName||"template"==t.routeName?[s("a-radio-group",{on:{change:function(i){return t.changeWx2(e.corpid,e.corp_name)}},model:{value:t.changeBackground,callback:function(e){t.changeBackground=e},expression:"changeBackground"}},[s("a-radio-button",{attrs:{value:e.corpid}},[s("div",[s("a-avatar",{attrs:{src:e.head_img,shape:"square"}}),s("span",{staticClass:"text"},[t._v(t._s(e.corp_name))])],1)])],1)]:t._e()]}))],2)],1)])],1)},a=[],n=(i("7f7f"),i("28a5"),i("96cf"),i("3b8d")),r=(i("7514"),i("bc3a")),o=i.n(r),l=i("f64c"),c={name:"wxModal",props:{show:{type:Boolean,default:!1},callback:{type:Function,default:null},hasName:{type:String,default:""},type:{type:String,default:""},corpId1:{type:String,default:""},wxId:{type:String,default:""}},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{showModal:!1,corpInfo:[],changeBackground:t,corpId:t,corpName:this.$store.state.corpName,routeName:""}},methods:{handleOk:function(){var t=this;if(2==localStorage.getItem("isMasterAccount"))this.getPermissionButton();else{this.showModal=!1;var e=this.corpInfo.find((function(e){return e.corpid==t.corpId}));this.$store.dispatch("changeCorp",e),null!==this.callback&&"function"===typeof this.callback&&this.callback("ok",this.corpId,e.corp_name)}},handleCancel:function(t){null!==this.callback&&"function"===typeof this.callback&&this.callback("cancel"),this.showModal=!1},changeWx:function(t){this.corpId=t},changeWx2:function(t,e){this.corpId=t,this.corpName=e},getPermissionButton:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,s,a,n,r,c,d,p=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.a.post("sub-user/get-sub-user-authority",{isMasterAccount:localStorage.getItem("isMasterAccount"),sub_id:localStorage.getItem("sub_id"),account_id:this.corpId,type:""!=this.type?this.type:localStorage.getItem("type"),corp_id:2==this.type?this.corpId:"",wx_id:2==this.type?this.wxId:""});case 2:if(e=t.sent,i=e.data,0!=i.error){t.next=34;break}if(!(i.data.length>0)){t.next=31;break}if(""==this.hasName){t.next=25;break}if(s=this.hasName.split(","),!(s.length>0)){t.next=22;break}a=!0,n=0;case 11:if(!(n<s.length)){t.next=19;break}if(-1!=i.data.indexOf(s[n])){t.next=16;break}return l["a"].error("该企业微信未配置相关功能权限，无法选择"),a=!1,t.abrupt("return",!1);case 16:n++,t.next=11;break;case 19:a&&(this.showModal=!1,r=this.corpInfo.find((function(t){return t.corpid==p.corpId})),this.$store.dispatch("changeCorp",r),null!==this.callback&&"function"===typeof this.callback&&this.callback("ok",this.corpId,r.corp_name)),t.next=23;break;case 22:-1==i.data.indexOf(this.hasName)?l["a"].error("该企业微信未配置相关功能权限，无法选择"):(this.showModal=!1,c=this.corpInfo.find((function(t){return t.corpid==p.corpId})),this.$store.dispatch("changeCorp",c),null!==this.callback&&"function"===typeof this.callback&&this.callback("ok",this.corpId,c.corp_name));case 23:t.next=29;break;case 25:this.showModal=!1,d=this.corpInfo.find((function(t){return t.corpid==p.corpId})),this.$store.dispatch("changeCorp",d),null!==this.callback&&"function"===typeof this.callback&&this.callback("ok",this.corpId,d.corp_name);case 29:t.next=32;break;case 31:l["a"].error("无权限");case 32:t.next=35;break;case 34:l["a"].error("获取权限按钮列表失败！");case 35:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},watch:{show:function(t){var e=this;this.showModal=t,this.changeBackground=localStorage.getItem("corpId"),this.$store.dispatch("getCorp",(function(t){e.corpInfo=t,e.corpId=e.$store.state.corpId,!e.changeBackground&&e.corpInfo.length>0&&(e.changeBackground=e.$store.state.corpId,e.corpId=e.$store.state.corpId,e.corpName=e.$store.state.corpName)})),this.routeName=this.$route.name}},created:function(){}},d=c,p=(i("ffd5"),i("2877")),h=Object(p["a"])(d,s,a,!1,null,"440e9184",null);e["a"]=h.exports},"1c4c":function(t,e,i){"use strict";var s=i("9b43"),a=i("5ca1"),n=i("4bf8"),r=i("1fa8"),o=i("33a4"),l=i("9def"),c=i("f1ae"),d=i("27ee");a(a.S+a.F*!i("5cc5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,i,a,p,h=n(t),u="function"==typeof this?this:Array,f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,v=0,y=d(h);if(g&&(m=s(m,f>2?arguments[2]:void 0,2)),void 0==y||u==Array&&o(y))for(e=l(h.length),i=new u(e);e>v;v++)c(i,v,g?m(h[v],v):h[v]);else for(p=y.call(h),i=new u;!(a=p.next()).done;v++)c(i,v,g?r(p,m,[a.value,v],!0):a.value);return i.length=v,i}})},"20d6":function(t,e,i){"use strict";var s=i("5ca1"),a=i("0a49")(6),n="findIndex",r=!0;n in[]&&Array(1)[n]((function(){r=!1})),s(s.P+s.F*r,"Array",{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(n)},2543:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".content-msg[data-v-6639d922]{display:inline-block;border:1px solid #ffdda6;background:#fff2db;padding:10px;margin-top:15px}[data-v-6639d922] .ant-card-bordered{border:0}.tpl-title[data-v-6639d922]{float:left}.right[data-v-6639d922],.tpl-title[data-v-6639d922]{font-size:16px;vertical-align:top}.right[data-v-6639d922]{float:right;margin:10px 0}.content-bd[data-v-6639d922]{background:#fff;min-height:120px;border:1px solid #e2e2e2;min-width:885px;margin:20px 20px}[data-v-6639d922] .dark-row{background:#fafafa}[data-v-6639d922] .light-row{background:#fff}.steps-content[data-v-6639d922]{border-radius:6px;height:calc(100% - 52px);padding:0 30px;overflow-y:auto}.steps-action[data-v-6639d922]{position:fixed;bottom:0;height:60px;line-height:60px;width:100%;-webkit-transform:translateX(-40px);transform:translateX(-40px);text-align:center;border-top:1px solid #f1f1f1;background-color:#f0f2f5}.arrow-left[data-v-6639d922]{border:5px solid;border-color:transparent #1890ff transparent transparent}.arrow-left[data-v-6639d922],.arrow-right[data-v-6639d922]{vertical-align:middle;display:inline-block;width:0;height:0}.arrow-right[data-v-6639d922]{border:5px solid;border-color:transparent transparent transparent #1890ff}.line[data-v-6639d922]{display:inline-block;height:0;width:calc(100% - 10px);border-top:2px solid #1890ff;vertical-align:middle}.line-right[data-v-6639d922]{margin-right:4.17%;float:right}.line-left[data-v-6639d922],.line-right[data-v-6639d922]{height:20px;width:0;border-right:2px solid #1890ff}.line-left[data-v-6639d922]{margin-left:4.17%;float:left}.arrow-bottom[data-v-6639d922]{display:inline-block;color:#c3c3c3;-webkit-transform:rotate(90deg);transform:rotate(90deg);width:0;height:0;border:5px solid;border-color:transparent transparent transparent #1890ff}.arrow-bottom-right[data-v-6639d922]{line-height:10px;float:right;margin-right:calc(4.17% - 4px)}.arrow-bottom-left[data-v-6639d922]{line-height:9px;float:left;margin-left:calc(4.17% - 4px)}.color-show[data-v-6639d922]{width:20px;height:20px;display:inline-block;margin:0 10px;vertical-align:sub;border:1px solid #bfbfbf}.btn-tag[data-v-6639d922]{border:1px solid #1890ff;color:#1890ff;width:100%;overflow:hidden;text-overflow:ellipsis}.active[data-v-6639d922]{margin-bottom:5px}.ant-checkbox-wrapper+.ant-checkbox-wrapper[data-v-6639d922]{margin-left:0}[data-v-6639d922] .ant-select-selection--multiple{margin-bottom:10px}[data-v-6639d922] .ant-input-number-handler-down,[data-v-6639d922] .ant-input-number-handler-up,[data-v-6639d922] .ant-input-number-handler-wrap{display:none}.desc[data-v-6639d922]{word-break:break-word;width:180px;overflow:hidden;text-overflow:-o-ellipsis-lastline;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;line-clamp:5;-webkit-box-orient:vertical}",""])},3846:function(t,e,i){i("9e1e")&&"g"!=/./g.flags&&i("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:i("0bfb")})},"3e6b":function(t,e,i){"use strict";var s=i("eee0"),a=i.n(s);a.a},"4f7f":function(t,e,i){"use strict";var s=i("c26b"),a=i("b39a"),n="Set";t.exports=i("e0b8")(n,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return s.def(a(this,n),t=0===t?0:t,t)}},s)},"59fe":function(t,e,i){var s=i("b6ee");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var a=i("499e").default;a("2af37125",s,!0,{sourceMap:!1,shadowMode:!1})},"6b54":function(t,e,i){"use strict";i("3846");var s=i("cb7c"),a=i("0bfb"),n=i("9e1e"),r="toString",o=/./[r],l=function(t){i("2aba")(RegExp.prototype,r,t,!0)};i("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?l((function(){var t=s(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?a.call(t):void 0)})):o.name!=r&&l((function(){return o.call(this)}))},"88bf":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"scroll",staticStyle:{width:"100%","max-height":"100%",position:"absolute","overflow-y":"auto","padding-bottom":"80px"}},[s("div",[s("a-card",{staticStyle:{"margin-bottom":"20px",padding:"10px 20px"}},[s("label",{staticClass:"tpl-title"},[t._v("待办项目")])]),s("a-card",{staticStyle:{margin:"0 20px 0px 20px",padding:"10px 20px 0px 20px",height:"100%"}},[1==t.init?s("label",{directives:[{name:"has",rawName:"v-has",value:"todoManagementSetting-all",expression:"'todoManagementSetting-all'"}],staticClass:"right"},[s("a-button",{directives:[{name:"show",rawName:"v-show",value:0==t.stateAll,expression:"stateAll==false"}],attrs:{type:"primary"},on:{click:t.editAll}},[t._v("批量编辑")]),s("a-button",{directives:[{name:"show",rawName:"v-show",value:1==t.stateAll,expression:"stateAll==true"}],on:{click:t.notEditAll}},[t._v("取消")])],1):t._e(),s("div",[s("a-steps",{staticStyle:{padding:"0 30px",cursor:"pointer"},attrs:{current:t.current}},t._l(t.steps,(function(e,i){return s("a-step",{attrs:{title:e.title},on:{click:function(e){return t.changeCurrent(i)}}})})),1),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.current,expression:"current==0"}],staticClass:"steps-content",staticStyle:{"padding-top":"10px","padding-bottom":"30px",height:"100%"}},[t.$store.state.corpArr.length>1&&t.stateAll?s("a-form-item",{staticClass:"current0",staticStyle:{"margin-top":"20px"},attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("选择企业微信\n\t\t\t\t\t\t\t")]),[s("div",{staticStyle:{display:"inline-block",cursor:"pointer"},on:{click:t.changeCorp}},[s("img",{staticStyle:{width:"24px",margin:"-3px 6px 0 0"},attrs:{src:i("de05")}}),s("span",[t._v(t._s(t.corpName))]),s("a-icon",{staticStyle:{width:"50px",height:"40px","text-align":"left","line-height":"40px","margin-left":"20px"},attrs:{type:"caret-down"}})],1)]],2):t._e(),t.$store.state.corpArr.length>1&&!t.stateAll?s("a-form-item",{staticClass:"current0",staticStyle:{"margin-top":"20px"},attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("选择企业微信\n\t\t\t\t\t\t\t")]),[s("div",{staticStyle:{display:"inline-block",cursor:"pointer"}},[s("img",{staticStyle:{width:"24px",margin:"-3px 6px 0 0"},attrs:{src:i("de05")}}),s("span",[t._v(t._s(t.corpName))])])]],2):t._e(),t.appList.length>0&&t.stateAll?s("a-form-item",{staticClass:"current0",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("选择应用\n\t\t\t\t\t\t\t")]),[s("a-select",{staticStyle:{width:"180px",display:"inline-block"},attrs:{showSearch:"",optionFilterProp:"children"},model:{value:t.appId,callback:function(e){t.appId=e},expression:"appId"}},[t._l(t.appList,(function(e){return[s("a-select-option",{attrs:{value:e.id}},[t._v(t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t\t")])]}))],2),s("div",[s("div",{staticClass:"content-msg",staticStyle:{"font-size":"13px"}},[s("p",{staticStyle:{height:"20px","line-height":"20px","margin-bottom":"2px"}},[t._v("1、前往"),s("a",{attrs:{target:"_blank",href:"https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome_baidu"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t企业微信后台")]),t._v("创建自建应用。"),s("a",{attrs:{target:"_blank",href:"https://support.qq.com/products/104790/faqs/63937"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t教程")])]),s("p",{staticStyle:{"line-height":"20px",height:"20px","margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t2、选择此应用，请确认已设置过应用的可信域名。\n\t\t\t\t\t\t\t\t\t\t\t"),s("a",{staticClass:"el-link el-link--primary",attrs:{href:t.$store.state.commonUrl+"/upload/slider.png",target:"_blank"}},[s("span",{staticClass:"el-link--inner"},[t._v("查看图示")])])])])])]],2):t._e(),t.appList.length>0&&!t.stateAll?s("a-form-item",{staticClass:"current0",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("选择应用\n\t\t\t\t\t\t\t")]),[s("span",[t._v(t._s(t.appList.find((function(e){return e.id==t.appId})).name))])]],2):t._e(),s("WeChatModal",{attrs:{show:t.showModal2,callback:t.modalVisibleChange,hasName:"fission-add"}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.current,expression:"current==1"}],staticClass:"steps-content"},[s("div",{staticStyle:{background:"#FFF",padding:"20px 0"}},[s("div",{directives:[{name:"has",rawName:"v-has",value:"todoManagementSetting-all",expression:"'todoManagementSetting-all'"}],staticStyle:{height:"40px","line-height":"40px",margin:"20px 0 10px 0"}},[s("a-button",{directives:[{name:"show",rawName:"v-show",value:1==t.stateAll,expression:"stateAll==true"}],staticStyle:{"margin-right":"20px","vertical-align":"middle",float:"right"},attrs:{type:"primary",icon:"plus"},on:{click:t.addProject}},[t._v("新增待办项目\n\t\t\t\t\t\t\t\t")])],1),s("a-table",{staticClass:"follow-table3",attrs:{columns:t.stateAll?t.columns2:t.columns1,dataSource:t.projectList,pagination:!1,rowClassName:t.rowClassName},scopedSlots:t._u([{key:"title3",fn:function(e,i){return i.title?s("span",{},[t._v("\n\t\t                              "+t._s(i.title)+"\n\t\t\t\t\t\t\t\t")]):t._e()}},{key:"desc",fn:function(e,i){return s("span",{},[s("a-popover",{attrs:{placement:"top"}},[s("span",{staticStyle:{display:"inline-block","max-width":"500px","white-space":"normal","word-break":"break-all"},attrs:{slot:"content"},slot:"content"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.desc)+"\n\t\t\t\t\t\t\t\t\t\t")]),s("p",{staticClass:"desc"},[t._v(t._s(i.desc))])]),""==i.desc?s("span",[t._v("--")]):t._e()],1)}},{key:"user",fn:function(e,i){return i.user?s("span",{},[s("a-popover",{attrs:{trigger:"hover"}},[s("span",{staticStyle:{display:"inline-block","max-width":"500px","word-wrap":"break-word","word-break":"break-all"},attrs:{slot:"content"},slot:"content"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.user)+"-"+t._s(i.depart_name)+"\n\t\t\t\t\t\t\t\t\t\t")]),s("a-tag",{staticStyle:{"max-width":"180px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},attrs:{color:"orange"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.user)+"-"+t._s(i.depart_name)+"\n\t\t\t\t\t\t\t\t\t\t")])],1)],1):t._e()}},{key:"finish_time",fn:function(e,i){return i.finish_time?s("span",{},[t._v("\n\t\t\t\t\t\t\t\t\t需要在 "+t._s(i.finish_time)+" 天内完成\n\t\t\t\t                ")]):t._e()}},{key:"level",fn:function(e,i){return s("span",{},[t._l(i.remind,(function(e,i){return s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.type&&""!==e.days&&null!==e.days,expression:"item.type==1 && item.days !=='' && item.days !==null"}]},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t在预计截止结束时间前"+t._s(e.days)+"天提醒\n\t\t\t\t\t\t\t\t\t\t\t"),s("br")]),s("span",{directives:[{name:"show",rawName:"v-show",value:2==e.type&&""!==e.days&&null!==e.days,expression:"item.type==2 && item.days !=='' && item.days !==null"}]},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t任务超时"+t._s(e.days)+"天提醒\n\t\t\t\t\t\t\t\t\t\t\t"),s("br")])])})),0==i.remind.length?s("span",[t._v("--")]):t._e()],2)}},{key:"action",fn:function(e,i,a){return s("span",{directives:[{name:"show",rawName:"v-show",value:1==t.stateAll,expression:"stateAll==true"}]},[s("div",{staticStyle:{display:"inline-block"}},[s("a-button",{directives:[{name:"has",rawName:"v-has",value:"todoManagementSetting-all",expression:"'todoManagementSetting-all'"}],staticStyle:{"margin-right":"5px"},on:{click:function(e){return t.editProject(i,a)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t编辑\n\t\t\t\t\t\t\t\t\t")])],1),s("div",{staticStyle:{display:"inline-block"}},[s("a-button",{directives:[{name:"has",rawName:"v-has",value:"todoManagementSetting-all",expression:"'todoManagementSetting-all'"}],on:{click:function(e){return t.delProject(i,a)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t删除\n\t\t\t\t\t\t\t\t\t")])],1)])}}],null,!0)}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],staticClass:"pagination",staticStyle:{margin:"20px auto",height:"32px"}},[s("div",{staticStyle:{height:"32px",float:"left","line-height":"32px","margin-left":"10px"}},[t._v("\n\t\t\t\t\t\t\t\t\t共有\n\t\t\t\t\t\t\t\t\t"),s("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.total))]),t._v("个项目\n\t\t\t\t\t\t\t\t")]),s("div",{staticClass:"pagination",staticStyle:{height:"32px",float:"right"}},[s("a-pagination",{attrs:{total:t.total,showSizeChanger:"",showQuickJumper:t.quickJumper,current:t.page,pageSize:t.pageSize,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage,showSizeChange:t.showSizeChange}})],1)])],1),s("a-modal",{attrs:{title:t.projectAddOrEditTitle,width:"720px!important"},on:{cancel:t.handleCancelProject},model:{value:t.projectVisible,callback:function(e){t.projectVisible=e},expression:"projectVisible"}},[s("template",{slot:"footer"},[s("a-button",{on:{click:t.handleCancelProject}},[t._v("取消")]),s("a-button",{attrs:{type:"primary",loading:t.isLoading3},on:{click:t.handleProject}},[t._v("提交\n\t\t\t\t\t\t\t\t")])],1),s("a-form-model",[s("a-form-model-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("项目名称\n\t\t\t\t\t\t\t\t\t")]),s("a-input",{attrs:{maxLength:20,placeholder:"请输入项目名称，20个字以内"},model:{value:t.projectTitle,callback:function(e){t.projectTitle=e},expression:"projectTitle"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[s("span",[t._v(t._s(t.projectTitle.length))]),t._v("/20\n\t\t\t\t\t\t")])])],2),s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("选择优先级\n\t\t\t\t\t\t\t\t\t")]),s("span",[s("a-select",{staticStyle:{width:"180px",display:"inline-block"},on:{change:t.projectChange},model:{value:t.projectLevelTitle,callback:function(e){t.projectLevelTitle=e},expression:"projectLevelTitle"}},t._l(t.priorityList,(function(e){return s("a-select-option",{attrs:{value:e.title}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t      ")])})),1)],1)],2),s("a-form-model-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[t._v("项目描述\n\t\t\t\t\t\t\t\t\t")]),s("a-textarea",{attrs:{maxLength:200,placeholder:"请填写项目描述，200个字以内","allow-clear":""},on:{change:t.projectDescChange},model:{value:t.projectDesc,callback:function(e){t.projectDesc=e},expression:"projectDesc"}})],2),s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("项目处理人\n\t\t\t\t\t\t\t\t\t")]),t.projectVisible?[s("a-select",{staticStyle:{width:"180px",display:"inline-block"},attrs:{showSearch:"",optionFilterProp:"children",filterOption:!1,placeholder:"请选择企业成员"},on:{focus:t.focusUser,search:t.searchUser,select:t.changeSelect,popupScroll:t.popScroll},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return s("div",{},[s("v-nodes",{attrs:{vnodes:e}}),s("a-spin",{staticStyle:{position:"absolute",bottom:"50%",left:"0",right:"0"},attrs:{tip:"Loading...",size:"large",spinning:t.isLoading5}})],1)}}],null,!1,1328483435),model:{value:t.projectUserId,callback:function(e){t.projectUserId=e},expression:"projectUserId"}},[t._l(t.userList,(function(e){return[s("a-select-option",{attrs:{value:e.id}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t\t\t\t")])]}))],2)]:t._e()],2),s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("\n\t\t\t\t\t\t\t\t\t\t项目完成时间\n\t\t\t\t\t\t\t\t\t")]),s("span",[s("span",[t._v("需在 ")]),s("a-input-number",{staticStyle:{width:"100px",display:"inline-block"},attrs:{placeholder:"请输入天数",min:1,step:0,max:366,formatter:t.limitDecimals,parse:t.limitDecimals},nativeOn:{input:function(e){return t.inputNum(e)}},model:{value:t.projectDay,callback:function(e){t.projectDay=e},expression:"projectDay"}}),s("span",[t._v(" 天内完成")]),s("br"),s("span",{staticStyle:{color:"#ff562D"}},[t._v("（修改天数后，不论项目处理人是否已启动该项目，都将以最新预计的时间计算。）")])],1)],2),s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("\n\t\t\t\t\t\t\t\t\t\t任务提醒\n\t\t\t\t\t\t\t\t\t")]),t._l(t.projectRemind,(function(e,i){return s("span",[s("a-select",{staticStyle:{width:"180px",display:"inline-block"},attrs:{placeholder:"请选择任务提醒"},on:{change:t.handleChange},model:{value:e.type,callback:function(i){t.$set(e,"type",i)},expression:"item.type"}},[s("a-select-option",{attrs:{value:"1"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t在预计截止结束时间前\n\t\t\t\t\t\t\t\t\t\t\t")]),s("a-select-option",{attrs:{value:"2"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t项目超时\n\t\t\t\t\t\t\t\t\t\t\t")])],1),s("a-input-number",{staticStyle:{width:"100px",display:"inline-block","margin-left":"5px"},attrs:{formatter:t.limitDecimals,parse:t.limitDecimals,step:0,min:1,placeholder:"请输入天数"},model:{value:e.days,callback:function(i){t.$set(e,"days",i)},expression:"item.days"}}),s("span",[t._v(" 天自动提醒")]),s("a-button",{directives:[{name:"show",rawName:"v-show",value:i==t.projectRemind.length-1,expression:"index==projectRemind.length-1"}],staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.addProjectRemind(i)}}},[t._v("添加")]),s("a-button",{directives:[{name:"show",rawName:"v-show",value:1!=t.projectRemind.length,expression:"projectRemind.length != 1"}],staticStyle:{margin:"0 10px"},on:{click:function(e){return t.delProjectRemind(i)}}},[t._v("删除")]),s("br")],1)}))],2)],1)],2)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.current,expression:"current==2"}],staticClass:"steps-content"},[s("div",{staticStyle:{background:"#FFF",padding:"20px 0"}},[s("a-table",{attrs:{columns:t.stateAll?t.columns4:t.columns3,dataSource:t.customList,bordered:"",pagination:!1},scopedSlots:t._u([{key:"priorityDesc",fn:function(e,i){return s("span",{},[""==i.content.title?s("span",[t._v("--")]):t._e(),""!=i.content.title?s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:1==i.content.type,expression:"record.content.type==1"}]},[s("span",[t._v("进入到该状态手动开启")]),s("span",[t._v("需在"+t._s(i.content.date)+"天内完成"),s("br")]),t._l(i.content.descTitle,(function(e){return s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.type,expression:"c.type==1"}]},[t._v("在预计截止结束时间前"+t._s(e.days)+"天提醒"),s("br")]),s("span",{directives:[{name:"show",rawName:"v-show",value:2==e.type,expression:"c.type==2"}]},[t._v("任务超时"+t._s(e.days)+"天提醒"),s("br")])])}))],2),s("span",{directives:[{name:"show",rawName:"v-show",value:2==i.content.type,expression:" record.content.type==2"}]},[s("span",[t._v("进入到该状态立即开始")]),s("span",[t._v("需在"+t._s(i.content.date)+"天内完成"),s("br")]),t._l(i.content.descTitle,(function(e){return s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.type,expression:"c.type==1"}]},[t._v("在预计截止结束时间前"+t._s(e.days)+"天提醒"),s("br")]),s("span",{directives:[{name:"show",rawName:"v-show",value:2==e.type,expression:"c.type==2"}]},[t._v("任务超时"+t._s(e.days)+"天提醒"),s("br")])])}))],2),s("span",{directives:[{name:"show",rawName:"v-show",value:3==i.content.type,expression:"record.content.type==3"}]},[s("span",[t._v("进入到该状态"+t._s(i.content.days)+"天后开始")]),s("span",[t._v("需在"+t._s(i.content.date)+"天内完成"),s("br")]),t._l(i.content.descTitle,(function(e){return s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.type,expression:"c.type==1"}]},[t._v("在预计截止结束时间前"+t._s(e.days)+"天提醒"),s("br")]),s("span",{directives:[{name:"show",rawName:"v-show",value:2==e.type,expression:"c.type==2"}]},[t._v("任务超时"+t._s(e.days)+"天提醒"),s("br")])])}))],2)]):t._e()])}},{key:"priorityName",fn:function(e,i,a){return s("span",{},[i.content.title||0==i.content?t._e():s("span",[t._v("--")]),i.content.title||0==i.content?s("span",[s("span",[t._v(t._s(i.content.title))])]):t._e(),s("br"),(i.content.title||0==i.content)&&i.content.userInfo?s("span",[s("a-tag",{attrs:{color:"orange"}},[t._v(t._s(i.content.userInfo))]),t._v("完成")],1):t._e()])}}])})],1),s("a-modal",{attrs:{title:t.customAddOrEditTitle,width:"720px"},on:{cancel:t.handleCancelCustom},model:{value:t.customVisible,callback:function(e){t.customVisible=e},expression:"customVisible"}},[s("template",{slot:"footer"},[s("a-button",{on:{click:t.handleCancelCustom}},[t._v("取消")]),s("a-button",{attrs:{type:"primary",loading:t.isLoading3},on:{click:t.handleCustom}},[t._v("提交\n\t\t\t\t\t\t\t\t")])],1),s("a-form-item",{directives:[{name:"show",rawName:"v-show",value:1==t.isAddOrEdit,expression:"isAddOrEdit==1"}],staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("选择跟进状态\n\t\t\t\t\t\t\t\t")]),s("a-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择跟进状态"},on:{change:t.getContent},model:{value:t.follow_id,callback:function(e){t.follow_id=e},expression:"follow_id"}},t._l(t.follows,(function(e){return s("a-select-option",{attrs:{value:e.id}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t")])})),1)],2),s("a-form-item",{directives:[{name:"show",rawName:"v-show",value:2==t.isAddOrEdit||3==t.isAddOrEdit,expression:"isAddOrEdit==2 ||isAddOrEdit==3"}],staticClass:"active",attrs:{"wrapper-col":{span:24}}},[[s("span",{staticStyle:{"font-size":"20px",color:"red"}},[t._v("【"+t._s(t.showName)+"】 阶段")])]],2),t._l(t.content,(function(e,i){return[s("a-form-item",{staticClass:"active",attrs:{"wrapper-col":{span:24}}},[[s("span",{staticStyle:{"padding-left":"5px","border-left":"5px solid #1890FF","font-weight":"700"}},[t._v("待办项目"+t._s(i+1))])],1!=t.content.length||"请选择项目名称"!=t.content[0].title||0!=i?s("a-icon",{staticStyle:{float:"right","font-size":"20px","margin-top":"10px",color:"red"},attrs:{type:"minus-square"},on:{click:function(e){return t.delProjectIndex(i)}}}):t._e()],2),s("a-form",[s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("选择待办项目\n\t\t\t\t\t\t\t\t\t\t")]),s("a-select",{staticStyle:{width:"180px",display:"inline-block"},on:{change:function(s){return t.peojectSelect(e.title,i)}},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"item.title"}},[t._l(t.tableList,(function(i){return[s("a-select-option",{attrs:{disabled:t.isDisabled(i.title,e.title),value:i.title}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.title)+"\n\t\t\t\t\t\t\t\t\t\t\t\t")])]}))],2)],2),""!=e.title&&"请选择项目名称"!=e.title?s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t项目完成人\n\t\t\t\t\t\t\t\t\t\t")]),s("span",[t._v(t._s(e.userInfo))])],2):t._e(),""!=e.title&&"请选择项目名称"!=e.title?s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t任务规则\n\t\t\t\t\t\t\t\t\t\t")]),s("a-radio-group",{on:{change:t.selectOpenDate},model:{value:e.type,callback:function(i){t.$set(e,"type",i)},expression:"item.type"}},[s("a-radio",{style:t.radioStyle1,attrs:{value:1},on:{click:function(i){return t.changeOpenDate1(e)}}},[s("span",[t._v("手动开启")])]),s("a-radio",{style:t.radioStyle1,attrs:{value:2},on:{click:function(i){return t.changeOpenDate1(e)}}},[s("span",[t._v("自动开启")])]),s("a-radio",{style:t.radioStyle1,attrs:{value:3}},[s("span",[t._v("N天后开启")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:3==e.type,expression:"item.type==3"}],staticStyle:{display:"inline-block"}},[t._v("请输入"),s("a-input-number",{staticStyle:{width:"100px",display:"inline-block",margin:"0 5px"},attrs:{formatter:t.limitDecimals,parse:t.limitDecimals,step:0,min:1},model:{value:e.days,callback:function(i){t.$set(e,"days",i)},expression:"item.days"}}),t._v(" 天后开启（输入天数须大于0）")],1)],1)],2):t._e(),""!=e.title&&"请选择项目名称"!=e.title?s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:8}}},[s("template",{slot:"label"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t任务提醒\n\t\t\t\t\t\t\t\t\t\t")]),s("div",{staticStyle:{"margin-top":"7px","line-height":"26px"}},t._l(e.descTitle,(function(e){return s("span",{staticStyle:{margin:"3px 0"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:1==e.type,expression:"i.type==1"}]},[t._v("在预计截止结束时间前"+t._s(e.days)+"天提醒"),s("br")]),s("span",{directives:[{name:"show",rawName:"v-show",value:2==e.type,expression:"i.type==2"}]},[t._v("任务超时"+t._s(e.days)+"天提醒"),s("br")])])})),0)],2):t._e(),i!=t.content.length-1?s("div",{staticStyle:{width:"100%",height:"1px","border-top":"1px dashed #C3C3C3",margin:"15px 0"}}):t._e()],1)]})),s("a-form-item",{staticClass:"active",staticStyle:{"text-align":"center"},attrs:{label:"","label-col":{span:4},"wrapper-col":{span:20}}},[s("a-button",{staticStyle:{margin:"0 10px"},attrs:{type:"primary"},on:{click:t.addProjectIndex}},[t._v("添加\n\t\t\t\t\t\t\t\t")])],1),s("a-form-item",{staticClass:"active",attrs:{"label-col":{span:4},"wrapper-col":{span:20}}},[s("template",{slot:"label"},[t._v("改变跟进状态\n\t\t\t\t\t\t\t\t")]),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.showState,expression:"showState==true"}],staticClass:"active"},[s("a-radio-group",{on:{change:t.customChange},model:{value:t.need,callback:function(e){t.need=e},expression:"need"}},[s("a-radio",{style:t.radioStyle,attrs:{value:1}},[s("span",[t._v("所有项目全部完成，才能更改客户状态")])]),s("a-radio",{style:t.radioStyle,attrs:{value:2}},[s("span",[t._v("无需所有项目全部完成，即能更改客户状态")]),s("span",{directives:[{name:"show",rawName:"v-show",value:2==t.need,expression:"need==2"}],staticStyle:{color:"#A9BFF4"}},[t._v("（请选择更改客户状态条件）")])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.need,expression:"need==2"}]},[s("a-checkbox-group",{on:{change:t.onChange},model:{value:t.way,callback:function(e){t.way=e},expression:"way"}},[s("a-checkbox",{attrs:{value:1}}),s("span",{staticStyle:{"margin-left":"8px"}},[s("a-select",{staticStyle:{width:"180px",display:"inline-block"},attrs:{mode:"multiple",placeholder:"选择项目(多选)","option-label-prop":"label"},model:{value:t.value2,callback:function(e){t.value2=e},expression:"value2"}},[t._l(t.content,(function(e){return[s("a-select-option",{attrs:{label:e.title,value:e.title}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  "+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  ")])]}))],2),s("span",[t._v(" 至少完成其中")]),s("a-input-number",{staticStyle:{width:"100px",display:"inline-block","margin-left":"5px"},attrs:{min:1,step:0,formatter:t.limitDecimals,parse:t.limitDecimals},model:{value:t.nums,callback:function(e){t.nums=e},expression:"nums"}}),s("span",[t._v(" 项，才能更改客户状态")])],1),s("br"),s("a-checkbox",{attrs:{value:2}}),s("span",{staticStyle:{"margin-left":"8px"}},[s("span",[t._v("所有任务需完成 ")]),s("a-select",{staticStyle:{width:"180px",display:"inline-block"},attrs:{mode:"multiple",placeholder:"选择项目(多选)","option-label-prop":"label"},model:{value:t.value3,callback:function(e){t.value3=e},expression:"value3"}},[t._l(t.content,(function(e){return[s("a-select-option",{attrs:{label:e.title,value:e.title}},[t._v("\n\t\t\t\t\t\t\t\t\t        "+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t      ")])]}))],2),s("span",[t._v("，才能更改客户状态")])],1)],1)],1)],1)],2)],2)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.stateAll,expression:"stateAll==true"}],staticClass:"steps-action"},[s("div",{staticStyle:{display:"inline-block","margin-left":"-200px"}},[t.current>0?s("a-button",{on:{click:t.prev}},[t._v("\n\t\t\t\t\t\t\t\t上一步\n\t\t\t\t\t\t\t")]):t._e(),t.current<t.steps.length-1?s("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.next}},[t._v("\n\t\t\t\t\t\t\t\t下一步\n\t\t\t\t\t\t\t")]):t._e(),t.current==t.steps.length-1?s("a-button",{staticStyle:{"margin-left":"8px"},attrs:{loading:t.isLoadingb,type:"primary"},on:{click:t.createActivity}},[t._v("\n\t\t\t\t\t\t\t\t提交\n\t\t\t\t\t\t\t")]):t._e()],1)])],1)])],1)])},a=[],n=(i("7f7f"),i("20d6"),i("7514"),i("ac6a"),i("4f7f"),i("5df3"),i("1c4c"),i("96cf"),i("3b8d")),r=(i("6b54"),i("a481"),i("c5f6"),i("c345a")),o=i("95204"),l=i("0094"),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return"string"==typeof t.has?i("div",{staticStyle:{display:"inline-block"}},[t.has.length>0?i("a-button",{staticStyle:{margin:"5px 5px 0"},attrs:{type:t.type,"v-has":t.has},on:{click:t.callFather}},[t._v(t._s(t.buttonText))]):i("a-button",{staticStyle:{margin:"5px 5px 0"},attrs:{type:t.type},on:{click:t.callFather}},[t._v(t._s(t.buttonText))])],1):i("div",[t._l(t.has,(function(e,s){return[i("div",{staticStyle:{display:"inline-block"}},[e.length>0?i("a-button",{staticStyle:{margin:"5px 5px 0"},attrs:{type:"string"==typeof t.type?t.type:"undefined"!=typeof t.type[s]?t.type[s]:"","v-has":e},on:{click:function(e){return t.callFather(s)}}},[t._v(t._s(t.buttonText[s]))]):i("a-button",{staticStyle:{margin:"5px 5px 0"},attrs:{type:"string"==typeof t.type?t.type:"undefined"!=typeof t.type[s]?t.type[s]:""},on:{click:function(e){return t.callFather(s)}}},[t._v(t._s(t.buttonText[s]))])],1)]}))],2)},d=[],p={name:"todoAction",props:{type:{type:String|Array,default:""},has:{type:String|Array,default:""},buttonText:{type:String|Array,default:"Todo Action"},callback:{type:Function|Array,default:function(){}},record:{type:Object,default:{}},index:{type:Number,default:0}},methods:{callFather:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;console.log(this.callback,this.record,this.index);var e=this.callback;"function"!=typeof this.callback&&(e=this.callback[t]),e(this.record,this.index)}}},h=p,u=i("2877"),f=Object(u["a"])(h,c,d,!1,null,"67eb7da6",null),m=f.exports,g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",{directives:[{name:"show",rawName:"v-show",value:0==t.record.type,expression:"record.type == 0"}]},[t._v("--")]),i("span",{directives:[{name:"show",rawName:"v-show",value:1==t.record.type,expression:"record.type==1"}]},[t._v("所有项目必须完成，才能更改客户状态")]),i("span",{directives:[{name:"show",rawName:"v-show",value:2==t.record.type,expression:"record.type==2"}]},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.record.project_one&&t.record.project_one.length>0&&t.record.way.indexOf(1)>-1,expression:"record.project_one && record.project_one.length>0 && record.way.indexOf(1) > -1"}]},[t._l(t.record.project_one,(function(e){return i("span",[t._v("\n\t\t\t\t【"+t._s(e)+"】\n\t\t\t")])})),t._v("中至少完成"+t._s(t.record.num)+"项，才能更改客户状态\n\t\t")],2),i("br"),i("span",{directives:[{name:"show",rawName:"v-show",value:t.record.project_two&&t.record.project_two.length>0&&t.record.way.indexOf(2)>-1,expression:"record.project_two && record.project_two.length>0 && record.way.indexOf(2) > -1"}]},[t._l(t.record.project_two,(function(e){return i("span",[t._v("\n\t\t\t\t所有项目需完成【"+t._s(e)+"】，才能更改客户状态\n\t\t\t")])})),i("br")],2)])])},v=[],y={name:"todoPriority",props:{record:{type:Object,default:""}}},w=y,x=Object(u["a"])(w,g,v,!1,null,"0d3fea94",null),b=x.exports,_=[{title:"待办项目",dataIndex:"title3",width:"180px",key:"title3",scopedSlots:{customRender:"title3"}},{title:"项目描述",dataIndex:"desc",width:"23%",key:"desc",scopedSlots:{customRender:"desc"}},{title:"项目处理人",dataIndex:"user",width:"18%",key:"sort",scopedSlots:{customRender:"user"}},{title:"所需完成时间",dataIndex:"finish_time",width:"18%",key:"finish_time",scopedSlots:{customRender:"finish_time"}},{title:"项目提醒",dataIndex:"level",width:"23%",key:"level",scopedSlots:{customRender:"level"}}],S=[{title:"待办项目",dataIndex:"title3",width:"180px",key:"title3",scopedSlots:{customRender:"title3"}},{title:"项目描述",dataIndex:"desc",width:"20%",key:"desc",scopedSlots:{customRender:"desc"}},{title:"项目处理人",dataIndex:"user",width:"15%",key:"sort",scopedSlots:{customRender:"user"}},{title:"所需完成时间",dataIndex:"finish_time",width:"15%",key:"finish_time",scopedSlots:{customRender:"finish_time"}},{title:"项目提醒",dataIndex:"level",width:"20%",key:"level",scopedSlots:{customRender:"level"}},{dataIndex:"action",title:"操作",key:"action",width:"15%",scopedSlots:{customRender:"action"}}],k={name:"todoManagementSetting",components:{"color-picker":r["Sketch"],chooseStaffSelect:o["a"],WeChatModal:l["a"],VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}},TodoAction:m,TodoPriority:b},data:function(){var t=this.$createElement,e=this,i=[{title:"客户跟进阶段",dataIndex:"projectName",width:"180px",key:"projectName",customRender:function(t,e,i){return{children:t,attrs:{rowSpan:e.rowSpan}}}},{title:"完成服务待办",dataIndex:"priorityName",width:"20%",key:"priorityName",scopedSlots:{customRender:"priorityName"}},{title:"项目规则",dataIndex:"priorityDesc",width:"35%",key:"priorityDesc",scopedSlots:{customRender:"priorityDesc"}},{title:"达到更改客户状态条件",dataIndex:"priorityDate",width:"25%",key:"priorityDate",customRender:function(e,i,s){var a=t("todo-priority",{attrs:{record:i}});return{children:a,attrs:{rowSpan:i.rowSpan}}}}],s=[{title:"项目阶段",dataIndex:"projectName",width:"180px",key:"projectName",customRender:function(t,e,i){return{children:t,attrs:{rowSpan:e.rowSpan}}}},{title:"待办项目",dataIndex:"priorityName",width:"15%",key:"priorityName",scopedSlots:{customRender:"priorityName"}},{title:"项目规则",dataIndex:"priorityDesc",width:"30%",key:"priorityDesc",scopedSlots:{customRender:"priorityDesc"}},{title:"进入到下一阶段条件",dataIndex:"priorityDate",width:"20%",key:"priorityDate",customRender:function(e,i,s){var a=t("todo-priority",{attrs:{record:i}});return{children:a,attrs:{rowSpan:i.rowSpan}}}},{dataIndex:"rowSpan",title:"操作",key:"rowSpan",width:"20%",customRender:function(i,s,a){var n;return n=""===s.content.title?t("todo-action",{attrs:{has:"'todoManagementSetting-all'",buttonText:"添加任务",callback:e.addCustom2,record:s,index:a}}):t("todo-action",{attrs:{type:["","danger"],has:["'todoManagementSetting-all'","'todoManagementSetting-all'"],buttonText:["编辑","清空任务"],callback:[e.editCustom,e.delCustom],record:s,index:a}}),{children:n,attrs:{rowSpan:s.rowSpan}}}}];return{corpId:localStorage.getItem("corpId"),stateAll:!1,openIndex2:null,showState:!0,showModal2:!1,corpName:localStorage.getItem("corpName"),init:null,obj4:[],isLoadingb:!1,editIndex:null,showName:null,isAddOrEdit:null,isIndex:null,projectName:"",nums:null,way:[],follow_id:"请选择跟进状态",follows:[],followTitle:"",switchState:0,value2:[],value3:[],userIndex:null,sortSum:1,openDate:1,need:1,value:1,radioStyle1:{display:"inline-block",height:"30px",lineHeight:"40px",marginBottom:"10px"},radioStyle:{display:"block",height:"30px",lineHeight:"40px",marginBottom:"10px"},customVisible:!1,customAddOrEditTitle:"",content:[{task_id:0,title:"请选择项目名称",project_id:0,userInfo:"",descTitle:[],type:1,days:"",date:null}],customList:[],arr:[],tableList:[],page1:1,count1:0,isLoading5:!1,openIndex:null,openStyle:null,obj3:[],suite_id:1,appList:[],appId:"",projectRemind:[{type:"1",days:1}],userList:[],startId3:null,endId3:null,departmentName:"",projectUserId:"请选择企业成员",intNum:0,name:"",selectUserId:"",projectUserName:null,projectDay:3,projectLevelTitle:"选择优先级",index:0,isLoading3:!1,projectColor:"#FFF",projectTitle:"",projectDesc:"",projectVisible:!1,projectAddOrEditTitle:"",projectList:[],obj2:[],user:"",remind:"",startId2:null,endId2:null,priorityColor:"#FFF",isLoading:!1,priorityTitle:"",priorityDesc:"",priorityVisible:!1,priorityAddOrEditTitle:"",priorityList:[],obj1:[],startId:null,endId:null,color:"#FFF",isLoading1:!1,followVisible:!1,addOrEditTitle:"",title:"",desc:"",executionStatusList:[],current:0,steps:[{title:"选择企业微信"},{title:"自定义待办项目"},{title:"客户阶段关联待办项目"}],createLoading:!1,columns1:_,columns2:S,columns3:i,columns4:s,page:1,pageSize:15,total:0,quickJumper:!1}},mounted:function(){this.getDefaultData(),this.getAppList(),this.getAllStaffList()},watch:{value2:function(t){console.log("selected:",t)},value3:function(t){console.log("selected:",t)},follow_id:function(t){console.log(t)},current:function(){0==this.current||1==this.current||2==this.current&&this.getFollowStatus()},init:function(){0==this.init&&(this.stateAll=!0)}},methods:{limitDecimals:function(t){var e=/[^\d]/g;return"string"==typeof t?isNaN(Number(t))?"":t.replace(e,""):"number"==typeof t?isNaN(t)?"":String(t).replace(e,""):""},inputNum:function(t){if(t.data){var e=/^[0-9]+$/;e.test(t.data)||(this.projectDay=parseInt(this.projectDay.toString().substring(0,this.projectDay.toString().length-1))||"")}console.log(t)},changePage:function(t,e){this.page=t;var i=this.getPageData(this.tableList,this.page,this.pageSize);this.page=i.page,this.projectList=i.list,this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,0)}))},showSizeChange:function(t,e){this.pageSize=e;var i=this.getPageData(this.tableList,this.page,this.pageSize);this.page=i.page,this.projectList=i.list,this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,0)}))},changeCorp:function(){this.showModal2=!0},modalVisibleChange:function(t,e,i){"ok"==t&&this.corpId!=e&&(this.corpId=e,this.corpName=i),this.showModal2=!1},editChange3:function(t,e){this.priorityList[t].title=e},editChange4:function(t,e){this.priorityList[t].desc=e},editChange2:function(t,e){this.executionStatusList[t].title=e},editChange1:function(t,e){this.executionStatusList[t].desc=e},editAll:function(){this.obj1=JSON.parse(JSON.stringify(this.executionStatusList)),this.obj2=JSON.parse(JSON.stringify(this.priorityList)),this.obj3=JSON.parse(JSON.stringify(this.projectList)),this.obj4=JSON.parse(JSON.stringify(this.customList)),this.stateAll=!0},notEditAll:function(){this.executionStatusList=JSON.parse(JSON.stringify(this.obj1)),this.priorityList=JSON.parse(JSON.stringify(this.obj2)),this.projectList=JSON.parse(JSON.stringify(this.obj3)),this.customList=JSON.parse(JSON.stringify(this.obj4)),this.$message.warning("已取消编辑"),this.stateAll=!1},getDefaultData:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,s,a,n,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:1,i=r.length>1&&void 0!==r[1]?r[1]:this.pageSize,this.isLoading1=!0,t.next=5,this.axios.post("wait-project/detail",{uid:localStorage.getItem("uid"),corp_id:this.corpId,page:e,pageSize:i});case 5:s=t.sent,a=s.data,0!=a.error?(this.isLoading1=!1,this.$message.error(a.error_msg)):(this.init=a.data.init,0==this.init&&(this.stateAll=!0),this.appId=a.data.agent_id+"",this.executionStatusList=a.data.project_status,this.total=a.data.count,this.priorityList=a.data.project_level,this.customList=a.data.task,this.tableList=a.data.project,n=this.getPageData(this.tableList,this.page,this.pageSize),this.page=n.page,this.projectList=n.list,console.log(a.data),this.isLoading1=!1);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getPageData:function(t,e,i){if(0==t.length)return{page:e,list:[]};var s=e*i,a=(e-1)*i,n={page:e,list:[]};t.length<s&&(s=t.length),a>t.length-1&&(t.length%i!=0?(a=parseInt(t.length/i)*i,n.page=parseInt(t.length/i)+1):(a=(parseInt(t.length/i)-1)*i,n.page=parseInt(t.length/i)));for(var r=a;r<s;r++)n.list.push(t[r]);return n},setDragTable3:function(){var t=this;this.$nextTick((function(){if(this.projectList!=[])for(var e=document.getElementsByClassName("follow-table3")[0].getElementsByTagName("tr"),i=1;i<e.length;i++)e[i].setAttribute("draggable",!0),e[i].setAttribute("data-id3",i-1),e[i].addEventListener("dragstart",t.dragStart),e[i].addEventListener("drop",t.drop),e[i].addEventListener("dragover",t.dragOver)}))},selectOpenDate:function(t){this.openDate=t.target.value,console.log(this.openDate)},changeOpenDate1:function(t){t.days=null},dragOver:function(t){t.preventDefault()},dragStart:function(t){1==this.current&&(this.startId3=parseInt(t.currentTarget.attributes["data-id3"].value))},drop:function(t){var e,i;if(1==this.current){if(this.endId3=parseInt(t.currentTarget.attributes["data-id3"].value),e=this.startId3+(this.page-1)*this.pageSize,i=this.endId3+(this.page-1)*this.pageSize,i<e){for(var s=JSON.parse(JSON.stringify(this.projectList[this.startId3])),a=this.startId3;a>this.endId3;a--)this.projectList[a]=JSON.parse(JSON.stringify(this.projectList[a-1]));for(var n=e;n>i;n--)this.tableList[n]=JSON.parse(JSON.stringify(this.tableList[n-1]));this.projectList[this.endId3]=JSON.parse(JSON.stringify(s)),this.tableList[i]=JSON.parse(JSON.stringify(s))}else{for(var r=JSON.parse(JSON.stringify(this.projectList[this.startId3])),o=this.startId3;o<this.endId3;o++)this.projectList[o]=JSON.parse(JSON.stringify(this.projectList[o+1]));for(var l=e;l<i;l++)this.tableList[l]=JSON.parse(JSON.stringify(this.tableList[l+1]));this.projectList[this.endId3]=JSON.parse(JSON.stringify(r)),this.tableList[i]=JSON.parse(JSON.stringify(r))}this.projectList=JSON.parse(JSON.stringify(this.projectList)),this.tableList=JSON.parse(JSON.stringify(this.tableList))}},customChange:function(t){this.need=t.target.value,console.log("radio checked",t.target.value),1==this.need&&(this.way=[],this.value2=[],this.value3=[],this.nums=1)},delCustom:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,i){var s,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this,s="是否确认清空任务？",0!==e.content.project_id){t.next=6;break}this.deleteCustom(s,e,i),t.next=11;break;case 6:return t.next=8,this.axios.post("wait-project/del-project-task",{id:e.follow_id,type:1});case 8:a=t.sent,n=a.data,0!=n.error?this.$message.error(n.error_msg):(1==n.data.is_del&&(s="当前客户正在服务中，一旦清空后，无法再对该客户进行待办服务。确定要清空服务待办吗？"),this.deleteCustom(s,e,i));case 11:case"end":return t.stop()}}),t,this)})));function e(e,i){return t.apply(this,arguments)}return e}(),deleteCustom:function(t,e,i){var s=this,a={content:{task_id:0,title:"",project_id:0,userInfo:"",descTitle:[],type:1,days:"",date:null},follow_id:e.follow_id,is_change:1,num:null,projectName:e.projectName,project_one:[],project_two:[],type:0,way:[],rowSpan:1};this.$confirm({title:t,okText:"是",okType:"danger",cancelText:"否",onOk:function(){var t=s.customList[i].rowSpan;s.customList.splice(i,1,a);for(var e=1;e<t;e++)s.customList.splice(i+1,1)},onCancel:function(){}})},switchChange:function(t){this.switchState=0==t?0:1,console.log(this.switchState)},addCustom:function(){this.showState=!0,this.isAddOrEdit=1,this.customAddOrEditTitle="添加任务",this.follow_id="请选择跟进状态",this.need=1,this.switchState=1,this.way=[],this.nums=1,this.value2=[],this.value3=[],this.content=[{task_id:0,title:"请选择项目名称",project_id:0,userInfo:"",descTitle:[],type:1,days:"",date:null}],this.projectName="",this.getFollowStatus(),this.customVisible=!0},addCustom2:function(t,e){0==t.is_change?(this.showState=!0,this.switchState=0):(this.showState=!0,this.switchState=1),this.follow_id=t.follow_id,this.need=1,this.way=[],this.nums=1,this.value2=[],this.value3=[],this.content=[{task_id:0,title:"请选择项目名称",project_id:0,userInfo:"",descTitle:[],type:1,days:"",date:null}],this.projectName="",this.editIndex=e,this.showName=t.projectName,this.customAddOrEditTitle="添加任务",this.getFollowStatus(),this.getContent(),this.isAddOrEdit=3,this.customVisible=!0},editCustom:function(t,e){t.is_change,this.showState=!0,this.editIndex=e,this.showName=t.projectName,this.customAddOrEditTitle="编辑任务",this.isAddOrEdit=2,this.follow_id=t.follow_id,this.need=0!=t.type?t.type:1,this.switchState=t.is_change,this.way=JSON.parse(JSON.stringify(t.way)),this.nums=t.num?t.num:1,this.value2=JSON.parse(JSON.stringify(t.project_one)),this.value3=JSON.parse(JSON.stringify(t.project_two)),this.content=[];for(var i=0;i<t.rowSpan;i++)this.content.push(JSON.parse(JSON.stringify(this.customList[e+i].content)));this.projectName=t.projectName,this.customVisible=!0,this.getContent()},handleCustomSelect:function(){},handleCancelCustom:function(){this.arr=[],this.customVisible=!1,this.follow_id="请选择跟进状态",this.need=1,this.switchState=1,this.way=[],this.nums=1,this.value2=[],this.value3=[],this.content=[{task_id:0,title:"请选择项目名称",project_id:0,userInfo:"",descTitle:[],type:1,days:"",date:null}],this.projectName=""},isDisabled:function(t,e){for(var i=0;i<this.arr.length;i++)if(this.arr[i].title==t&&t!=e)return!0;return!1},getContent:function(){this.arr=[];for(var t=0;t<this.customList.length;t++)(t<this.editIndex||this.editIndex+this.customList[this.editIndex].rowSpan-1<t)&&""!=this.customList[t].content.title&&this.arr.push(this.customList[t].content);function e(t){return Array.from(new Set(t))}this.arr=this.arr.concat(this.content),this.arr=e(this.arr)},handleCustom:function(){var t=this;if("请选择跟进状态"==this.follow_id)return this.$message.destroy(),this.$message.warning("请选择跟进状态"),!1;for(var e=!1,i=0;i<this.content.length;i++){if("请选择项目名称"==this.content[i].title)return e=!0,this.$message.destroy(),this.$message.warning("请选择项目名称"),!1;if(this.content[i].days<0)return e=!0,this.$message.destroy(),this.$message.warning("项目开启时间不能小于0天"),!1;if(3==this.content[i].type&&(""==this.content[i].days||null==this.content[i].days))return e=!0,this.$message.destroy(),this.$message.warning("请输入开启时间"),!1}if(2==this.need){var s=this;this.way.filter((function(t){if(1==t){if(0==s.value2.length)return e=!0,s.$message.destroy(),s.$message.warning("请选择至少完成的项目"),!1;if(!s.nums)return e=!0,s.$message.destroy(),s.$message.warning("请选择进入下阶段至少完成的项目数量"),!1}else if(2==t&&0==s.value3.length)return e=!0,s.$message.destroy(),s.$message.warning("请选择需完成项目"),!1}))}if(this.value2.length>0&&this.nums>this.value2.length)return e=!0,this.$message.destroy(),this.$message.warning("所选项目数不能大于项目总数"),!1;if(2==this.need&&0==this.way.length)return e=!0,this.$message.destroy(),this.$message.warning("请选择更改客户状态条件"),!1;if(1==e)return!1;this.projectName=this.follows.find((function(e){return e.id==t.follow_id})).title;var a={follow_id:this.follow_id,type:this.need,is_change:this.switchState,way:this.way,num:Number(this.nums),project_one:this.value2,project_two:this.value3,content:this.content,projectName:this.projectName,rowSpan:1},n=!1;if(1==n)return!1;if(a.content.length<1)return this.$message.destroy(),this.$message.warning("请选择项目，如无需选择，请取消操作"),!1;if(""==this.customList[this.editIndex].content.title)for(var r=0;r<a.content.length;r++){this.editIndex;if(0==r)this.customList[this.editIndex].follow_id=a.follow_id,this.customList[this.editIndex].type=a.type,this.customList[this.editIndex].is_change=a.is_change,this.customList[this.editIndex].way=a.way,this.customList[this.editIndex].num=a.num,this.customList[this.editIndex].project_one=a.project_one,this.customList[this.editIndex].project_two=a.project_two,this.customList[this.editIndex].content=a.content[r],this.customList[this.editIndex].rowSpan=a.content.length;else{var o=JSON.parse(JSON.stringify(a));o.content=o.content[r],o.rowSpan=0,this.customList.splice(this.editIndex+r,0,o)}}else{for(var l=this.customList[this.editIndex].rowSpan-1;l>0;l--)this.customList.splice(this.editIndex+l,1);for(var c=0;c<a.content.length;c++){this.editIndex;if(0==c)this.customList[this.editIndex].follow_id=a.follow_id,this.customList[this.editIndex].type=a.type,this.customList[this.editIndex].is_change=a.is_change,this.customList[this.editIndex].way=a.way,this.customList[this.editIndex].num=a.num,this.customList[this.editIndex].project_one=a.project_one,this.customList[this.editIndex].project_two=a.project_two,this.customList[this.editIndex].content=a.content[c],this.customList[this.editIndex].rowSpan=a.content.length;else{var d=JSON.parse(JSON.stringify(a));d.content=d.content[c],d.rowSpan=0,this.customList.length<=this.editIndex+1?this.customList.splice(this.editIndex+c,0,d):this.customList.length>this.editIndex+c&&this.customList[this.editIndex+c]["follow_id"]!=a.follow_id?this.customList.splice(this.editIndex+c,0,d):this.customList.splice(this.editIndex+c,1,d)}}}this.customVisible=!1,this.arr=[]},addProjectIndex:function(){var t={title:"请选择项目名称",userInfo:"",descTitle:[],project_id:0,type:1,days:"",date:null};this.content.push(t),this.getContent()},deleteProjectIndex:function(t){var e=this,i=this.value2.findIndex((function(i){return i==e.content[t].title}));i>-1&&this.value2.splice(i,1);var s=this.value3.findIndex((function(i){return i==e.content[t].title}));if(s>-1&&this.value3.splice(s,1),this.nums>this.value2.length&&(this.nums=this.nums-1==0?1:this.nums-1),0==t&&1==this.content.length){var a={title:"请选择项目名称",userInfo:"",descTitle:[],project_id:0,type:1,days:"",date:null};this.content.splice(t,1,a)}else this.content.splice(t,1);this.getContent()},delProjectIndex:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var i,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=this,0!==this.content[e].project_id){t.next=5;break}this.deleteProjectIndex(e),t.next=10;break;case 5:return t.next=7,this.axios.post("wait-project/del-project-task",{id:this.follow_id,project_id:this.content[e].project_id,type:1});case 7:s=t.sent,a=s.data,0!=a.error?this.$message.error(a.error_msg):1==a.data.is_del?this.$confirm({title:"当前客户正在服务中，一旦删除后，无法再对该客户进行待办服务。确定要删除服务待办吗？",okText:"是",okType:"danger",cancelText:"否",onOk:function(){i.deleteProjectIndex(e)},onCancel:function(){}}):this.deleteProjectIndex(e);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),peojectSelect:function(t,e){this.content[e].userInfo=this.tableList.find((function(e){return e.title==t})).user,this.content[e].descTitle=this.tableList.find((function(e){return e.title==t})).remind,this.content[e].date=this.tableList.find((function(e){return e.title==t})).finish_time,this.getContent()},handleChange1:function(t){this.projectType=t},handleChange:function(t){console.log("selected ".concat(t))},projectDescChange:function(t){this.projectDesc=t.target.value},getAllStaffList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,s,a,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:1,i=n.length>1?n[1]:void 0,this.isLoading=!0,t.next=5,this.axios.post("work-user/get-all-user",{user_id:i,corp_id:this.corpId,is_all:0,name:this.name,page:e});case 5:s=t.sent,a=s.data,0!=a.error?(this.isLoading5=!1,this.$message.error(a.error_msg)):(this.isLoading5=!1,this.count1=a.data.count,this.userList=1==e?a.data.info:this.userList.concat(a.data.info),i&&(this.projectUserId=i),this.page1=e);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getAppList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("work-group-sending/agent-list",{corp_id:this.corpId,suite_id:this.suite_id});case 2:i=t.sent,s=i.data,0!=s.error?(this.isLoading=!1,this.$message.error(s.error_msg)):(this.appList=s.data,e?this.appId=e:0==this.appList.length||e||(this.appId=this.appList[0].id));case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),addProjectRemind:function(t){var e={type:"1",days:1};this.projectRemind.splice(t+1,0,e)},delProjectRemind:function(t){this.projectRemind.splice(t,1)},onChange:function(t){this.way=JSON.parse(JSON.stringify(t))},getFollowStatus:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("custom-field/follow",{uid:localStorage.getItem("uid"),status:1});case 2:e=t.sent,i=e.data,0!=i.error?this.$message.error(i.error_msg):(this.follows=i.data.follow,1==this.is_follow_del&&(s={id:this.follow_id,title:this.followTitle,status:0},this.follows.unshift(s)));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),projectChange:function(t){},selectStaffCallback2:function(t,e,i){"ok"==t&&(this.projectUserId=e,console.log(t))},addProject:function(){this.openStyle=!0,this.getAllStaffList(),this.projectTitle="",this.projectDesc="",this.projectRemind=[{type:"1",days:1}],this.projectDay=3,this.projectLevelTitle="选择优先级",this.projectUserId="请选择企业成员",this.projectUserName=null,this.projectAddOrEditTitle="添加待办项目",this.projectVisible=!0},editProject:function(t,e){this.editProjectName=t.title,this.getAllStaffList(1,t.user_id),this.openStyle=!1,this.openIndex=e,this.projectAddOrEditTitle="编辑待办项目",this.projectTitle=t.title,this.projectDesc=t.desc,this.projectRemind=JSON.parse(JSON.stringify(t.remind)),this.projectRemind.filter((function(t){1==t.type?t.type="1":2==t.type&&(t.type="2")})),this.userList,this.projectDay=t.finish_time,this.projectLevelTitle=t.level,this.projectUserName=t.user,this.projectVisible=!0},delProject:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,i){var s,a,n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=!1,a=0;case 2:if(!(a<this.customList.length)){t.next=10;break}if(e.title!=this.customList[a].content.title){t.next=7;break}return this.$message.warning("当前待办项目【"+e.title+"】已关联在客户阶段【"+this.customList[a].projectName+"】中，暂不可删除。"),s=!0,t.abrupt("return",!1);case 7:a++,t.next=2;break;case 10:if(!s){t.next=12;break}return t.abrupt("return",!1);case 12:if(n="是否确认删除项目?",0!=e.id){t.next=17;break}this.deleteProject(e,n,i),t.next=22;break;case 17:return t.next=19,this.axios.post("wait-project/del-project-task",{id:e.id,type:0});case 19:r=t.sent,o=r.data,0!=o.error?this.$message.error(o.error_msg):(1==o.data.is_del&&(n="当前客户正在服务中，一旦删除后，无法再对该客户进行待办服务。确定要删除【"+e.title+"】吗？"),this.deleteProject(e,n,i));case 22:case"end":return t.stop()}}),t,this)})));function e(e,i){return t.apply(this,arguments)}return e}(),deleteProject:function(t,e,i){var s=this;this.$confirm({title:e,okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){i=15*(s.page-1)+i,i==s.tableList.length-1&&(i+1)%15==1&&(s.page=s.page-1==0?1:s.page-1),s.tableList.splice(i,1),s.total=s.tableList.length,s.getPageData(s.tableList,s.page,s.pageSize);var e=s.getPageData(s.tableList,s.page,s.pageSize);s.page=e.page,s.projectList=e.list;for(var a=function(e){s.customList[e].content.length>0&&1==s.customList[e].content.length?s.customList[e].content.filter((function(i){i.project_id==t.id&&(s.customList[e].content=[],s.customList[e].is_change=1,s.customList[e].way=[],s.customList[e].num=null,s.customList[e].project_one=[],s.customList[e].project_two=[],s.customList[e].type=0)})):s.customList[e].content.length>1&&s.customList[e].content.filter((function(i){if(i.project_id==t.id){var a=s.customList[e].content.findIndex((function(e){return e.project_id==t.id}));s.customList[e].content.splice(a,1)}}))},n=0;n<s.customList.length;n++)a(n)},onCancel:function(){}})},onSelectChange3:function(t){console.log(t)},handleCancelProject:function(){this.selectUserId="",this.name="",this.projectVisible=!1},handleProject:function(){var t=this;if(""==this.projectTitle.trim())return this.$message.destroy(),this.$message.warning("项目名称不能为空"),!1;if("请选择企业成员"==this.projectUserId)return this.$message.destroy(),this.$message.warning("请选择项目处理人"),!1;if(""==this.projectDay||null==this.projectDay)return this.$message.destroy(),this.$message.warning("请选择项目完成时间"),!1;if(this.projectDay<1)return this.$message.destroy(),this.$message.warning("项目完成时间需大于0天"),!1;if("选择优先级"==this.projectLevelTitle)return this.$message.destroy(),this.$message.warning("请选择优先级"),!1;var e=!1;switch(this.openStyle){case!0:this.projectList.filter((function(i){if(t.projectTitle==i.title)return e=!0,t.$message.destroy(),t.$message.warning("项目名称已存在"),!1}));break;case!1:for(var i=[],s=0;s<this.projectList.length;s++)s!=this.openIndex&&i.push(this.projectList[s]);i.filter((function(i){if(t.projectTitle==i.title)return e=!0,t.$message.destroy(),t.$message.warning("项目名称已存在"),!1}));break}this.projectUserName=this.userList.find((function(e){return e.id==t.projectUserId})).name;for(var a=0;a<this.projectRemind.length;a++)if(this.projectRemind[a].days=this.projectRemind[a].days?this.projectRemind[a].days:0,1==this.projectRemind[a].type){if(this.projectRemind[a].days>this.projectDay)return e=!0,this.$message.destroy(),this.$message.warning("项目提醒预计截止时间前的天数不能大于项目完成时间"),!1;if(this.projectRemind[a].days<1)return e=!0,this.$message.destroy(),this.$message.warning("项目提醒预计截止时间前的天数应大于0天"),!1}else if(2==this.projectRemind[a].type&&this.projectRemind[a].days<1)return e=!0,this.$message.destroy(),this.$message.warning("项目超时提醒天数应大于0天"),!1;for(var n=0;n<this.projectRemind.length-1;n++)for(var r=n+1;r<this.projectRemind.length;r++)if(this.projectRemind[n].type==this.projectRemind[r].type&&this.projectRemind[n].days==this.projectRemind[r].days)return e=!0,this.$message.destroy(),this.$message.warning("同一条件下所设置的任务提醒天数不能重复"),!1;if(1==e)return!1;var o={title:this.projectTitle,remind:this.projectRemind,desc:this.projectDesc,sort:this.sortSum++,user:this.projectUserName,finish_time:this.projectDay,user_id:this.projectUserId,id:0,level:this.projectLevelTitle,depart_name:this.departmentName};if(1==this.openStyle)this.tableList.unshift(o),this.projectList.unshift(o),this.total=this.tableList.length,this.getPageData(this.tableList,this.page,this.pageSize);else if(0==this.openStyle){this.tableList.length>15&&(this.openIndex=15*(this.page-1)+this.openIndex),o.id=this.tableList[this.openIndex].id,o.depart_name=this.departmentName||this.tableList[this.openIndex].depart_name;for(var l=0;l<this.customList.length;l++)this.tableList[this.openIndex].title==this.customList[l].content.title&&(this.customList[l].content.title=o.title,this.customList[l].content.descTitle=o.remind,this.customList[l].content.project_id=o.id,this.customList[l].content.userInfo=o.user,this.customList[l].content.date=this.projectDay);this.tableList.splice(this.openIndex,1,o),this.total=this.tableList.length,this.getPageData(this.tableList,this.page,this.pageSize);var c=this.getPageData(this.tableList,this.page,this.pageSize);this.page=c.page,this.projectList=c.list}this.projectVisible=!1,this.name=""},focusUser:function(){""!=this.name&&(this.name="",this.getAllStaffList())},searchUser:function(t){this.name=t,clearTimeout(this.intNum);var e=this;this.intNum=setTimeout((function(){e.getAllStaffList(1,e.projectUserId)}),500)},changeSelect:function(t){this.departmentName=this.userList.find((function(e){return e.id==t})).department_name},popScroll:function(t){var e=t.target;e.scrollTop+e.offsetHeight===e.scrollHeight&&this.userList.length<this.count1&&(this.page1++,this.getAllStaffList(this.page1,this.projectUserId))},createActivity:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(this.isLoadingb=!0,e=JSON.parse(JSON.stringify(this.customList)),i=0;i<e.length;i++)""==e[i].content.title&&(e[i].content=[]);return t.next=5,this.axios.post("wait-project/add",{uid:localStorage.getItem("uid"),agent_id:this.appId,corp_id:this.corpId,project:this.tableList,task:e});case 5:s=t.sent,a=s.data,0!=a.error?(this.isLoadingb=!1,this.$message.error(a.error_msg)):(this.isLoadingb=!1,this.current=0,this.stateAll=!1,this.getDefaultData());case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeCurrent:function(t){this.current=t},next:function(){this.current++},prev:function(){this.current--},rowClassName:function(t,e){var i="dark-row";return e%2===0&&(i="light-row"),i}},created:function(){}},j=k,L=(i("3e6b"),Object(u["a"])(j,s,a,!1,null,"6639d922",null));e["default"]=L.exports},95204:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",optionFilterProp:"children",filterOption:!1,placeholder:"请选择企业成员",disabled:t.disabled},on:{focus:t.focusSelect,select:t.changeSelect,popupScroll:t.popScroll,search:t.searchName},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return i("div",{},[i("v-nodes",{attrs:{vnodes:e}}),i("a-spin",{staticStyle:{position:"absolute",bottom:"50%",left:"0",right:"0"},attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}})],1)}}]),model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}},t._l(t.userList,(function(e,s){return i("a-select-option",{key:e.id},[t._v("\n\t\t\t"+t._s(e.name)+"\n\t\t")])})),1)],1)},a=[],n=(i("96cf"),i("3b8d")),r=(i("c5f6"),{props:{callback:{type:Function,default:null},index:{type:Number,default:""},index2:{type:Number,default:""},disabled:{type:Boolean,default:!1},getFisrstStaff:{type:Boolean,default:!1},type:{type:Number,default:0}},components:{VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}}},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{corpId:t,userList:[],userId:[],userName:"",page:1,count:0,isLoading:!1}},created:function(){var t=this;this.$nextTick((function(){t.getAllStaffList()}))},mounted:function(){},methods:{getAllStaffList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,i,s,a,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:1,this.isLoading=!0,i={corp_id:this.corpId,name:this.userName,user_id:this.userId,is_all:0,page:e},1==this.type&&(i.sub_id=localStorage.getItem("sub_id"),i.isMasterAccount=localStorage.getItem("isMasterAccount")),t.next=6,this.axios.post("work-user/get-all-user",i);case 6:s=t.sent,a=s.data,0!=a.error?(this.isLoading=!1,this.$message.error(a.error_msg)):(this.isLoading=!1,this.count=a.data.count,this.getFisrstStaff&&(this.userId=a.data.info[0].id,null!==this.callback&&"function"===typeof this.callback&&(""===this.index&&""===this.index2?this.callback("ok",a.data.info[0].id):this.callback("ok",a.data.info[0].id,this.index,this.index2))),this.userList=1==e?a.data.info:this.userList.concat(a.data.info),this.page=e);case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeSelect:function(t){null!==this.callback&&"function"===typeof this.callback&&(""===this.index&&""===this.index2?this.callback("ok",t):this.callback("ok",t,this.index,this.index2))},focusSelect:function(){""!=this.userName&&(this.page=1,this.userList=[],this.userName="",this.getAllStaffList())},searchName:function(t){this.userName=t,this.getAllStaffList()},popScroll:function(t){var e=t.target;e.scrollTop+e.offsetHeight===e.scrollHeight&&this.userList.length<this.count&&(this.page++,this.getAllStaffList(this.page))}},watch:{userId:{handler:function(t){this.getAllStaffList()},deep:!0},getFisrstStaff:{handler:function(t){this.getAllStaffList()},deep:!0}}}),o=r,l=i("2877"),c=Object(l["a"])(o,s,a,!1,null,"23e05649",null);e["a"]=c.exports},b39a:function(t,e,i){var s=i("d3f4");t.exports=function(t,e){if(!s(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},b6ee:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,"[data-v-440e9184] .ant-radio-button-wrapper{width:200px;height:55px;line-height:47px;padding:0 10px;margin:10px 5px}[data-v-440e9184] .wxtpl .ant-radio-button-wrapper-checked{border:2px solid #1890ff!important}.text[data-v-440e9184]{margin-left:5px;vertical-align:middle;display:inline-block;width:calc(100% - 37px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}",""])},c26b:function(t,e,i){"use strict";var s=i("86cc").f,a=i("2aeb"),n=i("dcbc"),r=i("9b43"),o=i("f605"),l=i("4a59"),c=i("01f9"),d=i("d53b"),p=i("7a56"),h=i("9e1e"),u=i("67ab").fastKey,f=i("b39a"),m=h?"_s":"size",g=function(t,e){var i,s=u(e);if("F"!==s)return t._i[s];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,c){var d=t((function(t,s){o(t,d,e,"_i"),t._t=e,t._i=a(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=s&&l(s,i,t[c],t)}));return n(d.prototype,{clear:function(){for(var t=f(this,e),i=t._i,s=t._f;s;s=s.n)s.r=!0,s.p&&(s.p=s.p.n=void 0),delete i[s.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var i=f(this,e),s=g(i,t);if(s){var a=s.n,n=s.p;delete i._i[s.i],s.r=!0,n&&(n.n=a),a&&(a.p=n),i._f==s&&(i._f=a),i._l==s&&(i._l=n),i[m]--}return!!s},forEach:function(t){f(this,e);var i,s=r(t,arguments.length>1?arguments[1]:void 0,3);while(i=i?i.n:this._f){s(i.v,i.k,this);while(i&&i.r)i=i.p}},has:function(t){return!!g(f(this,e),t)}}),h&&s(d.prototype,"size",{get:function(){return f(this,e)[m]}}),d},def:function(t,e,i){var s,a,n=g(t,e);return n?n.v=i:(t._l=n={i:a=u(e,!0),k:e,v:i,p:s=t._l,n:void 0,r:!1},t._f||(t._f=n),s&&(s.n=n),t[m]++,"F"!==a&&(t._i[a]=n)),t},getEntry:g,setStrong:function(t,e,i){c(t,e,(function(t,i){this._t=f(t,e),this._k=i,this._l=void 0}),(function(){var t=this,e=t._k,i=t._l;while(i&&i.r)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?d(0,"keys"==e?i.k:"values"==e?i.v:[i.k,i.v]):(t._t=void 0,d(1))}),i?"entries":"values",!i,!0),p(e)}}},e0b8:function(t,e,i){"use strict";var s=i("7726"),a=i("5ca1"),n=i("2aba"),r=i("dcbc"),o=i("67ab"),l=i("4a59"),c=i("f605"),d=i("d3f4"),p=i("79e5"),h=i("5cc5"),u=i("7f20"),f=i("5dbc");t.exports=function(t,e,i,m,g,v){var y=s[t],w=y,x=g?"set":"add",b=w&&w.prototype,_={},S=function(t){var e=b[t];n(b,t,"delete"==t?function(t){return!(v&&!d(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!d(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!d(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,i){return e.call(this,0===t?0:t,i),this})};if("function"==typeof w&&(v||b.forEach&&!p((function(){(new w).entries().next()})))){var k=new w,j=k[x](v?{}:-0,1)!=k,L=p((function(){k.has(1)})),I=h((function(t){new w(t)})),N=!v&&p((function(){var t=new w,e=5;while(e--)t[x](e,e);return!t.has(-0)}));I||(w=e((function(e,i){c(e,w,t);var s=f(new y,e,w);return void 0!=i&&l(i,g,s[x],s),s})),w.prototype=b,b.constructor=w),(L||N)&&(S("delete"),S("has"),g&&S("get")),(N||j)&&S(x),v&&b.clear&&delete b.clear}else w=m.getConstructor(e,t,g,x),r(w.prototype,i),o.NEED=!0;return u(w,t),_[t]=w,a(a.G+a.W+a.F*(w!=y),_),v||m.setStrong(w,t,g),w}},eee0:function(t,e,i){var s=i("2543");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var a=i("499e").default;a("01a46d74",s,!0,{sourceMap:!1,shadowMode:!1})},ffd5:function(t,e,i){"use strict";var s=i("59fe"),a=i.n(s);a.a}}]);