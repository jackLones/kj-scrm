(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ab1de93a"],{4926:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".tab[data-v-637129e4]{width:50%;display:inline-block;text-align:center;height:40px;line-height:40px}.active[data-v-637129e4]{background-color:#1890ff;color:#fff}.team-add[data-v-637129e4]{width:100%;height:50px;line-height:50px}.team-add-icon[data-v-637129e4],.team-add-title[data-v-637129e4]{display:inline-block;margin-left:10px}.team-add-icon[data-v-637129e4]{color:#1e90ff;cursor:pointer;vertical-align:initial}[data-v-637129e4] .ant-tree-node-content-wrapper{display:inline-block;width:calc(100% - 25px)}[data-v-637129e4] .ant-tree-switcher-icon{vertical-align:initial}[data-v-637129e4] .ant-tree-node-content-wrapper.ant-tree-node-selected{background-color:#fff!important}[data-v-637129e4] .ant-popover-inner .ant-popover-inner-content .ant-popover-buttons{display:none!important}.more-operation[data-v-637129e4]:hover{color:#1890ff}[data-v-637129e4] .ant-tree li .ant-tree-node-content-wrapper:hover{background-color:#fff}.ant-tree li span[draggable=true][data-v-637129e4],[data-v-637129e4] .ant-tree li span[draggable]{line-height:25px;height:30px}[data-v-637129e4] .ant-tree li span.ant-tree-switcher{vertical-align:sub}.operation[data-v-637129e4]{margin-bottom:8px;cursor:pointer}.operation2[data-v-637129e4]{margin-bottom:0;cursor:pointer}.operation1[data-v-637129e4]{margin-bottom:0;color:#e2e2e2}.operation[data-v-637129e4]:hover{color:#1890ff}[data-v-637129e4] li.ant-tree-treenode-disabled>.ant-tree-node-content-wrapper span{color:rgba(0,0,0,.65)!important}.store-list[data-v-637129e4]{max-width:350px;margin-top:10px}.store-item[data-v-637129e4]{margin:5px 0;cursor:pointer}.store-spin[data-v-637129e4]{position:fixed;margin-top:140px;margin-left:160px;z-index:9999}.spin-zhezhao[data-v-637129e4]{position:fixed;z-index:999;width:417px;height:350px;margin-top:-10px;background-color:rgba(0,0,0,.04)}",""])},"5b76":function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".custom-order[data-v-32f44c10]{width:100%;height:100%}.ant-layout-header[data-v-32f44c10]{background:#fff;border-bottom:1px solid #e2e2e2;height:50px;min-width:885px;width:100%;line-height:50px;padding:0 20px;font-size:16px;text-align:left}.ant-layout-content[data-v-32f44c10]{margin:20px;min-width:885px;background-color:#fff}.content-msg[data-v-32f44c10]{border:1px solid #ffdda6;background:#fff2db;padding:10px;margin-top:12px}.content-hd[data-v-32f44c10]{margin-top:20px;width:100%;min-width:885px}.content-hd-box[data-v-32f44c10]{line-height:40px}.select-option[data-v-32f44c10]{display:inline-block;margin-right:10px;margin-bottom:10px}.select-option .ant-select[data-v-32f44c10],.select-option input[data-v-32f44c10]{margin-right:5px;width:210px}.content-bd[data-v-32f44c10]{background:#fff;min-height:120px;min-width:885px;width:100%}.content-bd[data-v-32f44c10],.order-mes[data-v-32f44c10]{border:1px solid #e2e2e2}.order-mes[data-v-32f44c10]{margin:12px;padding:10px}[data-v-32f44c10] .dark-row{background:#fafafa}[data-v-32f44c10] .light-row{background:#fff}",""])},"68a1":function(t,e,a){var s=a("4926");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("499e").default;i("261dc6ec",s,!0,{sourceMap:!1,shadowMode:!1})},"6e11":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"custom-order"},[a("a-layout",{staticStyle:{position:"relative",height:"100%",overflow:"hidden"}},[a("a-layout",{staticClass:"scroll",staticStyle:{position:"absolute",left:"0",top:"0",bottom:"0",right:"0","overflow-x":"hidden","overflow-y":"auto"}},[a("a-layout-header",[t._v("顾客订单")]),a("a-layout-content",[a("div",{staticStyle:{padding:"15px 20px",background:"#FFF"}},[a("div",{staticClass:"content-msg"},[a("p",{staticStyle:{"margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t\t1、订单是来源多渠道业务系统订单导入的数据（"),a("span",{staticStyle:{color:"red"}},[t._v("当前支持指定电商系统")]),t._v("，具体使用请联系客服了解），订单需要有明确的下单手机号信息才会视为有效订单，出现在下面，并同时新增顾客。\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t\t2、当前显示的是系统已存在数据，如果是批量导入，如接口批量拉取或者excel文件形式导入的订单，可能会对历史数据造成变更，相关统计数据就会收到影响。\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t\t3、订单归属导购只代表本条订单的所属情况，不说明当前顾客与导购的关联关系。判断标准可能依据导入订单时候携带的参数，也可能是基于系统导购的相关配置。具体见"),a("router-link",{attrs:{to:"/shopCustom/guideSet"}},[t._v("【导购设置】")])],1),a("p",{staticStyle:{"margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t\t4、门店指的是scrm系统的门店，若订单导入时可匹配门店即显示。\n\t\t\t\t\t\t")]),a("p",{staticStyle:{"margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t\t5、邀请渠道是指企微员工发送商城链接的渠道（比如某群或者单聊）从而最终形成的成交，此功能需要业务系统的支持。\n\t\t\t\t\t\t")])]),a("div",{staticClass:"content-hd"},[a("div",{staticClass:"content-hd-box"},[a("span",{staticClass:"select-option"},[a("a-input",{attrs:{placeholder:"请输入订单号"},model:{value:t.orderNo,callback:function(e){t.orderNo=e},expression:"orderNo"}})],1),a("span",{staticClass:"select-option"},[a("a-input",{attrs:{placeholder:"手机号/支付尾号查询"},model:{value:t.phoneNum,callback:function(e){t.phoneNum=e},expression:"phoneNum"}})],1),a("span",{staticClass:"select-option"},[a("chooseStaffSelect",{ref:"staff",staticStyle:{width:"210px","margin-right":"5px"},attrs:{index:0,index2:0,type:2,callback:t.selectStaffCallback}})],1),a("span",{staticClass:"select-option"},[a("a-input",{attrs:{placeholder:"昵称/姓名"},model:{value:t.customName,callback:function(e){t.customName=e},expression:"customName"}})],1),a("span",{staticClass:"select-option"},[0==t.storeIds.length?a("a-button",{staticStyle:{width:"210px","margin-right":"5px"},on:{click:t.showStoreModal}},[a("span",[t._v("选择门店")])]):t._e(),t.storeIds.length>0?[a("a-popover",{attrs:{placement:"right"}},[a("span",{attrs:{slot:"content"},slot:"content"},[a("div",{staticStyle:{"max-width":"375px"}},t._l(t.storeDetail,(function(e,s){return a("a-tag",{key:s,staticStyle:{display:"inline-block",margin:"0 10px 5px 0"},attrs:{color:"orange"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t\t\t\t")])})),1)]),a("a-button",{staticStyle:{width:"210px","margin-right":"5px"},on:{click:t.showStoreModal}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t已选择"+t._s(t.storeIds.length)+"个门店\n\t\t\t\t\t\t\t\t\t\t")])],1)]:t._e()],2),a("span",{staticClass:"select-option"},[a("a-select",{attrs:{showSearch:"",optionFilterProp:"children"},model:{value:t.sourceVal,callback:function(e){t.sourceVal=e},expression:"sourceVal"}},[a("a-select-option",{attrs:{value:-1}},[t._v("选择来源")]),t._l(t.sourceArr,(function(e,s){return a("a-select-option",{key:s,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],2)],1),a("span",{staticClass:"select-option"},[a("a-select",{attrs:{showSearch:"",optionFilterProp:"children"},model:{value:t.payType,callback:function(e){t.payType=e},expression:"payType"}},[a("a-select-option",{attrs:{value:-1}},[t._v("支付方式")]),t._l(t.payTypeArr,(function(e,s){return a("a-select-option",{key:s,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],2)],1),a("span",{staticClass:"select-option"},[a("a-range-picker",{staticStyle:{width:"320px","margin-right":"5px"},attrs:{"show-time":{defaultValue:[t.moment("00:00","HH:mm"),t.moment("23:59","HH:mm")],format:"HH:mm"},format:"YYYY-MM-DD HH:mm",allowClear:"","disabled-date":t.disabledDate},on:{change:function(e){return t.changeTime(e)}},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}})],1),a("span",{staticClass:"select-option"},[a("a-button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:t.searchOrder}},[t._v("查找")]),a("a-button",{staticStyle:{"margin-right":"10px"},on:{click:t.reset}},[t._v("清空")])],1)])]),a("div",{staticClass:"content-bd"},[a("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[a("a-table",{directives:[{name:"has",rawName:"v-has",value:"customOrder-list",expression:"'customOrder-list'"}],attrs:{columns:t.columns,dataSource:t.customList,pagination:!1},scopedSlots:t._u([{key:"pay_time",fn:function(e){return a("span",{},[t._v(t._s(e))])}},{key:"handle",fn:function(e,s){return a("a",{on:{click:function(e){return t.lookDetail(s)}}},[t._v("查看详情")])}}])}),a("div",{staticStyle:{padding:"0 15px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"},{name:"has",rawName:"v-has",value:"customOrder-list",expression:"'customOrder-list'"}],staticClass:"pagination",staticStyle:{margin:"20px 0px",overflow:"hidden"}},[a("div",{staticClass:"pagination",staticStyle:{display:"inline-block",height:"32px",float:"right"}},[a("a-pagination",{attrs:{total:t.total,showSizeChanger:"",showQuickJumper:t.quickJumper,current:t.page,pageSize:t.pageSize,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage,showSizeChange:t.showSizeChange}})],1)])])],1)],1)]),a("chooseDepartment",{ref:"user",attrs:{id:t.corpId,show:t.showModalDepartment,chooseNum:t.chooseNum,callback:t.modalVisibleChange,is_special:1}}),a("a-drawer",{attrs:{title:"订单详情",placement:"right",destroyOnClose:!0,width:500,visible:t.orderDetailVisible},on:{close:t.orderDetailClose}},[a("div",{staticClass:"order-mes"},[a("a-form",[1==t.sourceType?[a("a-form-item",{attrs:{label:"订单号","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.order_no))]),a("a-form-item",{attrs:{label:"支付时间","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.pay_time))]),a("a-form-item",{attrs:{label:"状态","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.status))]),a("a-form-item",{attrs:{label:"订单金额","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.payment_amount))]),a("a-form-item",{attrs:{label:"支付方式","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.payment_method))]),a("a-form-item",{attrs:{label:"下单人","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.buy_name)+"("+t._s(t.detailData.buy_phone)+")")]),a("a-form-item",{attrs:{label:"收货信息","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.receiver_name)+"("+t._s(t.detailData.receiver_phone)+")")]),a("a-form-item",{attrs:{label:"收货地址","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.receiver_address||"--"))]),a("a-form-item",{attrs:{label:"门店","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.scrm_store_name||"无"))]),a("a-form-item",{attrs:{label:"订单分享人","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.share_user_name||"无"))]),a("a-form-item",{attrs:{label:"用券信息","label-col":{span:5},"wrapper-col":{span:19}}},[0!=t.detailData.coupon.length?a("a-table",{staticStyle:{"margin-bottom":"20px"},attrs:{columns:t.couponColumns,dataSource:t.detailData.coupon,rowClassName:t.rowClassName,pagination:!1}}):t._e(),0==t.detailData.coupon.length?a("span",[t._v("无")]):t._e()],1),a("a-form-item",{attrs:{label:"商品信息","label-col":{span:5},"wrapper-col":{span:19}}},[0!=t.detailData.product.length?a("a-table",{attrs:{columns:t.detailColumns1,dataSource:t.detailData.product,rowClassName:t.rowClassName,pagination:!1}}):t._e(),0==t.detailData.product.length?a("span",[t._v("无")]):t._e()],1)]:t._e(),4==t.sourceType?[a("a-form-item",{attrs:{label:"订单号","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.order_id))]),a("a-form-item",{attrs:{label:"支付时间","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.pay_time))]),a("a-form-item",{attrs:{label:"状态","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.status_name))]),a("a-form-item",{attrs:{label:"支付金额","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.order_total_amount))]),a("a-form-item",{attrs:{label:"支付方式","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.pay_type_name))]),a("a-form-item",{attrs:{label:"收货人","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.post_receiver)+"("+t._s(t.detailData.post_tel)+")")]),a("a-form-item",{attrs:{label:"收货地址","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.post_addr||"--"))]),a("a-form-item",{attrs:{label:"APP渠道","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.b_type_name))]),a("a-form-item",{attrs:{label:"业务类型","label-col":{span:5},"wrapper-col":{span:19}}},[t._v(t._s(t.detailData.c_biz_name))]),a("a-form-item",{attrs:{label:"商品信息","label-col":{span:5},"wrapper-col":{span:19}}},[0!=t.detailData.product_info.length?a("a-table",{attrs:{columns:t.detailColumns,dataSource:t.detailData.product_info,rowClassName:t.rowClassName,pagination:!1}}):t._e(),0==t.detailData.product_info.length?a("span",[t._v("无")]):t._e()],1)]:t._e()],2)],1),a("div",{staticStyle:{height:"117px"}},[a("div",{style:{position:"absolute",right:0,bottom:"64px",width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{attrs:{type:"primary"},on:{click:t.orderDetailClose}},[t._v("关闭")])],1)])]),a("store-list",{attrs:{groupVisible:t.storeVisible,storeIds:JSON.parse(JSON.stringify(t.storeIds)),storeDetail:JSON.parse(JSON.stringify(t.storeDetail))},on:{setGroupId:t.setGroupId}})],1)],1)],1)],1)},i=[],o=(a("6b54"),a("96cf"),a("3b8d")),r=a("c1df"),n=a.n(r),l=a("c75b"),c=a("95204"),d=a("7528"),p=[{title:"顾客信息",dataIndex:"customer",key:"customer"},{title:"来源",dataIndex:"source",key:"source",ellipsis:!0},{title:"状态",dataIndex:"status",key:"status",ellipsis:!0},{title:"订单号",dataIndex:"order_no",key:"order_no"},{title:"订单额",dataIndex:"payment_amount",key:"payment_amount"},{title:"支付方式",dataIndex:"payment_method",key:"payment_method"},{title:"关联员工",dataIndex:"guide_name",key:"guide_name"},{title:"门店",dataIndex:"store_name",key:"store_name",ellipsis:!0},{title:"邀请渠道",dataIndex:"from",key:"from",ellipsis:!0},{title:"支付时间",dataIndex:"pay_time",key:"pay_time",scopedSlots:{customRender:"pay_time"},width:"160px"},{title:"操作",dataIndex:"handle",key:"handle",scopedSlots:{customRender:"handle"}}],u=[{title:"商品名称",dataIndex:"product_name",key:"product_name"},{title:"数量",dataIndex:"shipped_num",key:"shipped_num"},{title:"单价",dataIndex:"total_amount",key:"total_amount"},{title:"状态",dataIndex:"status_name",key:"status_name"}],h=[{title:"商品名称",dataIndex:"name",key:"name"},{title:"数量",dataIndex:"product_number",key:"product_number"},{title:"单价",dataIndex:"price",key:"price"}],m=[{title:"券名称",dataIndex:"coupon_name",key:"coupon_name",ellipsis:!0,width:"40%"},{title:"抵扣金额",dataIndex:"coupon_desc",key:"coupon_desc"},{title:"分享人",dataIndex:"guide_name",key:"guide_name"}],g={name:"CustomOrder",components:{chooseDepartment:l["a"],chooseStaffSelect:c["a"],storeList:d["a"]},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{moment:n.a,corpId:t,orderNo:"",phoneNum:"",guideList:[],guideListId:[],chooseNum:0,chooseUserNum:0,chooseDepartmentNum:0,customName:"",store_id:"",sourceArr:["选择来源","有赞","淘宝","电商系统","订单导入"],sourceVal:-1,payTypeArr:["支付方式","支付宝","微信","银行卡"],payType:-1,searchTime:null,start_time:"",end_time:"",cus_id:"",material_type:"",share_id:"",showModalDepartment:!1,isLoading:!1,columns:p,customList:[],page:1,pageSize:15,total:1,quickJumper:!1,orderDetailVisible:!1,detailData:{},sourceType:"",storeVisible:!1,storeIds:[],storeDetail:[],detailColumns:u,detailColumns1:h,couponColumns:m}},methods:{disabledDate:function(t){return t&&t>n()().endOf("day")},changeTime:function(t){var e=this;e.searchTime=t,e.start_time=this.searchTime[0].format("YYYY-MM-DD HH:mm"),e.end_time=this.searchTime[1].format("YYYY-MM-DD HH:mm")},searchOrder:function(){this.getCustomList()},reset:function(){var t=this;t.orderNo="",t.phoneNum="",t.guideList=[],t.guideListId=[],t.chooseNum=0,t.chooseUserNum=0,t.chooseDepartmentNum=0,t.$refs.staff.userId=[],t.customName="",t.store_id="",t.cus_id="",t.sourceVal=-1,t.payType=-1,t.searchTime=null,t.start_time="",t.end_time="",t.storeIds=[],t.storeDetail=[],t.material_type="",t.share_id="",this.getCustomList()},showDepartmentList:function(){this.$refs.user.rightIdList=JSON.parse(JSON.stringify(this.guideListId)),this.$refs.user.rightList=JSON.parse(JSON.stringify(this.guideList)),this.showModalDepartment=!0},modalVisibleChange:function(t,e,a,s,i){"ok"==t&&(this.guideList=i,this.guideListId=e,this.chooseNum=parseInt(a)+parseInt(s),this.chooseUserNum=a,this.chooseDepartmentNum=s),this.showModalDepartment=!1},selectStaffCallback:function(t,e){"ok"==t&&(this.guideListId=e)},getCustomList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,o,r,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:1,a=n.length>1&&void 0!==n[1]?n[1]:this.pageSize,this.isLoading=!0,s=this,i={corp_id:localStorage.getItem("corpId")?localStorage.getItem("corpId"):"",page:e,page_size:a,order_no:s.orderNo,buy_phone:s.phoneNum,guide_id:s.guideListId.toString(),nickname:s.customName,store_id:s.storeIds.length>0?s.storeIds.toString():s.store_id,source:-1==s.sourceVal?"":s.sourceVal,payment_method:-1==s.payType?"":s.payType,add_time_start:s.start_time,add_time_end:s.end_time,cus_id:s.cus_id,share_id:s.share_id,material_type:s.material_type},t.next=7,this.axios.post("shop-customer-order/list",i);case 7:o=t.sent,r=o.data,0!=r.error?(this.isLoading=!1,this.$message.error(r.error_msg)):(this.isLoading=!1,this.sourceArr=r.data.source,this.payTypeArr=r.data.pay_type,this.customList=r.data.result,this.total=parseInt(r.data.count),this.page=e,this.pageSize=a,this.quickJumper=this.total>this.pageSize);case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changePage:function(t,e){this.getCustomList(t,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,40)}))},showSizeChange:function(t,e){this.getCustomList(1,e)},lookDetail:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this,s={corp_id:localStorage.getItem("corpId")?localStorage.getItem("corpId"):"",order_no:e.order_no,source_value:e.source_value,other_store_id:e.other_store_id},i="shop-customer-order/other-order-detail",t.next=5,a.axios.post(i,s);case 5:o=t.sent,r=o.data,0!=r.error?a.$message.error(r.error_msg):(a.sourceType=e.source_value,a.detailData=r.data,a.orderDetailVisible=!0);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),orderDetailClose:function(){this.orderDetailVisible=!1},rowClassName:function(t,e){var a="dark-row";return e%2===0&&(a="light-row"),a},showStoreModal:function(){this.storeVisible=!0},setGroupId:function(t,e,a){"ok"==t&&(this.storeIds=JSON.parse(JSON.stringify(e)),this.storeDetail=JSON.parse(JSON.stringify(a))),this.storeVisible=!1}},mounted:function(){var t=this;this.$store.dispatch("getCorp",(function(e){t.$route.query.id&&(t.guideListId=t.$route.query.id,t.store_id=t.$route.query.store_id,t.start_time=t.$route.query.start_time+" 00:00",t.end_time=t.$route.query.end_time+" 23:59"),t.$route.query.cus_id&&(t.cus_id=t.$route.query.cus_id),t.$route.query.material_type&&(t.material_type=t.$route.query.material_type,t.share_id=t.$route.query.share_id),t.getCustomList()}))}},f=g,_=(a("7ef0"),a("2877")),v=Object(_["a"])(f,s,i,!1,null,"32f44c10",null);e["default"]=v.exports},7528:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.visible?a("a-modal",{attrs:{width:"888px!important",title:"选择门店"},on:{cancel:t.cancelGroup},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.cancelGroup}},[t._v("取消")]),a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.updateGroup}},[t._v("确定\n\t\t\t")])],1),a("div",{staticStyle:{display:"inline-block","border-right":"1px solid #E2E2E2",width:"50%"}},[a("a-input",{staticStyle:{width:"230px",display:"block"},attrs:{placeholder:"请输入门店名称或地址进行查找"},on:{input:t.selectStore},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}}),a("div",{staticClass:"group-tree2",staticStyle:{height:"350px",overflow:"auto"},on:{scroll:t.handleScroll}},[a("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.searchName,expression:"searchName != ''"}],staticClass:"store-list"},[a("a-empty",{directives:[{name:"show",rawName:"v-show",value:0==t.storeList.length&&!t.isLoading,expression:"storeList.length == 0 && !isLoading"}]}),a("a-spin",{staticClass:"store-spin",attrs:{tip:"Loading...",spinning:t.isLoading}}),t.isLoading?a("div",{staticClass:"spin-zhezhao"}):t._e(),t._l(t.storeList,(function(e){return a("div",{staticClass:"store-item",on:{click:function(a){return t.selectId(e.id+"-s",e.shop_name,e.status)}}},[t._v("\n\t\t\t\t\t\t"+t._s(e.shop_name)),0==e.status?[t._v("（门店已关闭）")]:t._e(),a("span",{staticStyle:{color:"rgba(0, 0, 0, 0.3)"}},[t._v("（"+t._s(e.name)+"）")]),t.ids.includes(e.id+"-s")?a("a-icon",{staticStyle:{color:"#1890FF","margin-left":"10px"},attrs:{type:"check"}}):t._e()],2)}))],2),""==t.searchName?a("a-tree",{staticClass:"draggable-tree",attrs:{treeData:t.gData,"load-data":t.onLoadData},on:{select:t.onselect},scopedSlots:t._u([{key:"custom",fn:function(e){var s=e.title,i=e.count,o=e.key,r=e.store;return[t._v("\n\t\t\t\t\t\t"+t._s(s)),r?t._e():[t._v("（"+t._s(i)+"）")],t.ids.includes(o)?a("a-icon",{staticStyle:{color:"#1890FF","margin-left":"10px"},attrs:{type:"check"}}):t._e()]}}],null,!1,3951647589)}):t._e()],1)],1),a("div",{staticStyle:{display:"inline-block",width:"calc(50% - 5px)",height:"390px",overflow:"auto",padding:"4px 20px 10px 20px"}},[t._v("\n\t\t\t已选择的门店\n\t\t\t"),t._l(t.stores,(function(e,s){return a("div",{staticStyle:{margin:"10px 0"}},[t._v("\n\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t"),a("a-icon",{staticStyle:{cursor:"pointer","margin-left":"5px",color:"rgba(0, 0, 0, 0.65)",float:"right"},attrs:{type:"close"},on:{click:function(e){return t.deleteStore(s)}}})],1)}))],2)],2):t._e()],1)},i=[],o=(a("20d6"),a("75fc")),r=(a("ac6a"),a("5df3"),a("96cf"),a("3b8d")),n={name:"Team",props:{groupVisible:{type:Boolean,default:!1},storeIds:{type:Array,default:function(){return[]}},storeDetail:{type:Array,default:function(){return[]}}},watch:{storeIds:function(t,e){this.ids=t},storeDetail:function(t,e){this.stores=t},groupVisible:function(t,e){this.visible=t,this.visible&&this.getGroupList()}},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{corpId:t,searchName:"",ids:"",stores:[],gData:[],groupData:[],visible:!1,timeInter:0,isLoading:!1,storeList:[],page:1,count:0}},mounted:function(){this.ids=this.storeIds,this.stores=this.storeDetail,this.visible=this.groupVisible,this.getGroupList()},methods:{handleScroll:function(){if(""!=this.searchName&&!this.isLoading){var t=document.getElementsByClassName("group-tree2")[0],e=t.scrollTop,a=t.clientHeight,s=t.scrollHeight;e+a==s&&this.count>this.storeList.length&&(this.isLoading=!0,this.selectStoreList(this.page+1))}},selectStore:function(t){""==t.val&&(this.storeList=[],this.page=1),clearTimeout(this.timeInter),this.timeInter=setTimeout(this.selectStoreList,500)},selectStoreList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:1,this.isLoading=!0,t.next=4,this.axios.post("auth-store/get-store-list",{corp_id:this.corpId,group_id:"",uid:localStorage.getItem("uid"),status:"",search_name:this.searchName,page:e,page_size:20});case 4:a=t.sent,s=a.data,0!=s.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(s.error_msg)):(1==e?(this.storeList=s.data.data,this.count=parseInt(s.data.count)):this.storeList=JSON.parse(JSON.stringify(this.storeList.concat(s.data.data))),this.page=e,this.isLoading=!1);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),cancelGroup:function(){this.searchName="",this.page=1,this.count=0,this.storeList=[],this.$emit("setGroupId","cancle")},updateGroup:function(){this.searchName="",this.page=1,this.count=0,this.storeList=[],this.$emit("setGroupId","ok",this.ids,this.stores)},onLoadData:function(t){var e=this;return new Promise((function(a){Promise.all([e.getGroupList(t.dataRef.key)]).then((function(s){t.dataRef.children=e.groupData;e.gData;e.gData=Object(o["a"])(e.gData),a()})).catch((function(t){}))}))},loopObjByKey:function(t,e,a){var s=this;t.forEach((function(t){return t.key==e?a(t):t.children&&t.children.length>0&&!t.isLeaf?s.loopObjByKey(t.children,e,a):void 0}))},getGroupList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/get-group-list",{uid:localStorage.getItem("uid"),corp_id:this.corpId,parent_id:e||"",store:2,choose:1,status:1});case 2:a=t.sent,s=a.data,0!=s.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(s.error_msg)):(e?this.groupData=s.data.data:this.gData=s.data.data,this.isLoading=!1);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),selectId:function(t,e,a){if(0==a)return!1;var s=this.ids.findIndex((function(e){return e==t}));if(s>-1)this.ids.splice(s,1),this.stores.splice(s,1);else{this.ids.push(t);var i={id:t,title:e};this.stores.push(i)}},onselect:function(t,e){if(t.length>0&&this.id!=t[0]){var a=this.ids.findIndex((function(e){return e==t[0]}));if(a>-1)this.ids.splice(a,1),this.stores.splice(a,1);else{this.ids.push(t[0]);var s=this,i={id:t[0],title:e.node.dataRef.title};s.stores.push(i)}}},deleteStore:function(t){this.ids.splice(t,1),this.stores.splice(t,1)}}},l=n,c=(a("7a21"),a("2877")),d=Object(c["a"])(l,s,i,!1,null,"637129e4",null);e["a"]=d.exports},"7a21":function(t,e,a){"use strict";var s=a("68a1"),i=a.n(s);i.a},"7ef0":function(t,e,a){"use strict";var s=a("a90d"),i=a.n(s);i.a},95204:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",optionFilterProp:"children",filterOption:!1,placeholder:2==t.type?"请选择导购":"请选择企业成员",disabled:t.disabled},on:{focus:t.focusSelect,select:t.changeSelect,popupScroll:t.popScroll,search:t.searchName},scopedSlots:t._u([{key:"dropdownRender",fn:function(e){return a("div",{},[a("v-nodes",{attrs:{vnodes:e}}),a("a-spin",{staticStyle:{position:"absolute",bottom:"50%",left:"0",right:"0"},attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}})],1)}}]),model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}},t._l(t.userList,(function(e,s){return a("a-select-option",{key:2==t.type?s:e.id},[t._v("\n\t\t\t"+t._s(e.name)),2==t.type&&e.group_name?a("span",[t._v("("+t._s(e.group_name)+")")]):t._e()])})),1)],1)},i=[],o=(a("96cf"),a("3b8d")),r=(a("c5f6"),{props:{callback:{type:Function,default:null},index:{type:Number,default:-1},index2:{type:Number,default:-1},disabled:{type:Boolean,default:!1},getFisrstStaff:{type:Boolean,default:!1},type:{type:Number,default:0},ignore_dialout:{type:Number,default:0}},components:{VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}}},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{corpId:t,userList:[],userId:[],userName:"",page:1,count:0,isLoading:!1}},created:function(){var t=this;this.$nextTick((function(){t.getAllStaffList()}))},mounted:function(){},methods:{getAllStaffList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,o,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:1,this.isLoading=!0,2==this.type?(a={corp_id:this.corpId,guide_keyword:this.userName,operator:0,page:e,page_size:10},s="shop-customer-guide/list"):(a={corp_id:this.corpId,name:this.userName,user_id:this.userId,is_all:0,page:e,ignore_dialout:this.ignore_dialout},1==this.type&&(a.sub_id=localStorage.getItem("sub_id"),a.isMasterAccount=localStorage.getItem("isMasterAccount")),s="work-user/get-all-user"),t.next=5,this.axios.post(s,a);case 5:i=t.sent,o=i.data,0!=o.error?(this.isLoading=!1,this.$message.error(o.error_msg)):(this.isLoading=!1,this.count=o.data.count,this.getFisrstStaff&&(this.userId=o.data.info[0].id,null!==this.callback&&"function"===typeof this.callback&&(-1===this.index&&-1===this.index2?this.callback("ok",o.data.info[0].id):this.callback("ok",o.data.info[0].id,this.index,this.index2,o.data.info[0]))),1==e?2==this.type?this.userList=o.data.result:this.userList=o.data.info:2==this.type?this.userList=this.userList.concat(o.data.result):this.userList=this.userList.concat(o.data.info),this.page=e);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeSelect:function(t){null!==this.callback&&"function"===typeof this.callback&&(2==this.type?-1===this.index&&-1===this.index2?this.callback("ok",this.userList[t].id):this.callback("ok",this.userList[t].id,this.index,this.index2,this.userList[t]):-1===this.index&&-1===this.index2?this.callback("ok",t):this.callback("ok",t,this.index,this.index2))},focusSelect:function(){""!=this.userName&&(this.page=1,this.userList=[],this.userName="",this.getAllStaffList())},searchName:function(t){this.userName=t,this.getAllStaffList()},popScroll:function(t){var e=t.target;e.scrollTop+e.offsetHeight===e.scrollHeight&&this.userList.length<this.count&&(this.page++,this.getAllStaffList(this.page))}},watch:{userId:{handler:function(t){this.getAllStaffList()},deep:!0},getFisrstStaff:{handler:function(t){this.getAllStaffList()},deep:!0}}}),n=r,l=a("2877"),c=Object(l["a"])(n,s,i,!1,null,"2fbfc039",null);e["a"]=c.exports},a90d:function(t,e,a){var s=a("5b76");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("499e").default;i("f7031f78",s,!0,{sourceMap:!1,shadowMode:!1})}}]);