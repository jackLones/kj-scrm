(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-123a2491"],{"5dcd":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list"},[s("a-layout",{staticClass:"fans-content"},[s("a-layout",{staticClass:"scroll"},[s("a-layout-header",[t._v("通话记录")]),s("a-layout-content",[s("div",{staticClass:"header"},[t.recordList.statis?s("div",{staticClass:"static"},[s("div",{staticClass:"static_content"},[s("div",{staticStyle:{"font-size":"14px"}},[t._v("实际总通话时长")]),s("div",{staticStyle:{"font-size":"18px","font-weight":"700"}},[t._v(t._s(t.recordList.statis.duration_turth))])]),s("div",{staticClass:"static_content"},[s("div",{staticStyle:{"font-size":"14px"}},[t._v("计费总通话时长\n\t\t\t\t\t\t\t\t"),s("a-tooltip",{attrs:{placement:"right"}},[s("template",{slot:"title"},[s("div",[t._v("根据运营商要求，通话不满一分钟按一分钟计算。")])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1),s("div",{staticStyle:{"font-size":"18px","font-weight":"700"}},[t._v(t._s(t.recordList.statis.duration))])]),s("div",{staticClass:"static_content"},[s("div",{staticStyle:{"font-size":"14px"}},[t._v("总拨打次数")]),s("div",{staticStyle:{"font-size":"18px","font-weight":"700"}},[t._v(t._s(t.recordList.statis.total_num))])]),s("div",{staticClass:"static_content"},[s("div",{staticStyle:{"font-size":"14px"}},[t._v("接通总次数")]),s("div",{staticStyle:{"font-size":"18px","font-weight":"700"}},[t._v(t._s(t.recordList.statis.connect_num))])]),s("div",{staticClass:"static_content"},[s("div",{staticStyle:{"font-size":"14px"}},[t._v("未接通总次数")]),s("div",{staticStyle:{"font-size":"18px","font-weight":"700"}},[t._v(t._s(t.recordList.statis.unconnect_num))])])]):t._e(),s("div",{staticClass:"search_card"},[s("div",{staticClass:"search_content"},[s("span",[t._v("关键字：")]),s("a-input",{attrs:{placeholder:"请输入客户名/成员名进行搜索"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList(e)}},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword","string"===typeof e?e.trim():e)},expression:"listQuery.keyword"}})],1),s("div",{staticClass:"search_content"},[s("span",[t._v("时间段：")]),s("a-select",{attrs:{showSearch:"",allowClear:"",placeholder:"请选择时间段",optionFilterProp:"children"},model:{value:t.listQuery.timeRange,callback:function(e){t.$set(t.listQuery,"timeRange",e)},expression:"listQuery.timeRange"}},[t._l(t.timeList,(function(e){return[s("a-select-option",{attrs:{value:e.value}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t")])]}))],2)],1),s("div",{staticClass:"search_content"},[s("span",[t._v("时 长：")]),s("a-select",{staticStyle:{width:"78%"},attrs:{showSearch:"",allowClear:"",placeholder:"请选择时长",optionFilterProp:"children"},model:{value:t.listQuery.timeScope,callback:function(e){t.$set(t.listQuery,"timeScope",e)},expression:"listQuery.timeScope"}},[t._l(t.timeRangeList,(function(e){return[s("a-select-option",{attrs:{value:e.value}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t")])]}))],2)],1),s("div",{staticClass:"search_content",staticStyle:{width:"19%"}},[s("span",[t._v("状 态：")]),s("a-select",{staticStyle:{width:"78%"},attrs:{showSearch:"",allowClear:"",placeholder:"请选择状态",optionFilterProp:"children"},model:{value:t.listQuery.state,callback:function(e){t.$set(t.listQuery,"state",e)},expression:"listQuery.state"}},[t._l(t.statusList,(function(e){return[s("a-select-option",{attrs:{value:e.value}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t\t\t\t")])]}))],2)],1),s("div",{staticClass:"search_content",on:{click:function(e){return t.showDepartmentModel()}}},[s("span",[t._v("选择成员：")]),s("a-button",{staticStyle:{width:"60%",overflow:"hidden","text-overflow":"ellipsis"}},[t.listQuery.staffList&&t.listQuery.staffList.length>0?s("span",[t._v("\n\t\t\t\t\t\t\t\t\t已选择"+t._s(t.listQuery.staff_userNum)+"名成员，"+t._s(t.listQuery.staff_departmentNum)+"个部门\n\t\t\t\t\t\t\t\t")]):s("span",[t._v("选择成员")])])],1),s("div",{staticClass:"search_content"},[s("span",[t._v("时间筛选：")]),s("a-range-picker",{staticStyle:{width:"74%",padding:"0"},on:{change:t.handleTimeChange},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),s("div",{staticClass:"search_content",staticStyle:{width:"30%"}},[s("span",[s("a-radio-group",{on:{change:t.handleTimeRange},model:{value:t.last_time,callback:function(e){t.last_time=e},expression:"last_time"}},[s("a-radio-button",{attrs:{value:0}},[t._v("昨日")]),s("a-radio-button",{attrs:{value:1}},[t._v("今日")]),s("a-radio-button",{attrs:{value:2}},[t._v("本周")]),s("a-radio-button",{attrs:{value:3}},[t._v("本月")]),s("a-radio-button",{attrs:{value:4}},[t._v("自定义")])],1)],1)]),s("div",{staticClass:"search_content",staticStyle:{width:"auto","text-align":"left"}},[s("a-button",{attrs:{type:"primary"},on:{click:t.getList}},[t._v("查找\n\t\t\t\t\t\t\t")]),s("a-button",{staticStyle:{margin:"0 0.7rem"},on:{click:t.clear}},[t._v("清空")])],1)])]),s("div",{staticStyle:{float:"right",margin:"0 1rem",position:"relative"}},[s("a-dropdown",[s("a-menu",{attrs:{slot:"overlay"},on:{click:t.exportData},slot:"overlay"},[s("a-menu-item",{key:0},[t._v("当前页导出")]),s("a-menu-item",{key:1},[t._v("全部导出")])],1),s("a-button",{staticStyle:{margin:"0 0 10px 0"},attrs:{type:"primary",icon:"download"}},[t._v("导出\n\t\t\t\t\t\t\t"),s("a-icon",{staticStyle:{color:"#FFFFFF"},attrs:{type:"down"}})],1)],1)],1),s("div",{staticClass:"content_table"},[s("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.listLoading}},[s("a-table",{attrs:{"data-source":t.recordList.list,pagination:!1,rowClassName:t.rowClassName}},[s("a-table-column",{key:"ring",attrs:{title:"拨打时间","data-index":"ring"},scopedSlots:t._u([{key:"default",fn:function(e,a){return[s("div",[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(a.ring.split(" ")[0])+"\n\t\t\t\t\t\t\t\t\t")]),s("div",[t._v(" "+t._s(a.ring.split(" ")[1])+"\n\t\t\t\t\t\t\t\t\t")])]}}])}),s("a-table-column",{key:"user_name",attrs:{title:"成员拨打","data-index":"user_name"},scopedSlots:t._u([{key:"default",fn:function(e,a){return[s("span",[t._v(t._s(a.user_name+" ("+a.department+")"))])]}}])}),s("a-table-column",{key:"custom_name",attrs:{title:"客户接听","data-index":"custom_name"},scopedSlots:t._u([{key:"default",fn:function(e,a){return[s("span",[t._v(t._s(a.custom_name))])]}}])}),s("a-table-column",{key:"province",attrs:{title:"手机号归属地","data-index":"province"},scopedSlots:t._u([{key:"default",fn:function(e,a){return[s("span",[t._v(t._s(a.province+"-"+a.district))])]}}])}),s("a-table-column",{key:"duration_turth",attrs:{title:"实际通话时长","data-index":"duration_turth"},scopedSlots:t._u([{key:"default",fn:function(e,a){return[s("span",[t._v(t._s(a.duration_turth?a.duration_turth:"--"))])]}}])}),s("a-table-column",{key:"duration",attrs:{"data-index":"duration"},scopedSlots:t._u([{key:"default",fn:function(e,a){return[s("span",[t._v(t._s(a.duration?a.duration:"--"))])]}}])},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("计费通话时长\n\t\t\t\t\t\t\t\t\t"),s("a-tooltip",{attrs:{placement:"bottom"}},[s("template",{slot:"title"},[s("span",[t._v("根据运营商要求，通话不满一分钟按一分钟计算。")])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1)]),s("a-table-column",{key:"state_text",attrs:{"data-index":"state_text"},scopedSlots:t._u([{key:"default",fn:function(e,a){return[s("span",{style:{color:1!=a.state?"red":""}},[t._v(t._s(a.state_text))])]}}])},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("状态\n\t\t\t\t\t\t\t\t\t"),s("a-tooltip",{attrs:{placement:"bottom"}},[s("template",{slot:"title"},[s("span",[t._v("未接通不计费")])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1)]),s("a-table-column",{key:"action",attrs:{"data-index":"tags"},scopedSlots:t._u([{key:"default",fn:function(e,a,i){return[1==a.state?s("a-button",{staticStyle:{"margin-right":"5px"},on:{click:function(e){return t.playAudio(a)}}},[t._v("播放\n\t\t\t\t\t\t\t\t\t")]):t._e(),1==a.state?s("a-button",{staticStyle:{"margin-right":"5px"},on:{click:function(e){return t.downloadFile(a)}}},[t._v("下载\n\t\t\t\t\t\t\t\t\t")]):s("span",[t._v("--")])]}}])},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("操作\n\t\t\t\t\t\t\t\t\t"),s("a-tooltip",{attrs:{placement:"bottom"}},[s("template",{slot:"title"},[s("span",[t._v("因运营商关系，播放时长与下载时长，可能会与实际通话时长略有差异。")])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1)])],1)],1),t.recordList.list&&t.recordList.list.length>0?s("div",{staticClass:"pagination",staticStyle:{display:"flex","justify-content":"space-between",margin:"20px 0"}},[s("div",{staticStyle:{height:"32px","line-height":"32px"}},[t._v("\n\t\t\t\t\t\t\t共"),s("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.total))]),t._v("条\n\t\t\t\t\t\t")]),s("div",{staticStyle:{height:"32px"}},[s("a-pagination",{attrs:{total:t.total,showSizeChanger:"",showQuickJumper:!1,current:1,pageSize:t.listQuery.page_size,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage,showSizeChange:t.showSizeChange},model:{value:t.listQuery.page,callback:function(e){t.$set(t.listQuery,"page",e)},expression:"listQuery.page"}})],1)]):t._e()],1)])],1)],1),s("chooseDepartment",{ref:"user",attrs:{show:t.showDepartment,chooseNum:t.chooseNum,callback:t.departmentChange,isDialout:1,is_from:11}}),s("a-modal",{staticClass:"record",attrs:{visible:t.showPlay,title:"通话录音",cancelText:"关闭"},on:{cancel:t.handleCancel}},[s("template",{slot:"footer"},[s("a-button",{on:{click:t.handleCancel}},[t._v("关闭")])],1),s("div",{staticStyle:{"font-size":"15px","font-weight":"700","line-height":"30px","overflow-y":"hidden"}},[s("div",[s("img",{staticStyle:{width:"20px",height:"20px","vertical-align":"text-bottom"},attrs:{src:a("df74")}}),t._v("\n\t\t\t\t"+t._s(t.selectedRecord.real_called)+"\n\t\t\t")]),s("div",[s("span",[t._v("开始时间：")]),t._v("\n\t\t\t\t"+t._s(t.selectedRecord.begin)+"\n\t\t\t")]),s("div",[s("span",[t._v("结束时间：")]),t._v("\n\t\t\t\t"+t._s(t.selectedRecord.end)+"\n\t\t\t")]),s("div",[s("span",[t._v("通话时长：")]),t._v("\n\t\t\t\t"+t._s(t.selectedRecord.duration_turth)+"\n\t\t\t")])]),s("div",[s("audio-player",{ref:"audioPlayer",attrs:{"show-prev-button":!1,"show-next-button":!1,isLoop:!1,"audio-list":[t.selectedRecord.file_name],"theme-color":"#1890ff"},on:{loadedmetadata:t.loadedmetadata}})],1)],2)],1)},i=[],n=(a("96cf"),a("3b8d")),r=a("c1df"),o=a.n(r),l=a("c75b"),c=a("ac8a"),d=a.n(c),u=(a("c610"),{page:1,page_size:15,corp_id:localStorage.getItem("corpId"),state:0,staffList:[],staffArr:[],timeRange:0,timeScope:0,export_all:0,is_export:0,sdate:o()().startOf("week").format("YYYY-MM-DD"),edate:o()().endOf("week").format("YYYY-MM-DD")}),p={name:"callRecord",components:{chooseDepartment:l["a"],AudioPlayer:d.a},data:function(){return{commonUrl:this.$store.state.commonUrl,total:0,listQuery:Object.assign({},u),timeList:[{value:0,title:"全部时间段"},{value:1,title:"00:00-05:59"},{value:2,title:"06:00-11:59"},{value:3,title:"12:00-17:59"},{value:4,title:"18:00-11:59"}],timeRangeList:[{value:0,title:"全部时长"},{value:1,title:"0分钟至5分钟"},{value:2,title:"6分钟至10分钟"},{value:3,title:"11分钟至30分钟"},{value:4,title:"31分钟至1小时"},{value:5,title:"1小时以上"}],statusList:[{value:0,title:"全部状态"},{value:1,title:"接通"},{value:2,title:"未接通"}],listLoading:!1,recordList:[],time:[o()().startOf("week"),o()().endOf("week")],last_time:2,showDepartment:!1,chooseNum:0,clickIndex:-1,flag:!1,playTime:[],t1:[],showPlay:!1,selectedRecord:{},batchTypeValue:!1,batchType:0,selectedRowKeys:[]}},mounted:function(){this.getList()},methods:{loadedmetadata:function(t){this.$refs.audioPlayer.duration=Math.floor(this.$refs.audioPlayer.duration)},getList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.listLoading=!0,t.next=3,this.axios.post("dialout/dialout-record",this.listQuery);case 3:e=t.sent,a=e.data,0!=a.error?this.$message.error(a.error_msg):0==this.listQuery.is_export&&(this.total=parseInt(a.data.count),this.recordList=a.data),1==this.listQuery.is_export&&(this.listQuery.is_export=0,this.ws.setCallback(this.websocketOnMessage)),this.listLoading=!1;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleTimeChange:function(t,e){this.listQuery.sdate=e[0],this.listQuery.edate=e[1],this.last_time=4},handleTimeRange:function(){switch(this.listQuery.sdate=o()(),this.last_time){case 0:var t=o()().subtract(1,"days").format("YYYY-MM-DD");this.time=[t,t],this.listQuery.sdate=t,this.listQuery.edate=t;break;case 1:this.time=[o()().startOf("day"),o()().endOf("day")],this.listQuery.sdate=o()().startOf("day").format("YYYY-MM-DD"),this.listQuery.edate=o()().endOf("day").format("YYYY-MM-DD");break;case 2:this.time=[o()().startOf("week"),o()().endOf("week")],this.listQuery.sdate=o()().startOf("week").format("YYYY-MM-DD"),this.listQuery.edate=o()().endOf("week").format("YYYY-MM-DD");break;case 3:this.time=[o()().startOf("month"),o()().endOf("month")],this.listQuery.sdate=o()().startOf("month").format("YYYY-MM-DD"),this.listQuery.edate=o()().endOf("month").format("YYYY-MM-DD");break;case 4:this.time=[],this.listQuery.sdate="",this.listQuery.edate="";break}},showDepartmentModel:function(){this.listQuery.staffList&&(this.$refs.user.rightIdList=JSON.parse(JSON.stringify(this.listQuery.staffList)),this.$refs.user.rightList=JSON.parse(JSON.stringify(this.listQuery.staffArr))),this.showDepartment=!0},departmentChange:function(t,e,a,s,i){this.listQuery.staffList=e,this.listQuery.staff_userNum=a,this.listQuery.staff_departmentNum=s,this.listQuery.staffArr=i,this.showDepartment=!1},downloadFile:function(t){var e=t.ring+".mp3";event.preventDefault();var a=document.createElement("a"),s=document.createEvent("MouseEvents");s.initEvent("click",!1,!1),a.setAttribute("target","_blank"),a.rel="noopener noreferrer",a.download=e,a.href=t.file_name,a.dispatchEvent(s),a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))},playAudio:function(t){this.showPlay=!0,this.selectedRecord=t},handleCancel:function(t){this.showPlay=!1},exportData:function(t){this.listQuery.is_export=1,this.listQuery.export_all=t.key,this.getList()},websocketOnMessage:function(t){console.log(11111111111,t),t.url&&(window.open(t.url),this.ws.setCallback())},clear:function(){this.listQuery=Object.assign({},u),this.time=[o()().startOf("week"),o()().endOf("week")],this.last_time=2,this.getList()},rowClassName:function(t,e){var a="dark-row";return e%2===0&&(a="light-row"),a},changePage:function(){this.getList()},showSizeChange:function(t,e){this.listQuery.page_size=e,this.getList()}}},h=p,f=(a("cfc1"),a("2877")),v=Object(f["a"])(h,s,i,!1,null,"372ea396",null);e["default"]=v.exports},bddf:function(t,e,a){var s=a("d8b3");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("499e").default;i("327f5e26",s,!0,{sourceMap:!1,shadowMode:!1})},cfc1:function(t,e,a){"use strict";var s=a("bddf"),i=a.n(s);i.a},d8b3:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,"[data-v-372ea396] .dark-row{background:#fafafa}[data-v-372ea396] .light-row{background:#fff}.list[data-v-372ea396]{overflow-y:hidden}.fans-content[data-v-372ea396]{height:100%;position:absolute;top:0;left:0;bottom:0;right:0}.ant-layout-header[data-v-372ea396]{background:#fff;border-bottom:1px solid #e2e2e2;height:50px;min-width:885px;width:100%;line-height:50px;font-size:16px;padding:0 20px}.header[data-v-372ea396]{width:98%;background-color:#fff;padding:24px;margin:1rem auto}.search_card[data-v-372ea396]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-wrap:wrap;flex-wrap:wrap;height:7rem;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:.5rem}.search_card .search_content[data-v-372ea396]{width:20%}.search_card .search_content .ant-input[data-v-372ea396],.search_card .search_content .ant-select[data-v-372ea396]{width:75%}.search_card .search_content .ant-radio-group[data-v-372ea396]{width:100%}.search_card .search_content .ant-radio-button-wrapper[data-v-372ea396]{width:17.5%;text-align:center}.static[data-v-372ea396]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.static .static_content[data-v-372ea396]{background-color:#f8f8f8;width:24%;height:5.76rem;padding:.64rem 1.067rem;margin-right:16px;line-height:30px}.content_table[data-v-372ea396]{padding:15px;margin:1rem auto}.record>.ant-modal-body[data-v-372ea396]{overflow:hidden}",""])}}]);