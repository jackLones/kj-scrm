(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4182872e"],{"00bd":function(t,e,r){t.exports=r.p+"assets/img/2.a6897814.png"},"29b1":function(t,e,r){var a=r("58cb");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=r("499e").default;s("134042da",a,!0,{sourceMap:!1,shadowMode:!1})},"464b":function(t,e,r){t.exports=r.p+"assets/img/qrcode.00769682.png"},4906:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"100%",height:"100%",position:"absolute","overflow-y":"auto"}},[a("a-card",{staticStyle:{"margin-bottom":"20px",padding:"10px 20px"}},[a("label",{staticClass:"tpl-title"},[t._v("消息存档")])]),t._m(0),a("div",{staticClass:"content-bd"},[a("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[a("div",{staticStyle:{"text-align":"center","font-size":"18px",margin:"40px 0",color:"#000"}},[t._v("完成以下步骤就可以成功开通啦！")]),a("a-steps",{staticStyle:{padding:"0 150px 40px",cursor:"pointer"},attrs:{current:t.currentStep}},t._l(t.steps,(function(t,e){return a("a-step",{key:t.title,attrs:{title:t.title}})})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.currentStep,expression:"currentStep == 0"}],staticClass:"enterprise-info"},[a("div",{staticClass:"enterprise-info-part",staticStyle:{padding:"10px"}},[a("a-form-item",{attrs:{label:"企业名称","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入企业名称",disabled:""},model:{value:t.corpName,callback:function(e){t.corpName=e},expression:"corpName"}})],1),a("a-form-item",{attrs:{label:"企业ID","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入企业ID",disabled:""},model:{value:t.corpId,callback:function(e){t.corpId=e},expression:"corpId"}})],1),a("a-form-item",{attrs:{label:"企业代码","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入企业统一社会信用代码"},model:{value:t.corpCode,callback:function(e){t.corpCode=e},expression:"corpCode"}})],1),a("a-form-item",{attrs:{label:"企业负责人","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入企业负责人"},model:{value:t.corpContactPerson,callback:function(e){t.corpContactPerson=e},expression:"corpContactPerson"}})],1),a("a-form-item",{attrs:{label:"企业负责人电话","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入企业负责人电话"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1)],1),a("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[a("a-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.saveCorpInfo}},[t._v("保存")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.currentStep,expression:"currentStep == 1"}],staticClass:"qr-box"},[a("div",[a("a-icon",{staticStyle:{color:"#52C41A"},attrs:{type:"clock-circle",theme:"filled"}}),t._v("\n\t\t\t\t\t已提交申请，请添加客服提交审核资料\n\t\t\t\t")],1),a("img",{staticClass:"qr-box-img",attrs:{src:r("464b"),alt:""}}),a("div",{staticClass:"qr-box-title"},[t._v("扫码添加专属客服")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.currentStep,expression:"currentStep == 2"}],staticClass:"enterprise-info"},[a("div",{staticClass:"enterprise-info-part"},[a("div",{staticClass:"enterprise-info-part-title"},[t._v("\n\t\t\t\t\t\t复制以下信息并填入到"),a("span",{staticStyle:{color:"#1890FF"}},[t._v("企业微信后台")]),a("a-popover",{attrs:{placement:"right"}},[a("template",{slot:"content"},[a("img",{staticStyle:{width:"500px"},attrs:{src:r("00bd"),alt:""}})]),a("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1),a("div",{staticClass:"enterprise-info-part-content"},[a("a-form-item",{attrs:{label:"可信IP地址","label-col":{span:4},"wrapper-col":{span:20}}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.$store.state.systemIp)+"\n\t\t\t\t\t\t\t"),a("a",{staticStyle:{"margin-left":"8px",background:"#1890FF",color:"#FFF",padding:"3px 5px","border-radius":"3px","font-size":"12px"},on:{click:function(e){return t.copyText(t.$store.state.systemIp)}}},[t._v("复制")])]),a("a-form-item",{attrs:{label:"信息加密公钥","label-col":{span:4},"wrapper-col":{span:20}}},[0==t.key_list.length?a("a-button",{on:{click:t.getCertificateFile}},[t._v("生成公钥")]):t._e(),t.key_list.length>0?[a("div",[a("span",{staticClass:"list-content"},[t._v("私钥内容")]),a("a",{staticStyle:{"margin-left":"8px",background:"#1890FF",color:"#FFF",padding:"3px 5px","border-radius":"3px","font-size":"12px"},on:{click:function(e){return t.copyText(t.key_list[0].private_key)}}},[t._v("复制")])]),a("div",[a("span",{staticClass:"list-content"},[t._v("私钥文件")]),a("a-popover",{attrs:{placement:"top"}},[a("template",{slot:"content"},[t._v("下载")]),a("a-icon",{staticStyle:{"margin-left":"8px",cursor:"pointer",color:"#1890FF"},attrs:{type:"download"},on:{click:function(e){return t.upLoadFile(t.commonUrl+t.key_list[0].private_key_path)}}})],2)],1),a("div",[a("span",{staticClass:"list-content"},[t._v("公钥内容")]),a("a",{staticStyle:{"margin-left":"8px",background:"#1890FF",color:"#FFF",padding:"3px 5px","border-radius":"3px","font-size":"12px"},on:{click:function(e){return t.copyText(t.key_list[0].public_key)}}},[t._v("复制")])]),a("div",[a("span",{staticClass:"list-content"},[t._v("公钥文件")]),a("a-popover",{attrs:{placement:"top"}},[a("template",{slot:"content"},[t._v("下载")]),a("a-icon",{staticStyle:{"margin-left":"8px",cursor:"pointer",color:"#1890FF"},attrs:{type:"download"},on:{click:function(e){return t.upLoadFile(t.commonUrl+t.key_list[0].public_key_path)}}})],2)],1)]:t._e()],2)],1)]),a("div",{staticClass:"enterprise-info-part"},[a("div",{staticClass:"enterprise-info-part-title"},[t._v("\n\t\t\t\t\t\t将"),a("span",{staticStyle:{color:"#1890FF"}},[t._v("企业微信后台会话存档")]),t._v("配置页面的Secret复制粘贴到下框中\n\t\t\t\t\t\t"),a("a-popover",{attrs:{placement:"right"}},[a("template",{slot:"content"},[a("img",{staticStyle:{width:"500px"},attrs:{src:r("980d"),alt:""}})]),a("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1),a("div",{staticClass:"enterprise-info-part-content"},[a("a-form-item",{attrs:{label:"会话存档Secret","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入会话存档Secret"},model:{value:t.sessionArchiveSecret,callback:function(e){t.sessionArchiveSecret=e},expression:"sessionArchiveSecret"}})],1),a("a-form-item",{attrs:{label:"公钥版本号","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-input",{staticStyle:{width:"350px"},attrs:{placeholder:"输入公钥版本号"},model:{value:t.publicKeyVersionNumber,callback:function(e){t.publicKeyVersionNumber=e},expression:"publicKeyVersionNumber"}})],1)],1)]),a("div",{staticClass:"enterprise-info-part"},[a("div",{staticClass:"enterprise-info-part-content"},[a("a-form-item",{attrs:{label:"会话存档状态","label-col":{span:4},"wrapper-col":{span:20}}},[a("a-switch",{model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1)],1)]),a("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[a("a-button",{staticStyle:{width:"100px"},attrs:{type:"primary",disabled:!(t.key_list.length>0&&""!=t.publicKeyVersionNumber&&""!=t.sessionArchiveSecret)},on:{click:t.saveCorpInfo}},[t._v("保存\n\t\t\t\t\t")])],1)])],1)],1)],1)},s=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content-msg"},[r("p",{staticStyle:{"margin-bottom":"0px"}},[t._v("\n\t\t\t企业微信会话存档，可以完整的保存员工和客户之间所有的对话，包括撤回/删除的信息，并提供自定义设置敏感词，一旦发生敏感操作，系统自动及时触发预警， 帮助商家做好企业风控。\n\t\t")])])}],i=(r("96cf"),r("3b8d")),n={data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"",e=localStorage.getItem("corpName")?localStorage.getItem("corpName"):"";return{isLoading:!1,commonUrl:this.$store.state.commonUrl,corpId:t,steps:[{title:"填写企业信息"},{title:"添加客服提交资料"},{title:"配置后台"}],currentStep:2,sessionArchiveSecret:"",publicKeyVersionNumber:"",status:!0,key_list:[],corpName:e,corpCode:"",corpContactPerson:"",phone:""}},methods:{changeCurrentStep:function(t){this.currentStep=t},saveCorpInfo:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=this.currentStep){t.next=18;break}if(""!=this.corpCode){t.next=4;break}return this.$message.warning("请填写企业代码"),t.abrupt("return",!1);case 4:if(""!=this.corpContactPerson){t.next=7;break}return this.$message.warning("请填写企业接口人"),t.abrupt("return",!1);case 7:if(e=/^(((13[0-9]{1})|(14[0-9]{1})|(17[0-9]{1})|(15[0-3]{1})|(15[4-9]{1})|(18[0-9]{1})|(199))+\d{8})$/,""!=this.phone){t.next=13;break}return this.$message.warning("请填写接口人电话"),t.abrupt("return",!1);case 13:if(e.test(this.phone)){t.next=16;break}return this.$message.warning("请填写正确的接口人电话"),t.abrupt("return",!1);case 16:t.next=22;break;case 18:if(2!=this.currentStep){t.next=22;break}if(""!=this.sessionArchiveSecret&&null!=this.sessionArchiveSecret){t.next=22;break}return this.$message.warning("请填写会话存档Secret"),t.abrupt("return",!1);case 22:return this.isLoading=!0,t.next=25,this.axios.post("work-msg-audit/set",{corp_id:this.corpId,credit_code:this.corpCode,contact_user:this.corpContactPerson,contact_phone:this.phone,secret:this.sessionArchiveSecret});case 25:r=t.sent,a=r.data,0!=a.error?(this.$message.error(a.error_msg),this.isLoading=!1):0==this.currentStep?(this.currentStep=1,this.$message.success("保存成功"),this.isLoading=!1):2==this.currentStep&&this.setPublicKeyVersionNumber();case 28:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setPublicKeyVersionNumber:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.key_list.length>0)){t.next=10;break}if(""!=this.publicKeyVersionNumber&&null!=this.publicKeyVersionNumber){t.next=5;break}return this.$message.warning("请填写公钥版本号"),this.isLoading=!1,t.abrupt("return",!1);case 5:return t.next=7,this.axios.post("work-msg-audit/set-key-version",{corp_id:this.corpId,key_id:this.key_list[0].key_id,key_version:this.publicKeyVersionNumber});case 7:e=t.sent,r=e.data,0!=r.error?(this.$message.error(r.error_msg),this.isLoading=!1):this.setStatus();case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setStatus:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=-1,e=this.status?1:0,t.next=4,this.axios.post("work-msg-audit/change-status",{corp_id:this.corpId,status:e});case 4:r=t.sent,a=r.data,0!=a.error?(this.$message.error(a.error_msg),this.isLoading=!1):(this.$message.success("保存成功"),this.isLoading=!1);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),copyText:function(t){var e=this,r=document.createElement("textarea");document.body.appendChild(r),r.value=t,r.select(),document.execCommand("copy")&&(document.execCommand("copy"),e.$message.success("复制成功！")),document.body.removeChild(r)},upLoadFile:function(t){window.open(t)},generatePublicKey:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.next=3,this.axios.post("work-msg-audit/get",{corp_id:this.corpId});case 3:e=t.sent,r=e.data,0!=r.error?(this.$message.error(r.error_msg),this.isLoading=!1):(Array.isArray(r.data)?this.currentStep=0:(this.key_list=r.data.key_list,this.key_list.length>0&&(this.publicKeyVersionNumber=this.key_list[0].key_version),null!==r.data.secret&&(this.sessionArchiveSecret=r.data.secret),this.corpCode=r.data.credit_code,this.corpContactPerson=r.data.contact_user,this.phone=r.data.contact_phone,""==this.corpCode||null==this.corpCode||""==this.corpContactPerson||null==this.corpContactPerson||""==this.phone||null==this.phone?this.currentStep=0:-1==r.data.status?this.currentStep=1:(this.currentStep=2,1==r.data.status?this.status=!0:this.status=!1)),this.isLoading=!1);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getCertificateFile:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("work-msg-audit/get-key",{corp_id:this.corpId});case 2:e=t.sent,r=e.data,0!=r.error?this.$message.error(r.error_msg):this.generatePublicKey();case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},created:function(){0==this.currentStep||2==this.currentStep&&this.generatePublicKey()}},o=n,c=(r("55f3"),r("2877")),p=Object(c["a"])(o,a,s,!1,null,"445ccf62",null);e["default"]=p.exports},"55f3":function(t,e,r){"use strict";var a=r("29b1"),s=r.n(a);s.a},"58cb":function(t,e,r){e=t.exports=r("2350")(!1),e.push([t.i,"[data-v-445ccf62] .ant-card-bordered{border:0}.tpl-title[data-v-445ccf62]{float:left;font-size:16px;vertical-align:top}.content-msg[data-v-445ccf62]{border:1px solid #ffdda6;background:#fff2db;padding:10px;margin:0 20px 20px}.content-bd[data-v-445ccf62]{background:#fff;border:1px solid #e2e2e2;min-width:885px;margin:0 20px;height:calc(100% - 168px);overflow-y:auto}a[data-v-445ccf62]:active,a[data-v-445ccf62]:hover,a[data-v-445ccf62]:link,a[data-v-445ccf62]:visited{text-decoration:none}.qr-box[data-v-445ccf62]{width:378px;height:380px;padding-top:30px;background:#fff;-webkit-box-shadow:0 2px 10px rgba(0,0,0,.16);box-shadow:0 2px 10px rgba(0,0,0,.16);border-radius:4px;margin:0 auto 20px;font-size:16px;color:#000;text-align:center}.qr-box .qr-box-img[data-v-445ccf62]{width:224px;margin:24px 0 14px;-webkit-box-shadow:0 0 12px rgba(0,0,0,.3);box-shadow:0 0 12px rgba(0,0,0,.3)}.qr-box .qr-box-title[data-v-445ccf62]{margin-top:2px;font-size:14px;line-height:17px;color:rgba(0,0,0,.45)}.enterprise-info .enterprise-info-part[data-v-445ccf62]{background:#f5f5f5;border:1px solid #e2e2e2;margin:0 150px 20px}.enterprise-info .enterprise-info-part .enterprise-info-part-title[data-v-445ccf62]{border-bottom:1px solid #e2e2e2;padding:10px;color:#000;letter-spacing:1px}.enterprise-info .enterprise-info-part .enterprise-info-part-content[data-v-445ccf62]{padding:10px}.list-content[data-v-445ccf62]{width:60px;display:inline-block;text-align:right}",""])},"980d":function(t,e,r){t.exports=r.p+"assets/img/1.3de3f3cc.png"}}]);