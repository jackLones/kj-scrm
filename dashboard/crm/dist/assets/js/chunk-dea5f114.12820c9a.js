(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dea5f114"],{3333:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,"#components-layout-demo-basic[data-v-1dd0fdde]{height:100%}#components-layout-demo-basic .ant-layout-header[data-v-1dd0fdde]{background:#fff;border-bottom:1px solid #e2e2e2;height:50px;min-width:885px;width:100%;line-height:50px}[data-v-1dd0fdde] .ant-layout-header{padding:0 20px;font-size:16px;text-align:left}#components-layout-demo-basic .ant-layout-sider[data-v-1dd0fdde]{background:#fff;-webkit-box-flex:0!important;-ms-flex:0 0 250px!important;flex:0 0 250px!important;max-width:250px!important;min-width:250px!important;width:250px!important;border-right:1px solid #e2e2e2}#components-layout-demo-basic .ant-layout-content[data-v-1dd0fdde]{margin:0 20px 20px;min-width:885px;width:100%;padding-right:40px}.content-hd[data-v-1dd0fdde]{height:60px;width:100%;min-width:885px;line-height:60px}.content-msg[data-v-1dd0fdde]{width:100%;border:1px solid #ffdda6;background:#fff2db;padding:10px;margin-top:12px}.content-bd[data-v-1dd0fdde]{background:#fff;min-height:120px;border:1px solid #e2e2e2;min-width:885px;width:100%}#components-layout-demo-basic>.ant-layout[data-v-1dd0fdde]{margin-bottom:48px}#components-layout-demo-basic>.ant-layout[data-v-1dd0fdde]:last-child{margin:0}.ant-layout.ant-layout-has-sider[data-v-1dd0fdde],.list[data-v-1dd0fdde]{height:100%}.btn-primary[data-v-1dd0fdde]{margin-left:20px}[data-v-1dd0fdde] .dark-row{background:#fafafa}[data-v-1dd0fdde] .light-row{background:#fff}[data-v-1dd0fdde] .ant-radio-button-wrapper{width:90px;margin:0;text-align:center}",""])},8043:function(t,e,i){var a=i("3333");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("499e").default;n("df56bfca",a,!0,{sourceMap:!1,shadowMode:!1})},"9efb":function(t,e,i){"use strict";var a=i("8043"),n=i.n(a);n.a},c41b:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"list"},[i("div",{attrs:{id:"components-layout-demo-basic"}},[i("a-layout",{staticStyle:{position:"relative",height:"100%",overflow:"hidden"}},[i("a-layout",{staticClass:"scroll",staticStyle:{position:"absolute",top:"0",bottom:"0",right:"0","overflow-x":"hidden","overflow-y":"auto"}},[i("a-layout-header",[t._v("裂变引流")]),i("a-layout-content",[i("div",{staticClass:"content-msg"},[t._v("\n\t\t\t\t\t\t裂变助力引流，通过有吸引力的奖品，邀请多个好友助力，可免费获得，以此诱导用户在自己的社交圈进行传播，一传二、二传四的模式，指数级增长。而使用企业微信去做裂变活动时，助力用户需要先加企业成员为好友，再通过欢迎语推送活动图文，助力用户打开即助力成功。在整个裂变的过程中，企业可以获得更多的用户。\n\t\t\t\t\t\t"),i("div",{staticStyle:{margin:"10px 0 2px"}},[t._v("自动发送欢迎语，可能失败的原因\n\t\t\t\t\t\t\t"),i("a-tooltip",{attrs:{placement:"bottom"}},[i("template",{slot:"title"},[i("p",{staticStyle:{"margin-bottom":"2px","font-size":"13px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t1、如果企业在企业微信后台为相关成员配置了可用的欢迎语，使用第三方系统配置欢迎语，均不起效，推送的还是企业微信官方的。")]),i("p",{staticStyle:{"margin-bottom":"10px","font-size":"13px"}}),i("p",{staticStyle:{"margin-bottom":"2px","font-size":"13px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t2、客户和企业成员已经开始聊天的场景下，不能发送欢迎语。")]),i("p",{staticStyle:{"margin-bottom":"10px","font-size":"13px"}}),i("p",{staticStyle:{"margin-bottom":"2px","font-size":"13px"}},[t._v("3、客户之前添加过A企业成员，\n\t\t\t\t\t\t\t\t\t\t不论客户是否将该成员删除，但凡再通过裂变活动添加上该A企业成员，受限于企业微信官方规则，可能会造成推送其他渠道（包含正在进行中的裂变活动）的欢迎语，也有可能不再推送。")]),i("p",{staticStyle:{"margin-bottom":"10px","font-size":"13px"}}),i("p",{staticStyle:{"margin-bottom":"0","font-size":"13px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t4、每次添加新的客户时，当存在多个企业自建应用或是第三方应用设置了欢迎语，那么企业微信官方采取优先权的推送，所以存在有的客户接收不到欢迎语。请商户根据实际使用需求，合理配置，避免冲突。")])]),i("a-icon",{attrs:{type:"question-circle"}})],2)],1),i("p",{staticStyle:{margin:"10px 0 2px",color:"red"}},[t._v("\n\t\t\t\t\t\t\t在使用派发红包功能前，需要商户完成以下配置：\n\t\t\t\t\t\t")]),i("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t1、前往"),i("a",{attrs:{href:"https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F",target:"_blank"}},[t._v("【微信支付商户平台】")]),t._v("注册微信支付商户号\n\t\t\t\t\t\t")]),i("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t2、登录"),i("a",{attrs:{href:"https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome_baidu",target:"_blank"}},[t._v("【企业微信后台】")]),t._v("开通企业支付，绑定已有商户号（"),i("a",{attrs:{href:"https://support.qq.com/products/312071/faqs/90055",target:"_blank"}},[t._v("查看教程")]),t._v("）\n\t\t\t\t\t\t")]),i("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t3、登录"),i("a",{attrs:{href:"https://pay.weixin.qq.com/index.php/core/home/login?return_url=%2F",target:"_blank"}},[t._v("【微信支付商户平台】")]),t._v("开通【企业付款到零钱】（"),i("a",{attrs:{href:"https://support.qq.com/products/312071/faqs/90056",target:"_blank"}},[t._v("查看教程")]),t._v("）\n\t\t\t\t\t\t")]),i("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t4、在本系统，进入【自建应用】--【企业支付】，点击，填入企业支付的应用ID和Secret\n\t\t\t\t\t\t")]),i("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t\t\t5、在本系统，进入【自建应用】--【企业支付】，点击，完成支付配置。（"),i("a",{attrs:{href:"https://support.qq.com/products/312071/faqs/90054",target:"_blank"}},[t._v("查看教程")]),t._v("）\n\t\t\t\t\t\t")])]),i("div",{staticClass:"content-hd"},[i("a-col",{staticStyle:{float:"left"}},[t.corpLen>1?i("a-select",{staticStyle:{width:"210px","margin-right":"10px"},attrs:{showSearch:"",optionFilterProp:"children"},on:{change:t.handleChange},model:{value:t.corpId,callback:function(e){t.corpId=e},expression:"corpId"}},[t._l(t.corpInfo,(function(e){return[i("a-select-option",{attrs:{value:e.corpid}},[t._v(t._s(e.corp_full_name||e.corp_name)+"\n\t\t\t\t\t\t\t\t\t")])]}))],2):t._e(),i("a-select",{staticStyle:{width:"120px"},attrs:{placeholder:"活动状态",allowClear:""},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[i("a-select-option",{attrs:{value:"1"}},[t._v("未开始")]),i("a-select-option",{attrs:{value:"2"}},[t._v("进行中")]),i("a-select-option",{attrs:{value:"3"}},[t._v("已结束")])],1),i("a-input",{staticStyle:{width:"150px",margin:"0px 10px"},attrs:{placeholder:"搜索活动名称"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.find(e)}},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),i("a-range-picker",{staticStyle:{width:"300px"},on:{change:t.changeTime},model:{value:t.activityTime,callback:function(e){t.activityTime=e},expression:"activityTime"}}),i("a-button",{staticStyle:{margin:"0px 10px"},attrs:{type:"primary"},on:{click:t.find}},[t._v("查找")]),i("a-button",{on:{click:t.clear}},[t._v("清空")])],1),i("a-col",{staticStyle:{float:"right"}},[i("a-button",{directives:[{name:"has",rawName:"v-has",value:"fission-add",expression:"'fission-add'"}],staticClass:"btn-primary",attrs:{icon:"plus",type:"primary"},on:{click:t.addWelcomeText}},[t._v("\n\t\t\t\t\t\t\t\t新建活动\n\t\t\t\t\t\t\t")])],1)],1),i("div",{staticClass:"content-bd"},[i("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[i("a-table",{directives:[{name:"has",rawName:"v-has",value:"fission-list",expression:"'fission-list'"}],attrs:{columns:t.columns,dataSource:t.activityList,pagination:!1,rowClassName:t.rowClassName},scopedSlots:t._u([{key:"qr_code",fn:function(t,e,a){return i("span",{},[i("div",{ref:"qrcode"+a,staticStyle:{width:"100px",margin:"0 auto"},attrs:{id:"qrcode"+a}})])}},{key:"title2",fn:function(e,a){return i("span",{},[i("div",{staticStyle:{width:"140px"}},[t._v(t._s(a.title))])])}},{key:"time",fn:function(e,a){return i("span",{},[i("div",{staticStyle:{width:"125px"}},[t._v(t._s(a.start_time)+"至")]),i("div",[t._v(t._s(a.end_time))])])}},{key:"member_str",fn:function(e,a){return i("span",{},[t._l(a.user,(function(e){return[e.scopedSlots&&e.scopedSlots.title&&"custom"==e.scopedSlots.title?i("a-tag",{staticStyle:{"margin-top":"5px"},attrs:{color:"orange"}},[t._v(t._s(e.title))]):t._e()]})),t._l(a.user,(function(e){return[e.scopedSlots&&e.scopedSlots.title&&"custom"!=e.scopedSlots.title?i("a-tag",{staticStyle:{"margin-top":"5px"},attrs:{color:"blue"}},[t._v(t._s(e.title))]):t._e()]})),0==a.user.length?i("span",[t._v("--")]):t._e()],2)}},{key:"status_str",fn:function(e,a){return i("span",{},[i("div",[t._v(t._s(a.status_str))]),"已结束"==a.status_str?i("div",{staticStyle:{width:"128px"}},[t._v("（"+t._s(a.reason_str)+"）")]):t._e()])}},{key:"prize",fn:function(e,a){return i("span",{},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(a.prize_name)+"（"+t._s(a.complete_num||0)+"/"+t._s(a.prize_num)+"）\n\t\t\t\t\t\t\t\t")])}},{key:"action",fn:function(e,a,n){return i("span",{},[i("div",{staticStyle:{width:"150px"}},[2==a.status?i("a-button",{directives:[{name:"has",rawName:"v-has",value:"fission-invalid",expression:"'fission-invalid'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.failure(a.id)}}},[t._v("使失效")]):t._e(),1==a.status?i("a-button",{directives:[{name:"has",rawName:"v-has",value:"fission-release",expression:"'fission-release'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.releaseActivity(a.id)}}},[t._v("发布")]):t._e(),1==a.status||2==a.status?i("a-button",{directives:[{name:"has",rawName:"v-has",value:"fission-edit",expression:"'fission-edit'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.edit(a.id)}}},[t._v("编辑")]):t._e(),i("a-button",{directives:[{name:"has",rawName:"v-has",value:"fission-part",expression:"'fission-part'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.participants(a.id,a.title)}}},[t._v("参与者")]),"进行中"!=a.status_str?i("a-button",{directives:[{name:"has",rawName:"v-has",value:"fission-del",expression:"'fission-del'"}],staticStyle:{margin:"0 5px 5px 0"},on:{click:function(e){return t.deleteActivity(a.id)}}},[t._v("删除")]):t._e(),2==a.status?i("a-button",{directives:[{name:"has",rawName:"v-has",value:"fission-down",expression:"'fission-down'"}],staticClass:"actionBtn",attrs:{"data-url":a.qr_code,"data-name":a.title,"data-id":"qrcode"+n},on:{click:t.downLoadWay}},[t._v("下载")]):t._e()],1)])}}])}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"},{name:"has",rawName:"v-has",value:"fission-list",expression:"'fission-list'"}],staticClass:"pagination",staticStyle:{width:"100%",position:"absolute",margin:"20px 0px"}},[i("div",{staticStyle:{height:"32px",float:"left","line-height":"32px"}},[t._v("\n\t\t\t\t\t\t\t\t\t共\n\t\t\t\t\t\t\t\t\t"),i("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.total))]),t._v("条\n\t\t\t\t\t\t\t\t")]),i("div",{staticClass:"pagination",staticStyle:{height:"32px",float:"right"}},[i("a-pagination",{attrs:{total:t.total,showSizeChanger:"",showQuickJumper:t.quickJumper,current:t.page,pageSize:t.pageSize,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage,showSizeChange:t.showSizeChange}})],1)])],1)],1)])],1)],1)],1)])},n=[],s=(i("a481"),i("7f7f"),i("96cf"),i("3b8d")),o=i("641c"),r=i("c1df"),c=i.n(r),d=i("d044"),l=i.n(d),p=[{title:"二维码",dataIndex:"qr_code",key:"qr_code",width:"9%",scopedSlots:{customRender:"qr_code"}},{title:"活动名称",dataIndex:"title",key:"title",scopedSlots:{customRender:"title2"}},{title:"活动时间",dataIndex:"time",key:"time",scopedSlots:{customRender:"time"}},{title:"奖品（剩余/总库存）",dataIndex:"prize",key:"prize",width:"12%",scopedSlots:{customRender:"prize"}},{title:"活动限制",dataIndex:"limit_str",width:"10%",key:"limit_str"},{title:"引流成员",dataIndex:"member_str",key:"member_str",scopedSlots:{customRender:"member_str"}},{title:"状态",dataIndex:"status_str",key:"status_str",scopedSlots:{customRender:"status_str"}},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"}}],u={name:"fissionList",components:{MyIcon:o["a"]},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{suite_id:1,corpId:t,corpInfo:[],status:[],title:"",activityTime:[],activityList:[],isLoading:!0,corpLen:JSON.parse(localStorage.getItem("corpArr")).length,columns:p,total:0,quickJumper:!1,page:1,page_size:15,pageSize:15}},methods:{handleChange:function(t){this.corpId=t},rowClassName:function(t,e){var i="dark-row";return e%2===0&&(i="light-row"),i},changeTime:function(t,e){this.activityTime=t},find:function(){this.getActivityList()},clear:function(){this.status=[],this.title="",this.activityTime=[],this.page=1,this.pageSize=15,this.corpId=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"",this.getActivityList()},addWelcomeText:function(){this.$router.push("/fission/add")},getActivityList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,i,a,n,s,o=this,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:1,i=r.length>1&&void 0!==r[1]?r[1]:this.pageSize,this.isLoading=!0,t.next=5,this.axios.post("fission/list",{uid:localStorage.getItem("uid"),corp_id:this.corpId,status:this.status,title:this.title,start_date:this.activityTime.length>0?c()(this.activityTime[0]).format("YYYY-MM-DD"):"",end_date:this.activityTime.length>0?c()(this.activityTime[1]).format("YYYY-MM-DD"):"",page:e,pageSize:i});case 5:a=t.sent,n=a.data,0!=n.error?(this.isLoading=!1,this.$message.error(n.error_msg)):(this.activityList=n.data.fission,this.isLoading=!1,this.total=parseInt(n.data.count),this.page=e,this.pageSize=i,this.quickJumper=this.total>this.pageSize,s=this,this.$nextTick((function(){for(var t=0;t<o.activityList.length;t++)document.getElementById("qrcode"+t).innerHTML="";for(var e=0;e<o.activityList.length;e++)s.qrcode(o.activityList[e].h5Url,e)})));case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),qrcode:function(t,e){new l.a("qrcode"+e,{width:100,height:100,text:t,colorDark:"#000",colorLight:"#FFF"})},failure:function(t){var e=this;e.$confirm({title:"确定结束该活动？",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){e.isLoading=!0,e.changeStatus(t,5)}})},releaseActivity:function(t){var e=this;e.$confirm({title:"确定发布该活动？",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){e.isLoading=!0,e.changeStatus(t,2)}})},deleteActivity:function(t){var e=this;e.$confirm({title:"确定删除该活动？",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){e.isLoading=!0,e.changeStatus(t,0)}})},changeStatus:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,i){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("fission/change-status",{uid:localStorage.getItem("uid"),id:e,status:i});case 2:a=t.sent,n=a.data,0!=n.error?(this.isLoading=!1,this.$message.error(n.error_msg)):(this.selectedRowKeys=[],0==i&&1==this.activityList.length&&this.page>1?this.getActivityList(this.page-1,this.pageSize):this.getActivityList(this.page,this.pageSize));case 5:case"end":return t.stop()}}),t,this)})));function e(e,i){return t.apply(this,arguments)}return e}(),downLoadWay:function(t){var e=this,i=new Image;i.setAttribute("crossOrigin","anonymous");document.getElementById(t.target.dataset.id);i.src=document.getElementById(t.target.dataset.id).getElementsByTagName("img")[0].getAttribute("src"),i.onload=function(){var a=document.createElement("canvas");a.width=200,a.height=200;var n=a.getContext("2d");n.drawImage(i,0,0,200,200),a.toBlob((function(i){var a=URL.createObjectURL(i);e.download(a,t.target.dataset.name),URL.revokeObjectURL(a)}))}},download:function(t,e){var i=document.createElement("a");i.download=e,i.href=t,i.click(),i.remove()},edit:function(t){this.$router.push("/fission/add?id="+t)},participants:function(t,e){var i=encodeURIComponent(t),a=encodeURIComponent(e.replace(/%/g,"%25"));this.$router.push("/fission/participants?fid="+i+"&title="+a)},statistical:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),changePage:function(t,e){this.getActivityList(t,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,270)}))},showSizeChange:function(t,e){this.getActivityList(1,e)}},mounted:function(){var t=this;this.$store.dispatch("getCorp",(function(e){t.corpInfo=e,t.getActivityList()}))},beforeRouteEnter:function(t,e,i){"/fission/add"==e.path&&"undefined"!=typeof t.query.isRefresh&&"1"==t.query.isRefresh?i((function(t){t.getActivityList(t.page,t.pageSize)})):("/fission/add"==e.path&&"undefined"==typeof t.query.isRefresh||"/fission/participants"!=e.path)&&i((function(t){t.status=[],t.title="",t.activityTime=[],t.page=1,t.pageSize=15,t.corpId=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"",t.getActivityList()})),i()}},m=u,h=(i("9efb"),i("2877")),f=Object(h["a"])(m,a,n,!1,null,"1dd0fdde",null);e["default"]=f.exports}}]);