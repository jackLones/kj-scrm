(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0332e241"],{"096e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list"},[s("div",{attrs:{id:"components-layout-demo-basic"}},[s("div",{staticStyle:{padding:"0 20px",height:"50px","line-height":"50px","font-size":"16px","background-color":"#FFFFFF"}},[t._v("\n\t\t\t门店管理\n\t\t\t")]),s("div",{staticStyle:{padding:"20px 0 0 20px",height:"calc(100% - 50px)"}},[t._m(0),s("div",[s("div",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-list",expression:"'storeList-staff-list'"}],staticClass:"tabBtn",class:0==t.storeType?"":"activeBtn",on:{click:function(e){return t.changeTab(1)}}},[t._v("\n\t\t\t\t\t门店成员\n\t\t\t\t")]),s("div",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-list",expression:"'storeList-manage-list'"}],staticClass:"tabBtn",class:0==t.storeType?"activeBtn":"",on:{click:function(e){return t.changeTab(0)}}},[t._v("\n\t\t\t\t\t门店管理\n\t\t\t\t")])]),s("a-layout",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-list",expression:"'storeList-manage-list'"},{name:"show",rawName:"v-show",value:0==t.storeType,expression:"storeType == 0"}],staticStyle:{position:"relative",height:"calc(100% - 125px)"}},[s("a-layout-sider",[s("storeTeam",{key:t.storeType,ref:"group",on:{changeGroupId:t.modalVisibleChange}})],1),s("a-layout",{staticClass:"scroll",staticStyle:{position:"absolute",left:"250px",top:"0",bottom:"0",right:"0","overflow-x":"hidden","overflow-y":"auto"}},[s("a-layout-content",[s("div",{staticClass:"content-hd"},[s("a-select",{staticStyle:{width:"200px","margin-bottom":"20px"},attrs:{optionFilterProp:"children"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[s("a-select-option",{attrs:{value:""}},[t._v("全部状态")]),s("a-select-option",{attrs:{value:"1"}},[t._v("开启")]),s("a-select-option",{attrs:{value:"0"}},[t._v("关闭")])],1),s("a-input",{staticStyle:{width:"240px","margin-left":"10px"},attrs:{placeholder:"请输入门店名称或地址进行查找"},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}}),s("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.findStore}},[t._v("\n\t\t\t\t\t\t\t\t查找\n\t\t\t\t\t\t\t")]),s("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.clearFind}},[t._v("\n\t\t\t\t\t\t\t\t清空\n\t\t\t\t\t\t\t")]),s("div",{staticClass:"content-hd-right"},[s("a-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"reload"},on:{click:t.syncFollowUser}},[t._v("\n\t\t\t\t\t\t\t\t\t同步配置了外部联系权限的联系人\n\t\t\t\t\t\t\t\t")]),s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-import",expression:"'storeList-manage-import'"}],staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.importExcel}},[t._v("\n\t\t\t\t\t\t\t\t\t本地导入\n\t\t\t\t\t\t\t\t")]),s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-import",expression:"'storeList-manage-import'"}],attrs:{icon:"plus",type:"primary"},on:{click:t.addStore}},[t._v("\n\t\t\t\t\t\t\t\t\t创建门店\n\t\t\t\t\t\t\t\t")])],1)],1),s("div",{staticStyle:{height:"38px"}},[t._v("\n\t\t\t\t\t\t\t共有\n\t\t\t\t\t\t\t"),s("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.total))]),t._v("个\n\t\t\t\t\t\t")]),s("div",{staticClass:"content-bd"},[s("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[s("div",{staticClass:"spin-content"},[s("a-table",{attrs:{columns:t.columns,dataSource:t.storeList,pagination:!1,rowClassName:t.rowClassName},scopedSlots:t._u([{key:"select",fn:function(e,a,i){return s("span",{},[s("a-checkbox",{staticStyle:{float:"right"},on:{click:function(e){return t.changeSelectKey(a.id)}},model:{value:t.checkBoxValue[i],callback:function(e){t.$set(t.checkBoxValue,i,e)},expression:"checkBoxValue[index]"}})],1)}},{key:"province",fn:function(e,a){return s("span",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(a.province)+"-"+t._s(a.city)+"-"+t._s(a.district)+"\n\t\t\t\t\t\t\t\t\t\t")])}},{key:"status",fn:function(e,a){return s("span",{},[s("a-switch",{attrs:{checked:1==a.status,disabled:t.disableOpen},on:{click:function(e){return t.changeStore(a.id,a.status,a.shop_name)}}})],1)}},{key:"userAdd",fn:function(e,a){return s("span",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(a.user_add_now)+" / "+t._s(a.user_add_all)+"\n\t\t\t\t\t\t                ")])}},{key:"userDel",fn:function(e,a){return s("span",{},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(a.user_del_now)+" / "+t._s(a.user_del_all)+"\n\t\t\t\t\t\t                ")])}},{key:"action",fn:function(e,a){return s("span",{},[s("div",{staticStyle:{display:"inline-block"}},[1==a.status?s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-add",expression:"'storeList-staff-add'"}],staticStyle:{margin:"3px"},on:{click:function(e){return t.addEmployee(a.id)}}},[t._v("添加员工")]):t._e()],1),s("div",{staticStyle:{display:"inline-block"}},[a.qc_url?s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-downLoad",expression:"'storeList-manage-downLoad'"}],staticStyle:{margin:"3px"},on:{click:function(e){return t.qrLoad(a.qc_url)}}},[t._v("门店码下载")]):t._e()],1),s("div",{staticStyle:{display:"inline-block"}},[s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-edit",expression:"'storeList-manage-edit'"}],staticStyle:{margin:"3px"},on:{click:function(e){return t.editStore(a)}}},[t._v("编辑")])],1),s("div",{staticStyle:{display:"inline-block"}},[s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-del",expression:"'storeList-manage-del'"}],staticStyle:{margin:"3px"},on:{click:function(e){return t.delStore(a.id,a.shop_name)}}},[t._v("删除")])],1)])}}])},[s("span",{attrs:{slot:"name"},slot:"name"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t所属分组\n\t\t\t\t\t\t\t\t\t\t\t"),s("a-popover",{attrs:{placement:"bottom"}},[s("template",{slot:"content"},[s("span",[t._v("当存在多级分组时，只显示门店的一级分组+当前门店所在的分组。")])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1),s("span",{attrs:{slot:"user_count"},slot:"user_count"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t员工数量\n\t\t\t\t\t\t\t\t\t\t\t"),s("a-popover",{attrs:{placement:"bottom"}},[s("template",{slot:"content"},[s("span",[t._v("只显示具有外部联系人权限的成员数量。")])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1),s("span",{attrs:{slot:"user_add"},slot:"user_add"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t今日新增/累计新增客户\n\t\t\t\t\t\t\t\t\t\t\t"),s("a-popover",{attrs:{placement:"bottom"}},[s("template",{slot:"content"},[s("div",{staticStyle:{"max-width":"500px"}},[s("p",{staticStyle:{"margin-bottom":"10px","line-height":"25px"}},[t._v("今日新增客户：通过门店码或导购码，仅计入今日该门店添加的全新客户，即门店成员尚未添加过该客户，（不含删除后再添加）；且同一门店不同成员，添加同一个客户，只计入新增1人。")]),s("p",{staticStyle:{"margin-bottom":"0px","line-height":"25px"}},[t._v("累计新增客户： 通过门店码或导购码，累计该门店添加的客户。该门店员工反复添加同一个客户，只计入1人；且同一门店不同成员，添加同一个客户，只计入1人。")])])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1),s("span",{attrs:{slot:"user_del"},slot:"user_del"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t今日流失/累计流失客户\n\t\t\t\t\t\t\t\t\t\t\t"),s("a-popover",{attrs:{placement:"bottom"}},[s("template",{slot:"content"},[s("div",{staticStyle:{"max-width":"500px"}},[s("p",{staticStyle:{"margin-bottom":"10px","line-height":"25px"}},[t._v("今日流失客户：通过门店码或导购码，员工添加客户后，在今日客户删除员工/员工删除客户的客户人数。若同一门店不同员工，添加同一个客户，仅是其中一个员工和客户解除好友关系，不计入流失客户数，只有全部解除后，才计入。")]),s("p",{staticStyle:{"margin-bottom":"0px","line-height":"25px"}},[t._v("累计流失客户：通过门店码或导购码，员工添加客户后，累计客户删除员工/员工删除客户的客户人数。若同一门店不同员工，添加同一个客户，仅是其中一个员工和客户解除好友关系，不计入流失客户数，只有全部解除后，才计入。")])])]),s("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1)])],1)])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],staticClass:"pagination",staticStyle:{margin:"20px auto","padding-bottom":"20px",height:"52px"}},[s("div",{staticStyle:{height:"32px",float:"left","line-height":"32px","margin-left":"10px"}},[s("a-checkbox",{on:{click:t.batchTypeChange},model:{value:t.batchTypeValue,callback:function(e){t.batchTypeValue=e},expression:"batchTypeValue"}}),s("a-select",{staticStyle:{width:"150px",margin:"0 5px"},attrs:{optionFilterProp:"children"},on:{change:t.changeBatchType},model:{value:t.batchType,callback:function(e){t.batchType=e},expression:"batchType"}},[s("a-select-option",{attrs:{value:"0"}},[t._v("选择当前页")]),s("a-select-option",{attrs:{value:"1"}},[t._v("选择所有")])],1),s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-status",expression:"'storeList-manage-status'"}],staticClass:"btn-primary",attrs:{icon:"unlock",disabled:0==t.selectedRowKeys.length,type:"primary"},on:{click:t.releaseFollow}},[t._v("\n\t\t\t\t\t\t\t\t\t批量开启\n\t\t\t\t\t\t\t\t")]),s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-status",expression:"'storeList-manage-status'"}],staticClass:"btn-primary",attrs:{icon:"lock",disabled:0==t.selectedRowKeys.length,type:"primary"},on:{click:t.failure}},[t._v("\n\t\t\t\t\t\t\t\t\t批量关闭\n\t\t\t\t\t\t\t\t")])],1),s("div",{staticClass:"pagination",staticStyle:{height:"32px",float:"right"}},[s("a-pagination",{attrs:{total:t.total,showSizeChanger:"",showQuickJumper:t.quickJumper,current:t.page,pageSize:t.pageSize,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage,showSizeChange:t.showSizeChange}})],1)])])],1)],1),s("a-layout",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-list",expression:"'storeList-staff-list'"},{name:"show",rawName:"v-show",value:1==t.storeType,expression:"storeType == 1"}],staticStyle:{position:"relative",height:"calc(100% - 125px)"}},[s("a-layout-sider",[s("storeTeam",{key:t.storeType,ref:"userGroup",attrs:{storeType:t.storeType},on:{changeGroupId:t.modalVisibleChange}})],1),s("a-layout",{staticClass:"scroll",staticStyle:{position:"absolute",left:"250px",top:"0",bottom:"0",right:"0","overflow-x":"hidden","overflow-y":"auto"}},[s("a-layout-content",[s("div",{staticClass:"content-hd"},[s("a-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入名称或手机号进行查找"},model:{value:t.searchName1,callback:function(e){t.searchName1=e},expression:"searchName1"}}),s("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.findUser}},[t._v("\n\t\t\t\t\t\t\t\t查找\n\t\t\t\t\t\t\t")]),s("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.clear}},[t._v("\n\t\t\t\t\t\t\t\t清空\n\t\t\t\t\t\t\t")]),s("div",{staticClass:"content-hd-right"},[s("a-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"reload"},on:{click:t.syncFollowUser}},[t._v("\n\t\t\t\t\t\t\t\t\t同步配置了外部联系权限的联系人\n\t\t\t\t\t\t\t\t")]),s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-add",expression:"'storeList-staff-add'"}],attrs:{icon:"plus",type:"primary"},on:{click:t.addUser}},[t._v("\n\t\t\t\t\t\t\t\t\t添加门店成员\n\t\t\t\t\t\t\t\t")])],1)],1),s("div",{staticStyle:{height:"38px"}},[t._v("\n\t\t\t\t\t\t\t共有\n\t\t\t\t\t\t\t"),s("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.total1))]),t._v("个\n\t\t\t\t\t\t")]),s("div",{staticClass:"content-bd"},[s("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[s("div",{staticClass:"spin-content"},[s("a-table",{attrs:{columns:t.columns1,dataSource:t.userList,pagination:!1,rowClassName:t.rowClassName},scopedSlots:t._u([{key:"userInfo",fn:function(e,i){return s("span",{},[i.avatar?s("a-avatar",{staticStyle:{float:"left"},attrs:{shape:"square",src:i.avatar}}):t._e(),i.avatar?t._e():s("img",{staticStyle:{width:"32px",height:"32px",float:"left"},attrs:{src:a("4bef")}}),s("div",{staticStyle:{"max-width":"300px","word-wrap":"break-word",display:"inline-block","line-height":"32px"}},[s("a-popover",{attrs:{placement:"top"}},[s("span",{attrs:{slot:"content"},slot:"content"},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.name)),i.department_name?s("span",[t._v("-")]):t._e(),t._v(t._s(i.department_name)+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t")]),s("p",{staticStyle:{cursor:"pointer",display:"inline-block","margin-left":"10px","max-width":"170px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t"+t._s(i.name)),i.department_name?s("span",[t._v("-")]):t._e(),t._v(t._s(i.department_name)+"\n\t\t\t\t\t\t\t\t\t\t\t\t\t")])])],1),s("span",{staticStyle:{display:"inline-block","line-height":"32px","vertical-align":"top"}},[1==i.gender?s("a-icon",{staticStyle:{"margin-left":"10px",color:"#427EBA"},attrs:{slot:"prefix",type:"man"},slot:"prefix"}):t._e(),2==i.gender?s("a-icon",{staticStyle:{"margin-left":"10px",color:"#ED4997"},attrs:{slot:"prefix",type:"woman"},slot:"prefix"}):t._e()],1),1!=i.is_external?s("div",{staticStyle:{color:"#E6A500"}},[t._v("外部联系人权限被取消")]):t._e()],1)}},{key:"action",fn:function(e,a){return s("span",{},[a.qc_url&&1==a.is_external?s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-downLoad",expression:"'storeList-staff-downLoad'"}],staticStyle:{margin:"3px"},on:{click:function(e){return t.qrLoad(a.qc_url)}}},[t._v("导购码下载")]):t._e(),1==a.is_external?s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-transfer",expression:"'storeList-staff-transfer'"}],staticStyle:{margin:"3px"},on:{click:function(e){return t.changeUser(a.id,a.store_id,a.user_id,a.name,a.shop_name)}}},[t._v("转移门店")]):t._e(),s("a-button",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-remove",expression:"'storeList-staff-remove'"}],staticStyle:{margin:"3px"},on:{click:function(e){return t.deleteOneUser(a.id,a.store_id,a.user_id,a.name,a.shop_name)}}},[t._v("移除成员")])],1)}}])})],1)])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.total1>0,expression:"total1 > 0"}],staticClass:"pagination",staticStyle:{margin:"20px auto","padding-bottom":"20px",height:"52px"}},[s("div",{staticClass:"pagination",staticStyle:{height:"32px",float:"right"}},[s("a-pagination",{attrs:{total:t.total1,showSizeChanger:"",showQuickJumper:t.quickJumper,current:t.page1,pageSize:t.pageSize1,pageSizeOptions:["15","30","50","100"]},on:{change:t.changePage1,showSizeChange:t.showSizeChange1}})],1)])])],1)],1)],1)]),s("a-modal",{attrs:{width:"888px!important",title:t.title},on:{cancel:t.cancelUpdate},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:t.cancelUpdate}},[t._v("取消")]),s("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.updateStore}},[t._v("提交\n\t\t\t")])],1),s("a-form",[s("a-form-item",{attrs:{label:"门店名称","label-col":{span:3},"wrapper-col":{span:20}}},[s("a-input",{attrs:{placeholder:"请输入门店名称",maxLength:30},model:{value:t.storeName,callback:function(e){t.storeName=e},expression:"storeName"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[s("span",[t._v(t._s(t.storeName.length))]),t._v("/30\n\t\t\t\t\t")])]),s("div",{staticStyle:{color:"#FF562D"}},[t._v("提交后过滤空格")])],1),s("a-form-item",{attrs:{label:"所属分组","label-col":{span:3},"wrapper-col":{span:20}}},[s("a-button",{attrs:{type:"link"},on:{click:t.selectGroup}},[t._v(t._s(t.storeGroup.title||"选择分组"))])],1),s("a-form-item",{attrs:{label:"门店地址","label-col":{span:3},"wrapper-col":{span:20}}},[s("div",[t._v(t._s(t.addressName))]),s("a-select",{staticStyle:{margin:"10px 0"},attrs:{"show-search":"",placeholder:"请输入关键词进行搜索","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":t.addrLoading?void 0:null},on:{search:t.handleSearch,change:t.handleChange,popupScroll:t.popScroll},model:{value:t.index,callback:function(e){t.index=e},expression:"index"}},[t.addrLoading?s("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):t._e(),t._l(t.address,(function(e,a){return s("a-select-option",{key:a},[t._v("\n\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t"),s("span",{staticStyle:{"margin-left":"10px",color:"#E2E2E2"}},[e.province?[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.province)+"\n\t\t\t\t\t\t\t")]:t._e(),e.province&&e.city?[t._v("\n\t\t\t\t\t\t\t\t-"+t._s(e.city)+"\n\t\t\t\t\t\t\t")]:t._e(),e.province&&e.city&&e.district?[t._v("\n\t\t\t\t\t\t\t\t-"+t._s(e.district)+"\n\t\t\t\t\t\t\t")]:t._e()],2)])}))],2),s("div",{attrs:{id:"map"}})],1)],1)],2),s("remote-js",{attrs:{src:"https://map.qq.com/api/gljs?libraries=tools&v=1.exp&key="+this.$store.state.txMapKey}}),s("group",{attrs:{groupVisible:t.groupVisible,store:t.storeGroup},on:{changeGroupId:t.changeGroupId}}),s("a-modal",{attrs:{title:"上传表格",width:"750px",confirmLoading:t.modalLoading},on:{cancel:t.upLoadHandleCancel,ok:t.upLoadHandleOk},model:{value:t.upLoadShowModal,callback:function(e){t.upLoadShowModal=e},expression:"upLoadShowModal"}},[s("div",{staticStyle:{padding:"10px 0px",overflow:"auto"}},[s("div",{staticStyle:{color:"red"}},[t._v("下载导入模板，填写门店相关信息后导入，可以快捷录入门店信息。为了避免导入时出现等待时间过长，建议单次上传不超过2000条，最多可支持3000条。")]),s("a-form-item",{attrs:{"label-col":{span:3},"wrapper-col":{span:21}}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("span",{staticStyle:{color:"red"}},[t._v(" * ")]),t._v("选择表格\n                ")]),s("a-upload",{attrs:{name:"avatar",showUploadList:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",beforeUpload:t.beforeUpload}},[s("a-button",{staticStyle:{height:"28px","font-size":"14px"},attrs:{type:"primary"}},[t._v("上传Excel\n\t\t\t\t\t")])],1),""!=t.file_name?[s("span",{staticStyle:{"margin-left":"5px"}},[t._v(t._s(t.file_name))]),s("a-icon",{staticStyle:{"vertical-align":"text-top","margin-left":"3px"},attrs:{type:"close-circle"},on:{click:t.closeExcel}})]:t._e(),s("div",{staticStyle:{"line-height":"normal","margin-bottom":"5px",color:"#999"}},[t._v("\n\t\t\t\t\t1、"),s("a",{attrs:{href:t.$store.state.commonUrl+"/upload/门店default.xlsx"}},[t._v("下载导入模板")]),t._v("\n\t\t\t\t\t。根据模板填写门店名称、门店地址、分组名称，"),s("span",{staticStyle:{color:"#FF562D"}},[t._v("提交后过滤空格。")])]),s("div",{staticStyle:{"line-height":"normal","margin-bottom":"5px",color:"#999"}},[t._v("\n\t\t\t\t\t2、门店地址请按照「xxx省xxx市xxx区」格式填写详细地址，以便系统录入。\n\t\t\t\t")]),s("div",{staticStyle:{"line-height":"normal","margin-bottom":"20px",color:"#999"}},[t._v("\n\t\t\t\t\t3、若导入的门店（名称和门店地址），已存在系统中，或者填写的分组名称，在系统中不存在，这些门店数据系统将自动过滤。\n\t\t\t\t")])],2)],1)]),s("a-modal",{attrs:{title:"上传进度",footer:!1,closable:t.progressFlag,maskClosable:!1,maskStyle:{left:t.leftSiderWidth},wrapClassName:"mask-dialog"},on:{cancel:t.cancelProgress},model:{value:t.progressVisible,callback:function(e){t.progressVisible=e},expression:"progressVisible"}},[s("div",{staticStyle:{"text-align":"center"}},[s("a-progress",{attrs:{"stroke-linecap":"square",percent:t.progressNum,type:"circle"}}),100!=t.progressNum?s("div",[s("img",{attrs:{src:a("19be"),alt:""}})]):t._e(),t.failNum>0?s("p",{staticStyle:{margin:"0 auto 20px"}},[t._v(t._s(t.failMsg))]):t._e()],1)]),s("a-modal",{attrs:{width:"666px!important",title:t.userTitle},on:{cancel:t.cancelUser},model:{value:t.userVisible,callback:function(e){t.userVisible=e},expression:"userVisible"}},[s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:t.cancelUser}},[t._v("取消")]),s("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.updateUser}},[t._v("提交\n\t\t\t")])],1),s("a-form",[s("a-form-item",{attrs:{label:1==t.transfer?"成员名称":"选择成员","label-col":{span:3},"wrapper-col":{span:20}}},[0==t.transfer?s("a-button",{attrs:{type:"link"},on:{click:t.showDepartmentList}},[0==t.chooseNum?[t._v("选择成员")]:t._e(),t.chooseNum>0?[t._v("已选择"+t._s(t.chooseUserNum)+"名成员，"+t._s(t.chooseNum-t.chooseUserNum)+"个部门\n\t\t\t\t\t")]:t._e()],2):t._e(),0==t.transfer?s("a",{directives:[{name:"show",rawName:"v-show",value:t.chooseNum>0,expression:"chooseNum > 0"}],staticStyle:{"margin-left":"10px"},on:{click:t.clearDepartmentList}},[t._v("\n\t\t\t\t\t重置\n\t\t\t\t")]):t._e(),s("span",[t._v(t._s(t.userName))])],1),s("a-form-item",{attrs:{label:"选择门店","label-col":{span:3},"wrapper-col":{span:20}}},[0==t.storeIds.length?[s("a-button",{attrs:{type:"link"},on:{click:t.showStoreModal}},[t._v("\n\t\t\t\t\t\t选择门店\n\t\t\t\t\t")])]:t._e(),t.storeIds.length>0?[s("a-popover",{attrs:{placement:"right"}},[s("span",{attrs:{slot:"content"},slot:"content"},[s("div",{staticStyle:{"max-width":"375px"}},t._l(t.storeDetail,(function(e){return s("a-tag",{staticStyle:{display:"inline-block",margin:"0 10px 5px 0"},attrs:{color:"orange"}},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t\t\t\t\t")])})),1)]),s("a-button",{attrs:{type:"link"},on:{click:t.showStoreModal}},[t._v("\n\t\t\t\t\t\t\t已选择"+t._s(t.storeIds.length)+"个门店\n\t\t\t\t\t\t")])],1)]:t._e(),s("a",{directives:[{name:"show",rawName:"v-show",value:t.storeIds.length>0,expression:"storeIds.length > 0"}],staticStyle:{"margin-left":"10px"},on:{click:t.clearStoreList}},[t._v("\n\t\t\t\t\t重置\n\t\t\t\t")])],2)],1)],2),s("chooseDepartment",{ref:"user",attrs:{show:t.showModalDepartment,chooseNum:t.chooseNum,is_external:1,is_from:7,callback:t.modalVisibleChange3,noticeTitle:"只显示具有外部联系人权限的成员"}}),s("store-list",{attrs:{groupVisible:t.storeVisible,storeIds:JSON.parse(JSON.stringify(t.storeIds)),storeDetail:JSON.parse(JSON.stringify(t.storeDetail))},on:{setGroupId:t.setGroupId}})],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-msg"},[a("p",{staticStyle:{"margin-bottom":"2px"}},[t._v("\n\t\t\t\t\t1、门店成员列表只显示具有外部联系人权限的人。")]),a("p",{staticStyle:{"margin-bottom":"0px",color:"#FF562D"}},[t._v("\n\t\t\t\t\t2、添加门店成员时，由于官方接口有一定的延迟，可能会导致门店码里的成员不能及时更新，和导购码不能下载，请手动刷新页面即可。")])])}],r=(a("20d6"),a("6c7b"),a("ac6a"),a("456d"),a("55dd"),a("28a5"),a("7f7f"),a("96cf"),a("3b8d")),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"group-tree1",staticStyle:{position:"absolute",width:"100%",height:"100%"}},[s("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading}},[0==t.storeType?s("div",{staticClass:"team-add",staticStyle:{"margin-top":"0px"}},[s("span",{staticClass:"team-add-title",staticStyle:{position:"absolute"}},[t._v("分组管理")]),s("span",{directives:[{name:"has",rawName:"v-has",value:"channel-group-add",expression:"'channel-group-add'"}],staticStyle:{color:"#1890FF","margin-left":"5px",cursor:"pointer",position:"absolute",right:"10px"},on:{click:function(e){return t.addGroupModal("",[])}}},[s("a-tooltip",{attrs:{placement:"bottom"}},[s("template",{slot:"title"},[s("span",[t._v("添加分组")])]),s("a-icon",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-groupAdd",expression:"'storeList-manage-groupAdd'"}],staticClass:"team-add-icon",attrs:{type:"plus"},on:{click:function(e){return t.addGroupModal("",[])}}})],2)],1)]):t._e(),s("div",{class:0==t.storeType?"store-team":"user-team",staticStyle:{position:"absolute",width:"100%",overflow:"auto","white-space":"nowrap"}},[s("div",{staticStyle:{"margin-bottom":"6px"}},[s("div",{class:""==t.id?"active":"",staticStyle:{display:"inline-block","margin-left":"30px",cursor:"pointer"},on:{click:t.clickAll}},[t._v("所有\n\t\t\t\t\t")]),s("div",{staticStyle:{display:"inline-block",color:"#C3C3C3"}},[t._v("（"+t._s(t.count)+"）")])]),s("a-tree",{staticClass:"draggable-tree",attrs:{draggable:0==t.storeType,treeData:t.gData,"load-data":t.onLoadData},on:{dragenter:t.onDragEnter,mouseleave:t.hideMoreIcon,drop:t.onDrop,dragstart:t.dragstart,select:t.onselect},scopedSlots:t._u([{key:"custom",fn:function(e){var i=e.title,r=e.key,o=(e.pid_all,e.count),n=e.store;return[s("div",{staticStyle:{"min-width":"100%"},on:{mouseover:function(e){return t.showMoreIcon(r)}}},[s("div",{class:r==t.id?"active":"",staticStyle:{display:"inline-block"}},[t._v(t._s(i)+"\n\t\t\t\t\t\t\t")]),s("div",{staticStyle:{display:"inline-block",color:"#C3C3C3"}},[t._v("（"+t._s(o)+"）")]),r==t.mouseOverId&&"未分组"!=i&&0==t.storeType&&t.isShowPop?s("a-popover",{attrs:{placement:"right",trigger:"hover"}},[s("template",{slot:"content"},[s("div",{on:{mouseover:t.clearLeave,mouseleave:t.hideMoreIcon1}},[s("p",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-groupCreat",expression:"'storeList-manage-groupCreat'"}],staticClass:"operation",on:{click:function(e){return t.addGroupModal(r)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t创建子分组")]),s("p",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-groupEdit",expression:"'storeList-manage-groupEdit'"}],staticClass:"operation",on:{click:function(e){return t.editGroupName(r,i)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t编辑分组")]),t.delFlag?s("p",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-groupDel",expression:"'storeList-manage-groupDel'"}],staticClass:"operation2",on:{click:function(e){return t.removeGroup(r,i,o)}}},[t._v("删除分组")]):t._e(),t.delFlag?t._e():s("p",{directives:[{name:"has",rawName:"v-has",value:"storeList-manage-groupDel",expression:"'storeList-manage-groupDel'"}],staticClass:"operation1"},[t._v("删除分组")])])]),s("img",{staticStyle:{position:"absolute","margin-top":"2px","margin-right":"5px"},style:{right:"-"+t.getClientWidth+"px"},attrs:{src:a("69f5")},on:{mouseover:function(e){return t.lookOperation(r)}}})],2):t._e(),r==t.mouseOverId&&n&&1==t.storeType?s("a-popover",{attrs:{placement:"right",trigger:"hover"}},[s("template",{slot:"content"},[s("div",{on:{mouseover:t.clearLeave,mouseleave:t.hideMoreIcon1}},[s("p",{staticClass:"operation",staticStyle:{"margin-bottom":"0px"},on:{click:function(e){return t.addUser(r,i)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t添加门店成员")])])]),s("img",{directives:[{name:"has",rawName:"v-has",value:"storeList-staff-add",expression:"'storeList-staff-add'"}],staticStyle:{position:"absolute","margin-top":"2px","margin-right":"5px"},style:{right:"-"+t.getClientWidth+"px"},attrs:{src:a("69f5")},on:{mouseover:function(e){return t.lookOperation(r)}}})],2):t._e()],1)]}}])})],1)]),s("a-modal",{attrs:{title:t.groupTitle,destroyOnClose:!0,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleOk,cancel:t.handleCancel}},[s("div",{staticStyle:{color:"#ff562D","margin-bottom":"5px"}},[t._v("提交后过滤空格")]),s("a-input",{attrs:{placeholder:"请输入分组名(不得超过15个字符)",maxLength:15},model:{value:t.groupName,callback:function(e){t.groupName=e},expression:"groupName"}},[s("span",{attrs:{slot:"suffix"},slot:"suffix"},[s("span",[t._v(t._s(t.groupName.length))]),t._v("/15\n\t\t\t\t")])])],1),s("a-modal",{attrs:{width:"666px!important",title:"添加门店成员"},on:{cancel:t.cancelUser},model:{value:t.userVisible,callback:function(e){t.userVisible=e},expression:"userVisible"}},[s("template",{slot:"footer"},[s("a-button",{key:"back",on:{click:t.cancelUser}},[t._v("取消")]),s("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.updateUser}},[t._v("提交\n\t\t\t\t")])],1),s("a-form",[s("a-form-item",{attrs:{label:"当前门店","label-col":{span:3},"wrapper-col":{span:20}}},[s("span",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.storeName))])]),s("a-form-item",{attrs:{label:"选择成员","label-col":{span:3},"wrapper-col":{span:20}}},[s("a-button",{attrs:{type:"link"},on:{click:t.showDepartmentList}},[0==t.chooseNum?[t._v("选择成员")]:t._e(),t.chooseNum>0?[t._v("已选择"+t._s(t.chooseUserNum)+"名成员，"+t._s(t.chooseNum-t.chooseUserNum)+"个部门\n\t\t\t\t\t\t")]:t._e()],2),s("a",{directives:[{name:"show",rawName:"v-show",value:t.chooseNum>0,expression:"chooseNum > 0"}],staticStyle:{"margin-left":"10px"},on:{click:t.clearDepartmentList}},[t._v("\n\t\t\t\t\t\t重置\n\t\t\t\t\t")])],1)],1)],2),s("chooseDepartment",{ref:"user",attrs:{show:t.showModalDepartment,chooseNum:t.chooseNum,is_external:1,is_from:7,callback:t.modalVisibleChange3,noticeTitle:"只显示具有外部联系人权限的成员"}})],1)},n=[],l=(a("5df3"),a("6b54"),a("a481"),a("75fc")),c=(a("7514"),a("c5f6"),a("c75b")),d={name:"Team",props:{storeType:{type:Number,default:0}},components:{chooseDepartment:c["a"]},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{isLoading:!1,corpId:t,id:"",currentId:"",parentId:"",gData:[],groupData:[],groupName:"",groupTitle:"",visible:!1,confirmLoading:!1,editGroupId:"",count:"",delFlag:!1,mouseOverId:"",timeout:"",getClientWidth:"0",allObj:[],storeKey:"",storeName:"",loading:!1,userVisible:!1,checkedList:[],showModalDepartment:!1,chooseNum:0,chooseUserNum:0,isShowPop:!0}},mounted:function(){if(this.isLoading=!0,this.getGroupList(),"all"==localStorage.getItem("permissionButton"))this.isShowPop=!0;else{var t=JSON.stringify(localStorage.getItem("permissionButton")).split(",");-1==t.indexOf("storeList-manage-groupCreat")&&-1==t.indexOf("storeList-manage-groupEdit")&&-1==t.indexOf("storeList-manage-groupDel")&&(this.isShowPop=!1)}0==this.storeType?window.document.getElementsByClassName("store-team")[0].addEventListener("scroll",this.handleScroll):window.document.getElementsByClassName("user-team")[0].addEventListener("scroll",this.handleScroll)},methods:{showDepartmentList:function(){this.showModalDepartment=!0;var t=[];this.checkedList.map((function(e){t.push(e.id)})),this.$refs.user.rightIdList=JSON.parse(JSON.stringify(t)),this.$refs.user.rightList=JSON.parse(JSON.stringify(this.checkedList))},modalVisibleChange3:function(t,e,a,s,i){"ok"==t&&(this.chooseNum=parseInt(a)+parseInt(s),this.chooseUserNum=a,this.chooseNum>0?this.checkedList=JSON.parse(JSON.stringify(i)):this.checkedList=[]),this.showModalDepartment=!1},clearDepartmentList:function(){this.checkedList=[],this.chooseNum=0,this.chooseUserNum=0},cancelUser:function(){this.userVisible=!1,this.checkedList=[],this.chooseNum=0,this.chooseUserNum=0,this.storeKey="",this.storeName=""},updateUser:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.loading=!0,0!=this.chooseNum){t.next=6;break}return this.loading=!1,this.$message.destroy(),this.$message.warning("请选择成员"),t.abrupt("return",!1);case 6:for(e=[],a=0;a<this.checkedList.length;a++)e.push(this.checkedList[a].id);return t.next=10,this.axios.post("auth-store/add-store-user",{uid:localStorage.getItem("uid"),corp_id:this.corpId,store_id:[this.storeKey],user_ids:e});case 10:s=t.sent,i=s.data,0!=i.error?(this.$message.destroy(),this.$message.error(i.error_msg)):(this.loading=!1,i.data.length>0?(this.updateBatchAddCount(i.data),this.cancelUser(),this.$emit("changeGroupId",this.corpId,this.id)):(this.$message.destroy(),this.$message.warning("该门店下已有该成员")));case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addUser:function(t,e){this.storeKey=t,this.storeName=e,this.userVisible=!0},handleScroll:function(){0==this.storeType?this.getClientWidth=document.getElementsByClassName("store-team")[0].scrollLeft:this.getClientWidth=document.getElementsByClassName("user-team")[0].scrollLeft},clickAll:function(){this.id="",this.$emit("changeGroupId",this.corpId,this.id)},lookOperation:function(t){var e=this;e.delFlag=this.allObj["s_"+t].isLeaf},showMoreIcon:function(t){clearTimeout(this.timeout),this.mouseOverId=t},clearLeave:function(){clearTimeout(this.timeout)},hideMoreIcon:function(){var t=this;this.timeout=setTimeout((function(){t.mouseOverId=""}),300)},hideMoreIcon1:function(){this.mouseOverId=""},addGroupModal:function(t){this.mouseOverId="",this.parentId=t,this.editGroupId="",this.groupName="",this.groupTitle="新建分组",this.visible=!0},editGroupName:function(t,e){this.mouseOverId="",this.parentId="",this.editGroupId=t,this.groupName=e,this.groupTitle="编辑分组",this.visible=!0},removeGroup:function(t,e,a){this.mouseOverId="";var s=this;s.$confirm({title:"【"+e+"】一旦删除，归属于该分组的门店都将被移至【未分组】，确定删除分组吗?",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){s.delGroup(t,a)}})},delGroup:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.next=3,this.axios.post("auth-store/add-group",{uid:localStorage.getItem("uid"),id:e,corp_id:this.corpId,status:0});case 3:if(s=t.sent,i=s.data,0!=i.error)this.isLoading=!1,this.$message.destroy(),this.$message.error(i.error_msg);else{if(this.$message.destroy(),this.$message.success("删除成功"),r=this.allObj["s_"+e].pid,0!=r){this.allObj["s_"+r].children.splice(this.allObj["s_"+r].children.findIndex((function(t){return t.id==e})),1),0==this.allObj["s_"+r].children.length&&(this.allObj["s_"+r].isLeaf=!0);while(0!=r)this.allObj["s_"+r].count=this.allObj["s_"+r].count-a,r=this.allObj["s_"+r].pid}else this.gData.splice(this.gData.findIndex((function(t){return t.id==e})),1);o=this.gData.find((function(t){return"未分组"==t.title})),o.count=o.count+a,this.gData=Object(l["a"])(this.gData),this.allObj=[],this.loopAllObj(this.gData),this.id==e&&(this.id=""),this.$emit("changeGroupId",this.corpId,this.id),this.isLoading=!1}case 6:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),handleOk:function(){this.addGroup()},addGroup:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isLoading=!0,this.groupName.trim()){t.next=6;break}return this.isLoading=!1,this.$message.destroy(),this.$message.warning("分组名不能为空"),t.abrupt("return",!1);case 6:if("未分组"!=this.groupName){t.next=11;break}return this.isLoading=!1,this.$message.destroy(),this.$message.warning("分组名不能为“未分组”，请更换名称！"),t.abrupt("return",!1);case 11:return t.next=13,this.axios.post("auth-store/add-group",{id:this.editGroupId,uid:localStorage.getItem("uid"),pid:this.parentId,group_name:this.groupName,corp_id:this.corpId});case 13:e=t.sent,a=e.data,0!=a.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(a.error_msg)):(this.editGroupId?(this.allObj["s_"+this.editGroupId].title=this.groupName.replace(/\s+/g,""),this.$message.destroy(),this.$message.success("修改成功")):(s={count:0,id:a.id.toString(),isLeaf:!0,key:a.id.toString(),pid:this.parentId||"0",scopedSlots:{title:"custom"},title:this.groupName.replace(/\s+/g,"")},""==this.parentId?(this.gData.push(s),this.allObj["s_"+a.id]=this.gData[this.gData.length-1]):(this.allObj["s_"+s.pid]&&this.allObj["s_"+s.pid]["children"]?this.allObj["s_"+s.pid].children.push(s):(i=[],i.push(s),this.allObj["s_"+s.pid]["children"]=i,this.allObj["s_"+s.pid].isLeaf=!1),this.allObj["s_"+s.pid].isLeaf=!1,this.allObj["s_"+a.id]=this.allObj["s_"+s.pid].children[this.allObj["s_"+s.pid].children.length-1]),this.gData=Object(l["a"])(this.gData),this.allObj=[],this.loopAllObj(this.gData),this.$message.destroy(),this.$message.success("添加成功")),this.groupName="",this.editGroupId="",this.visible=!1,this.isLoading=!1);case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleCancel:function(){this.groupName="",this.editGroupId="",this.visible=!1},loopAllObj:function(t){var e=this;t.forEach((function(t){if(e.allObj["s_"+t.id]=t,t.children&&t.children.length>0&&!t.isLeaf)return e.loopAllObj(t.children)}))},onLoadData:function(t){var e=this;return new Promise((function(a){Promise.all([e.getGroupList(t.dataRef.key)]).then((function(s){t.dataRef.children=e.groupData,e.gData=Object(l["a"])(e.gData),e.allObj=[],e.loopAllObj(e.gData),a()})).catch((function(t){}))}))},getGroupList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,r,o,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=n.length>1&&void 0!==n[1]?n[1]:"",t.next=3,this.axios.post("auth-store/get-group-list",{uid:localStorage.getItem("uid"),corp_id:this.corpId,parent_id:e||this.id,key:a,store:this.storeType});case 3:if(s=t.sent,i=s.data,0!=i.error)this.isLoading=!1,this.$message.destroy(),this.$message.error(i.error_msg);else{if(e)for(this.groupData=i.data.data,r=0;r<i.data.data.length;r++)this.allObj["s_"+i.data.data[r].id]=i.data.data[r];else{for(this.gData=i.data.data,o=0;o<this.gData.length;o++)this.allObj["s_"+this.gData[o].key]=this.gData[o];this.count=i.data.count,this.$emit("changeGroupId",this.corpId,this.id)}this.isLoading=!1}case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onselect:function(t,e){t.length>0&&this.id!=t[0]&&(this.id=t[0],this.$emit("changeGroupId",this.corpId,this.id))},dragstart:function(t){this.currentId=t.node.eventKey},onDragEnter:function(t){this.expandedKeys=t.expandedKeys},onDrop:function(t){var e=this;if(this.isLoading=!0,!t.dragNode||!t.node)return this.isLoading=!1,!1;var a=t.node.pos.split("-"),s=t.dragNode.dataRef,i=t.node.dataRef,r=t.dropPosition-Number(a[a.length-1]),o=JSON.parse(JSON.stringify(this.gData)),n="",l=[],c=s.count,d=0;if(t.dropToGap)if(t.node.isLeaf&&t.node.expanded&&1===r){var h=JSON.parse(JSON.stringify(i));h["children"]=h.children||[],n=h.key,h.children.unshift(s),l=h.children}else{var p,u;p=0==i.pid?JSON.parse(JSON.stringify(o)):JSON.parse(JSON.stringify(this.allObj["s_"+i.pid].children));var g=p.findIndex((function(t){return t.key==s.id}));g>-1&&p.splice(g,1),u=p.findIndex((function(t){return t.key==i.key})),n=0==i.pid?"":i.pid,p.length>0&&(-1===r?(p.splice(u,0,s),l=p,d=u):(p.splice(u+1,0,s),l=p,d=u+1))}else l=JSON.parse(JSON.stringify(i.children||[])),l.splice(0,0,s),n=i.id;for(var m=!1,f=function(t){"未分组"==e.gData[t].title&&(n==e.gData[t].key?(e.$message.destroy(),e.$message.warning(e.gData[t].title+"不可加入其他分组！"),e.isLoading=!1,m=!0):""!=n&&l.forEach((function(a){a.key==e.gData[t].key&&(e.$message.destroy(),e.$message.warning(e.gData[t].title+"不可移入其他分组！"),e.isLoading=!1,m=!0)})))},v=0;v<this.gData.length;v++)f(v);if(m)return this.isLoading=!1,!1;var b=[];l&&l.length>0&&l.forEach((function(t){b.push(t.key)})),this.moveGroup(n,b,c,s.key,d)},moveGroup:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a,s,i,r){var o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/group-sort",{uid:localStorage.getItem("uid"),parent_id:e,group_id:this.currentId,sort:a,corp_id:this.corpId});case 2:o=t.sent,n=o.data,0!=n.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(n.error_msg)):(this.move(e,s,i,r),this.$emit("changeGroupId",this.corpId,this.id));case 5:case"end":return t.stop()}}),t,this)})));function e(e,a,s,i,r){return t.apply(this,arguments)}return e}(),move:function(t,e,a,s){var i=t;if(0!=i){this.allObj["s_"+i]["children"]=this.allObj["s_"+i]["children"]||[],this.allObj["s_"+i].isLeaf=!1;while(0!=i)this.allObj["s_"+i].count=this.allObj["s_"+i].count+e,i=this.allObj["s_"+i].pid}if(i=this.allObj["s_"+a].pid,0!=i){var r={},o=this.allObj["s_"+i].children,n=o.findIndex((function(t){return t.id==a}));r=JSON.parse(JSON.stringify(o[n])),o.splice(n,1),t?(r.pid=t,this.allObj["s_"+t].children.splice(s,0,r)):(r.pid="0",this.gData.splice(s,0,r)),this.loopAllObj([r]),0==this.allObj["s_"+i].children.length&&(this.allObj["s_"+i].isLeaf=!0);while(0!=i)this.allObj["s_"+i].count=this.allObj["s_"+i].count-e,i=this.allObj["s_"+i].pid}else{var c=this.gData.findIndex((function(t){return t.id==a})),d=JSON.parse(JSON.stringify(this.gData[c]));this.gData.splice(c,1),t?(d.pid=t,this.allObj["s_"+t].children.splice(s,0,d),this.allObj["s_"+t].isLeaf=!1):(d.pid="0",this.gData.splice(s,0,d)),this.loopAllObj([d])}this.gData=Object(l["a"])(this.gData),this.allObj=[],this.loopAllObj(this.gData),this.isLoading=!1},otherUserMove:function(t,e,a){this.isLoading=!0;for(var s=this.allObj["s_"+t].count,i=Object.keys(a),r=0,o=0;o<i.length;o++)a[o]==t&&(r=o);this.move(e,s,t,r)},updateCount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(a=parseInt(a),this.isLoading=!0,0!=t.length){for(var s=0;s<t.length;s++)this.allObj["s_"+t[s]]&&(this.allObj["s_"+t[s]].count-=a);this.count-=a}if(""!=e){for(var i=0;i<e.length;i++)this.allObj["s_"+e[i]]&&(this.allObj["s_"+e[i]].count+=a);this.count+=a}this.isLoading=!1},updateBatchAddCount:function(t){for(var e=0;e<t.length;e++)t[e].pid_all.push(t[e].store),this.updateCount([],t[e].pid_all,t[e].num)},updateBatchMoveCount:function(t){for(var e=0;e<t.length;e++)0!=t[e].old_pid_all.length&&t[e].old_pid_all.push(t[e].store_old),t[e].pid_all.push(t[e].store),this.updateCount(t[e].old_pid_all,t[e].pid_all,t[e].num)},updateBatchDelCount:function(t){for(var e=0;e<t.length;e++)t[e].pid_all.push(t[e].store),this.updateCount(t[e].pid_all,[],t[e].num)}}},h=d,p=(a("53ba"),a("2877")),u=Object(p["a"])(h,o,n,!1,null,"72159ea4",null),g=u.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.visible?a("a-modal",{attrs:{width:"600px!important",title:"选择分组"},on:{cancel:t.cancelGroup},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.cancelGroup}},[t._v("取消")]),a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.updateGroup}},[t._v("确定\n\t\t\t")])],1),a("div",{staticStyle:{"margin-bottom":"10px","font-weight":"700"}},[t._v("已选择分组： "+t._s(t.title||"未分组"))]),a("div",{staticClass:"group-tree1",staticStyle:{height:"350px",overflow:"auto"}},[a("a-tree",{staticClass:"draggable-tree",attrs:{treeData:t.gData,"load-data":t.onLoadData},on:{select:t.onselect},scopedSlots:t._u([{key:"custom",fn:function(e){var s=e.title,i=e.key,r=e.count;return[a("div",{staticStyle:{"min-width":"100%"}},[a("div",{class:i==t.id?"active":"",staticStyle:{display:"inline-block"}},[t._v(t._s(s)+"（"+t._s(r)+"）\n\t\t\t\t\t\t")])])]}}],null,!1,3529433922)})],1)],2):t._e()],1)},f=[],v={name:"Team",props:{groupVisible:{type:Boolean,default:!1},store:{type:Object,default:{id:"",title:""}}},watch:{store:function(t,e){if(""==t.id){var a=this.gData.find((function(t){return"未分组"==t.title}));this.id=a.id,this.title=a.title}else this.id=t.id,this.title=t.title},groupVisible:function(t,e){this.visible=t,this.visible&&this.getGroupList()}},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{corpId:t,searchName:"",id:"",title:"",currentId:"",gData:[],groupData:[],visible:!1}},mounted:function(){this.id=this.store.id,this.title=this.store.title,this.getGroupList()},methods:{cancelGroup:function(){this.$emit("changeGroupId","cancle")},updateGroup:function(){this.$emit("changeGroupId","ok",this.id,this.title)},onLoadData:function(t){var e=this;return new Promise((function(a){Promise.all([e.getGroupList(t.dataRef.key)]).then((function(s){t.dataRef.children=e.groupData;e.gData;e.gData=Object(l["a"])(e.gData),a()})).catch((function(t){}))}))},loopObjByKey:function(t,e,a){var s=this;t.forEach((function(t){return t.key==e?a(t):t.children&&t.children.length>0&&!t.isLeaf?s.loopObjByKey(t.children,e,a):void 0}))},getGroupList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/get-group-list",{uid:localStorage.getItem("uid"),corp_id:this.corpId,parent_id:e||"",store:0});case 2:a=t.sent,s=a.data,0!=s.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(s.error_msg)):(e?this.groupData=s.data.data:(this.gData=s.data.data,""==this.store.id&&""==this.id&&(i=this.gData.find((function(t){return"未分组"==t.title})),this.id=i.id,this.title=i.title)),this.isLoading=!1);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onselect:function(t,e){if(t.length>0&&this.id!=t[0]){this.id=t[0];var a=this;a.title=e.node.dataRef.title}}}},b=v,y=(a("8e18"),Object(p["a"])(b,m,f,!1,null,"5ab7a68e",null)),x=y.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("rem-js",{attrs:{src:t.js}})},k=[],_={name:"remote-js",props:{js:{type:String,default:"https://map.qq.com/api/gljs"}},components:{"rem-js":{render:function(t){return t("script",{attrs:{type:"text/javascript",src:this.src}})},props:{src:{type:String,required:!0}}}}},L=_,S=Object(p["a"])(L,w,k,!1,null,null,null),I=S.exports;function N(t,e){t=t.replace(/=/g,"");var a=[];switch(e.constructor){case String:case Number:case Boolean:a.push(encodeURIComponent(t)+"="+encodeURIComponent(e));break;case Array:e.forEach((function(e){a=a.concat(N(t+"[]=",e))}));break;case Object:Object.keys(e).forEach((function(s){var i=e[s];a=a.concat(N(t+"["+s+"]",i))}))}return a}function A(t){var e=[];return t.forEach((function(t){"string"==typeof t?e.push(t):e=e.concat(A(t))})),e}
/**
 * Vue Jsonp.
 * # Carry Your World #
 *
 * @author: LancerComet
 * @license: MIT
 */function O(t,e,a){if(void 0===e&&(e={}),"string"!=typeof t)throw new Error('[Vue-jsonp] Type of param "url" is not string.');if("object"!=typeof e||!e)throw new Error("[Vue-jsonp] Invalid params, should be an object.");return a="number"==typeof a?a:5e3,new Promise((function(s,i){var r="string"==typeof e.callbackQuery?e.callbackQuery:"callback",o="string"==typeof e.callbackName?e.callbackName:"jsonp_"+(Math.floor(1e5*Math.random())*Date.now()).toString(16);e[r]=o,delete e.callbackQuery,delete e.callbackName;var n=[];Object.keys(e).forEach((function(t){n=n.concat(N(t,e[t]))}));var l=A(n).join("&"),c=function(){d(),clearTimeout(p),i({status:400,statusText:"Bad Request"})},d=function(){u.removeEventListener("error",c)},h=function(){document.body.removeChild(u),delete window[o]},p=null;a>-1&&(p=setTimeout((function(){d(),h(),i({statusText:"Request Timeout",status:408})}),a)),window[o]=function(t){clearTimeout(p),d(),h(),s(t)};var u=document.createElement("script");u.addEventListener("error",c),u.src=t+(/\?/.test(t)?"&":"?")+l,document.body.appendChild(u)}))}var C=a("7528"),D=[{title:"",key:"select",scopedSlots:{customRender:"select"}},{title:"门店名称",dataIndex:"shop_name",key:"shop_name",width:"180px"},{title:"所属区域",dataIndex:"province",key:"province",width:"180px",scopedSlots:{customRender:"province"}},{title:"门店地址",dataIndex:"address",key:"address",width:"180px"},{dataIndex:"name",key:"name",scopedSlots:{title:"name"}},{title:"门店状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{dataIndex:"user_count",key:"user_count",scopedSlots:{title:"user_count"}},{dataIndex:"userAdd",key:"userAdd",scopedSlots:{customRender:"userAdd",title:"user_add"}},{dataIndex:"userDel",key:"userDel",scopedSlots:{customRender:"userDel",title:"user_del"}},{title:"操作",dataIndex:"action",key:"action",width:"200px",scopedSlots:{customRender:"action"}}],T=[{title:"成员列表",dataIndex:"userInfo",key:"userInfo",scopedSlots:{customRender:"userInfo"}},{title:"手机号",dataIndex:"mobile",key:"mobile"},{title:"所属门店",dataIndex:"shop_name",key:"shop_name"},{title:"操作",dataIndex:"action",key:"action",width:"350px",scopedSlots:{customRender:"action"}}],j={components:{remoteJs:I,storeTeam:g,group:x,chooseDepartment:c["a"],storeList:C["a"]},data:function(){return{storeStatus:"",isMasterAccount:localStorage.getItem("isMasterAccount"),disableOpen:!1,storeType:1,corpId:"",suite_id:"",type:"",groupId:"",status:"",searchName:"",storeList:[],isLoading:!0,columns:D,columns1:T,total:0,quickJumper:!1,page:1,pageSize:15,selectedRowKeys:[],checkBoxValue:[],batchType:"0",batchTypeValue:!1,visible:!1,title:"创建门店",loading:!1,storeName:"",storeGroup:{id:"",title:""},groupVisible:!1,map:null,infoWindow:null,marker:null,editId:"",lat:31.832473286033732,lng:117.21106041882322,index:[],address:[],addressName:"",name:"",addrLoading:!1,searchInter:0,key:this.$store.state.txMapKey,upLoadShowModal:!1,modalLoading:!1,fileInfo:{},file_name:"",tag_arr3:[],progressVisible:!1,progressNum:0,leftSiderWidth:document.getElementsByClassName("menu-sider")[0].style.width,successNum:0,failMsg:"",failNum:0,notImportNum:0,userList:[],searchName1:"",total1:0,page1:1,pageSize1:15,progressFlag:!1,userVisible:!1,userTitle:"添加门店成员",transfer:0,userName:"",editIds:[],checkedList:[],storeAdd:0,storeIds:[],storeDetail:[],storeVisible:!1,showModalDepartment:!1,chooseNum:0,chooseUserNum:0}},methods:{changeTab:function(t){this.storeType=t},syncFollowUser:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.selectedRowKeys=[],this.isLoading=!0,this.$message.info("已进入后台刷新中，请耐心等待..."),t.next=5,this.axios.post("work-follow-user/refresh-follow-user",{suite_id:1,corp_id:this.corpId,from:1});case 5:e=t.sent,a=e.data,0!=a.error?(this.$message.destroy(),this.$message.error(a.error_msg),this.isLoading=!1):(this.$message.destroy(),this.$message.success("同步完成！"),0==this.storeType?this.getStoreList():this.getUserList());case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addStore:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.id="",e=this,t.next=4,O("https://apis.map.qq.com/ws/location/v1/ip?&key="+this.key+"&get_poi=1&output=jsonp");case 4:a=t.sent,0!=a.status?(this.$message.destroy(),this.$message.error(a.error_msg)):(this.lat=a.result.location.lat,this.lng=a.result.location.lng,this.visible=!0,s=setInterval(Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("undefined"==typeof TMap){t.next=7;break}return clearInterval(s),e.initMap(),t.next=5,O("https://apis.map.qq.com/ws/geocoder/v1/?location="+e.lat+","+e.lng+"&key=MIWBZ-ECBCD-RSK4W-PCPUC-G6ETT-MMFLL&get_poi=1&output=jsonp");case 5:a=t.sent,0==a.status?(i=new TMap.LatLng(e.lat,e.lng),e.initMakert(i),e.addressName=a.result.address+" - "+(a.result.formatted_addresses.recommend||a.result.formatted_addresses.rough),e.initInfoWindow(i,'<div style="height: 20px">'+a.result.address+'</div><div style="height: 30px">'+(a.result.formatted_addresses.recommend||a.result.formatted_addresses.rough)+"</div>")):e.addressName="";case 7:case"end":return t.stop()}}),t)})))));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),editStore:function(t){this.storeGroup={id:t.group_id,title:t.name},this.storeName=t.shop_name,this.lat=t.lat,this.lng=t.lng,this.editId=t.id,this.addressName=t.address,this.visible=!0;var e=this,a=setInterval(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:TMap&&(new TMap.LatLng(e.lat,e.lng),clearInterval(a),e.initMap(e.initMakertAndInfo));case 1:case"end":return t.stop()}}),t)}))))},initMakertAndInfo:function(t){this.initMakert(t),this.initInfoWindow(t,'<div style="height: 30px">'+this.addressName+"</div>")},initMap:function(t){var e=this;this.$nextTick((function(){var a=new TMap.LatLng(e.lat,e.lng);e.map=new TMap.Map(document.getElementById("map"),{zoom:17.2,pitch:43.5,center:a}),"function"==typeof t&&t(a),e.map.on("click",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(a){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a.poi||!a.poi.name){t.next=8;break}return e.lat=a.latLng.getLat(),e.lng=a.latLng.getLng(),e.initMakert(a.latLng),t.next=6,O("https://apis.map.qq.com/ws/geocoder/v1/?location="+e.lat+","+e.lng+"&key=MIWBZ-ECBCD-RSK4W-PCPUC-G6ETT-MMFLL&get_poi=1&output=jsonp");case 6:s=t.sent,0==s.status?(e.addressName=s.result.address+" - "+a.poi.name,e.initInfoWindow(a.latLng,'<div style="height: 20px">'+s.result.address+'</div><div style="height: 30px">'+a.poi.name+"</div>")):(e.addressName=a.poi.name,e.initInfoWindow(a.latLng,a.poi.name));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))},initMakert:function(t){var e=this;if(e.marker){e.marker.setMap(null),e.marker=null;var a=setInterval((function(){e.marker||(clearInterval(a),e.marker=new TMap.MultiMarker({id:"marker-layer",map:e.map,styles:{marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:10,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/marker-pink.png"})},geometries:[{id:"demo",styleId:"marker",position:t,properties:{title:"marker"}}]}),e.marker.on("click",(function(t){e.infoWindow.open()})))}),100)}else e.marker=new TMap.MultiMarker({id:"marker-layer",map:e.map,styles:{marker:new TMap.MarkerStyle({width:25,height:35,anchor:{x:10,y:32},src:"https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/marker-pink.png"})},geometries:[{id:"demo",styleId:"marker",position:t,properties:{title:"marker"}}]}),e.marker.on("click",(function(t){e.initInfoWindow(t.latLng)}))},initInfoWindow:function(t,e){var a=this;a.infoWindow?(a.infoWindow.open(),a.infoWindow.setPosition(t),a.infoWindow.setContent(e)):a.infoWindow=new TMap.InfoWindow({content:e,position:t,map:a.map,offset:{x:10,y:-25}})},cancelUpdate:function(){this.visible=!1,this.storeName="",this.addressName="",this.editId="",this.storeGroup={id:"",title:""},this.marker.setMap(null),this.marker=null,this.infoWindow.setMap(null),this.infoWindow=null,this.map.destroy(),document.getElementById("map").innerText=""},updateStore:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.loading=!0,""!=this.storeName.trim()){t.next=8;break}return this.loading=!1,this.$message.destroy(),this.$message.warning("请填写门店名称"),t.abrupt("return",!1);case 8:if(""!=this.storeGroup.id){t.next=13;break}return this.loading=!1,this.$message.destroy(),this.$message.warning("请选择门店分组"),t.abrupt("return",!1);case 13:return t.next=15,this.axios.post("auth-store/add-store",{id:this.editId,corp_id:this.corpId,group_id:this.storeGroup.id,shop_name:this.storeName,address:this.addressName,uid:localStorage.getItem("uid"),lat:this.lat,lng:this.lng});case 15:e=t.sent,a=e.data,0!=a.error?(this.loading=!1,this.$message.destroy(),this.$message.error(a.error_msg)):(this.loading=!1,this.cancelUpdate(),this.$refs.group.updateCount(a.old_pid,a.new_pid),this.getStoreList());case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),selectGroup:function(){this.visible=!1,this.groupVisible=!0},changeGroupId:function(t,e,a){"ok"==t&&(this.storeGroup={id:e,title:a}),this.visible=!0,this.groupVisible=!1},handleSearch:function(t){this.name=t,this.index=[];var e=this;this.searchInter&&clearTimeout(this.searchInter),this.searchInter=setTimeout(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getAddressList();case 1:case"end":return t.stop()}}),t)}))),500)},getAddressList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=s.length>0&&void 0!==s[0]?s[0]:1,this.name||"0"===this.name){t.next=3;break}return t.abrupt("return",!1);case 3:return this.addrLoading=!0,t.next=6,O("https://apis.map.qq.com/ws/place/v1/suggestion?keyword="+this.name+"&page_size=15&page_index="+e+"&key=MIWBZ-ECBCD-RSK4W-PCPUC-G6ETT-MMFLL&get_poi=1&output=jsonp");case 6:a=t.sent,0==a.status?(this.address=1==e?a.data:this.address.concat(a.data),this.count=a.count,this.page=e,this.addrLoading=!1):(this.addrLoading=!1,this.$message.destroy(),this.$message.error(a.error_msg));case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),popScroll:function(t){var e=t.target;e.scrollTop+e.offsetHeight===e.scrollHeight&&this.address.length<this.count&&this.getAddressList(this.page+1)},handleChange:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.address[e],this.lat=a.location.lat,this.lng=a.location.lng,s=new TMap.LatLng(this.lat,this.lng),this.initMakert(s),t.next=7,O("https://apis.map.qq.com/ws/geocoder/v1/?location="+this.lat+","+this.lng+"&key=MIWBZ-ECBCD-RSK4W-PCPUC-G6ETT-MMFLL&get_poi=1&output=jsonp");case 7:i=t.sent,0==i.status&&(this.addressName=i.result.address+" - "+(i.result.formatted_addresses.recommend||i.result.formatted_addresses.rough),this.initInfoWindow(s,'<div style="height: 30px">'+i.result.address+'</div><div style="height: 30px">'+(i.result.formatted_addresses.recommend||i.result.formatted_addresses.rough)+"</div>")),this.map.setCenter(s),this.initMakert(s);case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),rowClassName:function(t,e){var a="dark-row";return e%2===0&&(a="light-row"),a},modalVisibleChange:function(t,e){this.selectedRowKeys=[],this.corpId=t,this.groupId=e,0==this.storeType?this.getStoreList():this.getUserList()},findStore:function(){this.getStoreList()},clearFind:function(){this.status="",this.searchName="",this.getStoreList()},getStoreList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:1,a=r.length>1&&void 0!==r[1]?r[1]:this.pageSize,this.isLoading=!0,t.next=5,this.axios.post("auth-store/get-store-list",{corp_id:this.corpId,group_id:this.groupId,uid:localStorage.getItem("uid"),status:this.status,search_name:this.searchName,page:e,page_size:a});case 5:s=t.sent,i=s.data,0!=i.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(i.error_msg),this.confirmLoading=!1):(this.storeList=i.data.data,this.storeIds=i.data.store_ids,this.setCheckedBox(this.storeList),this.isLoading=!1,this.total=parseInt(i.data.count),this.page=e,this.pageSize=a,this.quickJumper=this.total>this.pageSize);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),releaseFollow:function(){var t=this;t.$confirm({title:"确定开启选中的门店?",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){t.isLoading=!0,t.changeStatus(1,t.selectedRowKeys)}})},failure:function(){var t=this;t.$confirm({title:"确定关闭选中的门店?",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){t.isLoading=!0,t.changeStatus(0,t.selectedRowKeys)}})},changeStore:function(t,e,a){e=(parseInt(e)+1)%2;var s=this,i="开启";0==e&&(i="关闭"),s.$confirm({title:"确定"+i+"选中的门店【"+a+"】?",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){s.isLoading=!0;var a=[];a.push(t),s.changeStatus(e,a)}})},changeStatus:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/close-store",{corp_id:this.corpId,store_id:a,status:e});case 2:s=t.sent,i=s.data,0!=i.error?(this.$message.destroy(),this.$message.error(i.error_msg)):(this.selectedRowKeys=[],r="",0==e?(r="关闭成功",this.getStoreList(this.page,this.pageSize)):1==e&&(r="开启成功",this.getStoreList(this.page,this.pageSize)),this.$message.destroy(),this.$message.success(r));case 5:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),delStore:function(t,e){var a=this;a.$confirm({title:"确定删除选中的门店【"+e+"】?",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){a.delOneStore(t)}})},delOneStore:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/store-del",{uid:localStorage.getItem("uid"),corp_id:this.corpId,store_id:e});case 2:a=t.sent,s=a.data,0!=s.error?(this.$message.destroy(),this.$message.error(s.error_msg)):(this.selectedRowKeys=[],this.$message.destroy(),this.$message.success("删除成功"),this.$refs.group.updateCount(s.old_pid),this.getStoreList());case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),addEmployee:function(t){this.storeAdd=1,this.storeIds=[t],this.transfer=0,this.showModalDepartment=!0},qrLoad:function(t){var e=this.$store.state.commonUrl+t,a=this,s=new Image,i=e.split("/"),r="qc.png";i.length>0&&(r=i[i.length-1]),s.setAttribute("crossOrigin","anonymous"),s.src=e,s.onload=function(){var t=document.createElement("canvas");t.width=200,t.height=200;var e=t.getContext("2d");e.drawImage(s,0,0,200,200),t.toBlob((function(t){var e=URL.createObjectURL(t);a.download(e,r),URL.revokeObjectURL(e)}))}},download:function(t,e){var a=document.createElement("a");a.download=e,a.href=t,a.click(),a.remove()},changePage:function(t,e){this.getStoreList(t,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,140)}))},showSizeChange:function(t,e){this.getStoreList(1,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,140)}))},importExcel:function(){this.file_name="",this.fileInfo={},this.tag_arr3=[],this.isShowTag=!0,this.upLoadShowModal=!0},beforeUpload:function(t){var e=".xls"===t.name.substr(t.name.lastIndexOf(".")).toLowerCase(),a=".xlsx"===t.name.substr(t.name.lastIndexOf(".")).toLowerCase(),s=t.size/1024/1024<5;if(e||a){if(s)return this.fileInfo=t,this.file_name=t.name,!1;this.$message.warning("上传模板大小不能超过 5MB!")}else this.$message.warning("上传模板只能是 xls、xlsx格式!")},closeExcel:function(){this.fileInfo={},this.file_name=""},upLoadHandleOk:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.modalLoading=!0,this.progressFlag=!1,"{}"!=JSON.stringify(this.fileInfo)){t.next=6;break}return this.$message.error("请选择上传Excel"),this.modalLoading=!1,t.abrupt("return",!1);case 6:return this.$message.info("已进入后台导入中，请耐心等待..."),this.progressNum=0,this.successNum=0,this.failNum=0,this.notImportNum=0,this.upLoadShowModal=!1,this.progressVisible=!0,this.leftSiderWidth=document.getElementsByClassName("menu-sider")[0].style.width,this.$nextTick((function(){document.getElementsByClassName("mask-dialog")[0].style.left=document.getElementsByClassName("menu-sider")[0].style.width})),e=new FormData,e.append("uid",localStorage.getItem("uid")),e.append("corp_id",this.corpId),e.append("importFile",this.fileInfo),t.next=21,this.axios.post("auth-store/exec-l-add-store",e);case 21:a=t.sent,s=a.data,0!=s.error?(this.modalLoading=!1,this.progressVisible=!1,this.$message.error(s.error_msg)):this.modalLoading=!1;case 24:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),upLoadHandleCancel:function(){this.fileInfo={},this.file_name="",this.tag_arr3=[],this.isShowTag=!1,this.modalLoading=!1,this.upLoadShowModal=!1},websocketOnMessage:function(t){if("undefined"!=typeof t.type&&"export_store_sort"==t.type&&this.$refs.group.otherUserMove(t.group_id,t.parentId,t.sort),"undefined"!=typeof t.type&&"export_store_add"==t.type){if(this.progressVisible=!0,this.leftSiderWidth=document.getElementsByClassName("menu-sider")[0].style.width,this.$nextTick((function(){document.getElementsByClassName("mask-dialog")[0].style.left=document.getElementsByClassName("menu-sider")[0].style.width})),1==t.hair){var e=Object.keys(t.pid_all);if(0!=e.length){var a=[];for(var s in e)a.push(t.pid_all[s]);this.$refs.group.updateCount([],a)}}this.failMsg=t.error_msg,this.successNum=t.success,this.failNum=t.error,this.notImportNum=t.num-t.success-t.error,this.progressNum=parseInt((t.success+t.error)/t.num*100),100==this.progressNum&&(this.progressFlag=!0)}},cancelProgress:function(){this.getStoreList(),this.progressVisible=!1},changeSelectKey:function(t){for(var e=0;e<this.selectedRowKeys.length;e++)if(t==this.selectedRowKeys[e])return this.selectedRowKeys.splice(e,1),this.setCheckedBox(this.storeList),!1;this.selectedRowKeys.push(t),this.setCheckedBox(this.storeList)},batchTypeChange:function(){this.batchTypeValue?(0==this.batchType?this.removeKey(this.storeList):1==this.batchType&&(this.selectedRowKeys=[]),this.setCheckedBox(this.storeList),this.batchTypeValue=!1):(0==this.batchType?this.addKey(this.storeList):1==this.batchType&&(this.selectedRowKeys=JSON.parse(JSON.stringify(this.storeIds))),this.setCheckedBox(this.storeList),this.batchTypeValue=!0)},setCheckedBox:function(t){this.checkBoxValue=new Array(t.length),this.checkBoxValue.fill(!1);for(var e=0;e<t.length;e++)for(var a=0;a<this.selectedRowKeys.length;a++)t[e].id==this.selectedRowKeys[a]&&(this.checkBoxValue[e]=!0);if(0==this.batchType){this.batchTypeValue=!0;for(var s=0;s<this.checkBoxValue.length;s++)this.checkBoxValue[s]||(this.batchTypeValue=!1)}else this.selectedRowKeys.length==this.storeIds.length&&0!=this.storeIds.length?this.batchTypeValue=!0:this.batchTypeValue=!1;0==t.length&&(this.batchTypeValue=!1)},changeBatchType:function(t){this.batchType=t,this.batchTypeValue?(0==this.batchType&&(this.selectedRowKeys=[]),this.batchTypeValue=!1,this.batchTypeChange()):this.setCheckedBox(this.storeList)},addKey:function(t){for(var e=this,a=function(a){var s=e.selectedRowKeys.findIndex((function(e){return e===t[a].id}));-1==s&&e.selectedRowKeys.push(t[a].id)},s=0;s<t.length;s++)a(s)},removeKey:function(t){for(var e=this,a=function(a){var s=e.selectedRowKeys.findIndex((function(e){return e===t[a].id}));-1!=s&&e.selectedRowKeys.splice(s,1)},s=0;s<t.length;s++)a(s)},findUser:function(){this.getUserList()},clear:function(){this.searchName1="",this.getUserList()},changeUser:function(t,e,a,s,i){this.userTitle="转移成员",this.transfer=1,this.userName=s,this.checkedList=[a],this.editIds=[t],this.chooseNum=0,this.chooseUserNum=0,this.storeIds=[],this.storeDetail=[],this.userVisible=!0},deleteOneUser:function(t,e,a,s,i){var r=this;r.$confirm({title:"确定将成员【"+s+"】从门店【"+i+"】中移除?",okText:"确定",okType:"primary",cancelText:"取消",onOk:function(){r.isLoading=!0;var s=[];s.push(a);var i=[];i.push(e),r.deleteUser(t,i,s)}})},deleteUser:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/add-store-user",{uid:localStorage.getItem("uid"),corp_id:this.corpId,store_id:a,user_ids:s,ids:[e],is_del:1});case 2:i=t.sent,r=i.data,0!=r.error?(this.$message.destroy(),this.$message.error(r.error_msg)):(this.$refs.userGroup.updateBatchDelCount(r.data),this.getUserList());case 5:case"end":return t.stop()}}),t,this)})));function e(e,a,s){return t.apply(this,arguments)}return e}(),addUser:function(){this.userTitle="添加门店成员",this.checkedList=[],this.chooseNum=0,this.chooseUserNum=0,this.storeIds=[],this.storeDetail=[],this.userVisible=!0},cancelUser:function(){this.userVisible=!1,this.transfer=0,this.userName="",this.checkedList=[],this.editIds=[],this.chooseNum=0,this.chooseUserNum=0,this.storeIds=[],this.storeDetail=[],this.userTitle="添加门店成员",this.storeAdd=0},updateUser:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.loading=!0,0!=this.chooseNum||0!=this.transfer){t.next=8;break}return this.loading=!1,this.$message.destroy(),this.$message.warning("请选择成员"),t.abrupt("return",!1);case 8:if(0!=this.storeIds.length){t.next=13;break}return this.loading=!1,this.$message.destroy(),this.$message.warning("请选择门店"),t.abrupt("return",!1);case 13:if(e=[],0==this.transfer)for(a=0;a<this.checkedList.length;a++)e.push(this.checkedList[a].id);else e=this.checkedList;return t.next=17,this.axios.post("auth-store/add-store-user",{uid:localStorage.getItem("uid"),corp_id:this.corpId,store_id:this.storeIds,user_ids:e,transfer:this.transfer,ids:this.editIds});case 17:s=t.sent,i=s.data,0!=i.error?(this.$message.destroy(),this.$message.error(i.error_msg)):(this.loading=!1,i.data.length>0?1==this.storeAdd?this.getStoreList():(0==this.transfer?this.$refs.userGroup.updateBatchAddCount(i.data):this.$refs.userGroup.updateBatchMoveCount(i.data),this.getUserList(),this.cancelUser()):(this.$message.destroy(),this.$message.warning("该门店下已有该成员")),1==this.storeAdd&&(this.$refs.user.rightIdList=[],this.$refs.user.rightList=[],this.cancelUser()));case 20:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),showDepartmentList:function(){this.showModalDepartment=!0;var t=[];this.checkedList.map((function(e){t.push(e.id)})),this.$refs.user.rightIdList=JSON.parse(JSON.stringify(t)),this.$refs.user.rightList=JSON.parse(JSON.stringify(this.checkedList))},modalVisibleChange3:function(t,e,a,s,i){"ok"==t?(this.chooseNum=parseInt(a)+parseInt(s),this.chooseUserNum=a,this.chooseNum>0?this.checkedList=JSON.parse(JSON.stringify(i)):this.checkedList=[],1==this.storeAdd&&this.updateUser(),this.showModalDepartment=!1):this.showModalDepartment=!1},clearDepartmentList:function(){this.checkedList=[],this.chooseNum=0,this.chooseUserNum=0},clearStoreList:function(){this.storeIds=[],this.storeDetail=[]},showStoreModal:function(){this.userVisible=!1,this.storeVisible=!0},setGroupId:function(t,e,a){"ok"==t&&(this.storeIds=JSON.parse(JSON.stringify(e)),this.storeDetail=JSON.parse(JSON.stringify(a))),this.userVisible=!0,this.storeVisible=!1},getUserList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:1,a=r.length>1&&void 0!==r[1]?r[1]:this.pageSize1,this.isLoading=!0,t.next=5,this.axios.post("auth-store/get-group-user-list",{corp_id:this.corpId,id:this.groupId,uid:localStorage.getItem("uid"),search_name:this.searchName1,page:e,page_size:a});case 5:s=t.sent,i=s.data,0!=i.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(i.error_msg),this.confirmLoading=!1):(this.userList=i.data.data,this.isLoading=!1,this.total1=parseInt(i.data.count),this.page1=e,this.pageSize1=a,this.quickJumper=this.total>this.pageSize);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changePage1:function(t,e){this.getUserList(t,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,140)}))},showSizeChange1:function(t,e){this.getUserList(1,e),this.$nextTick((function(){document.getElementsByClassName("scroll")[0].scrollTo(0,140)}))},getStoreStatus:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/get-store-status",{corp_id:localStorage.getItem("corpId"),status:e});case 2:a=t.sent,s=a.data,0!=s.error?(this.$message.destroy(),this.$message.error(s.error_msg)):this.storeStatus=s.data.status;case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeStoreStatus:function(){this.getStoreStatus((this.storeStatus+1)%2)}},mounted:function(){var t=this;if(2==localStorage.getItem("isMasterAccount")){var e=localStorage.getItem("permissionButton").split(","),a=this;-1!=e.indexOf("storeList-staff-list")?a.storeType=1:-1!=e.indexOf("storeList-manage-list")&&(a.storeType=0),-1!=e.indexOf("storeList-manage-status")?a.disableOpen=!1:a.disableOpen=!0,a.$forceUpdate()}else t.storeType=1;this.ws.setCallback(this.websocketOnMessage)}},M=j,R=(a("bb7d"),Object(p["a"])(M,s,i,!1,null,"ced30060",null));e["default"]=R.exports},"19be":function(t,e){t.exports="data:image/gif;base64,R0lGODlhagAgAKIGAPb4/Ozx+MfW6pCt1kZ2u////wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjM3MjIyN0VCRDUwMTFFNkJBMTVEOEEwNDNEQ0JCMTUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjM3MjIyN0ZCRDUwMTFFNkJBMTVEOEEwNDNEQ0JCMTUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2MzcyMjI3Q0JENTAxMUU2QkExNUQ4QTA0M0RDQkIxNSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2MzcyMjI3REJENTAxMUU2QkExNUQ4QTA0M0RDQkIxNSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAUeAAYALAAAAABqACAAAANQWLrc/jDKSau9OOvNu/9gKI5kaZ5oqq5s675wLM90bd94ru9870OAoDD4mw2HRdlRmIwtic3XExCVPquuKbal3Xq/4LB4TC6bz+i0es1mJQAAIfkEBR4ABgAsHQAOAAgACAAAAwgYutz+MMqYAAAh+QQFHgAGACwxAA4ACAAIAAADCCi63P4wypgAACH5BAUeAAYALEUADgAIAAgAAAMIOLrc/jDKmAAAIfkEBR4ABgAsWQAOAAgACAAAAwhIutz+MMqYAAAh+QQFHgAGACwJAA4AWAAIAAADGli63P4wykmrvTjrzbv/YCiOZGmeaKqubFskADs="},"36bd":function(t,e,a){"use strict";var s=a("4bf8"),i=a("77f1"),r=a("9def");t.exports=function(t){var e=s(this),a=r(e.length),o=arguments.length,n=i(o>1?arguments[1]:void 0,a),l=o>2?arguments[2]:void 0,c=void 0===l?a:i(l,a);while(c>n)e[n++]=t;return e}},"3f05":function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".store-team[data-v-72159ea4]{height:calc(100% - 50px)}.user-team[data-v-72159ea4]{padding-top:17px}.group-tree1[data-v-72159ea4] .ant-spin-container,.group-tree1[data-v-72159ea4] .ant-spin-nested-loading,.user-team[data-v-72159ea4]{height:100%}.tab[data-v-72159ea4]{width:50%;display:inline-block;text-align:center;height:40px;line-height:40px}.active[data-v-72159ea4]{color:#1890ff}.team-add[data-v-72159ea4]{width:100%;height:50px;line-height:50px}.team-add-icon[data-v-72159ea4],.team-add-title[data-v-72159ea4]{display:inline-block;margin-left:10px}.team-add-icon[data-v-72159ea4]{color:#1e90ff;cursor:pointer;vertical-align:initial}[data-v-72159ea4] .ant-tree-node-content-wrapper{display:inline-block;width:calc(100% - 25px)}[data-v-72159ea4] .ant-tree-switcher-icon{vertical-align:initial}[data-v-72159ea4] .ant-tree-node-content-wrapper.ant-tree-node-selected{background-color:#fff!important}[data-v-72159ea4] .ant-popover-inner .ant-popover-inner-content .ant-popover-buttons{display:none!important}.more-operation[data-v-72159ea4]:hover{color:#1890ff}[data-v-72159ea4] .ant-tree li .ant-tree-node-content-wrapper:hover{background-color:#fff}.ant-tree li span[draggable=true][data-v-72159ea4],[data-v-72159ea4] .ant-tree li span[draggable]{line-height:25px;height:30px}[data-v-72159ea4] .ant-tree li span.ant-tree-switcher{vertical-align:sub}.operation[data-v-72159ea4]{margin-bottom:8px;cursor:pointer}.operation2[data-v-72159ea4]{margin-bottom:0;cursor:pointer}.operation1[data-v-72159ea4]{margin-bottom:0;color:#e2e2e2}.operation[data-v-72159ea4]:hover{color:#1890ff}",""])},4926:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".tab[data-v-637129e4]{width:50%;display:inline-block;text-align:center;height:40px;line-height:40px}.active[data-v-637129e4]{background-color:#1890ff;color:#fff}.team-add[data-v-637129e4]{width:100%;height:50px;line-height:50px}.team-add-icon[data-v-637129e4],.team-add-title[data-v-637129e4]{display:inline-block;margin-left:10px}.team-add-icon[data-v-637129e4]{color:#1e90ff;cursor:pointer;vertical-align:initial}[data-v-637129e4] .ant-tree-node-content-wrapper{display:inline-block;width:calc(100% - 25px)}[data-v-637129e4] .ant-tree-switcher-icon{vertical-align:initial}[data-v-637129e4] .ant-tree-node-content-wrapper.ant-tree-node-selected{background-color:#fff!important}[data-v-637129e4] .ant-popover-inner .ant-popover-inner-content .ant-popover-buttons{display:none!important}.more-operation[data-v-637129e4]:hover{color:#1890ff}[data-v-637129e4] .ant-tree li .ant-tree-node-content-wrapper:hover{background-color:#fff}.ant-tree li span[draggable=true][data-v-637129e4],[data-v-637129e4] .ant-tree li span[draggable]{line-height:25px;height:30px}[data-v-637129e4] .ant-tree li span.ant-tree-switcher{vertical-align:sub}.operation[data-v-637129e4]{margin-bottom:8px;cursor:pointer}.operation2[data-v-637129e4]{margin-bottom:0;cursor:pointer}.operation1[data-v-637129e4]{margin-bottom:0;color:#e2e2e2}.operation[data-v-637129e4]:hover{color:#1890ff}[data-v-637129e4] li.ant-tree-treenode-disabled>.ant-tree-node-content-wrapper span{color:rgba(0,0,0,.65)!important}.store-list[data-v-637129e4]{max-width:350px;margin-top:10px}.store-item[data-v-637129e4]{margin:5px 0;cursor:pointer}.store-spin[data-v-637129e4]{position:fixed;margin-top:140px;margin-left:160px;z-index:9999}.spin-zhezhao[data-v-637129e4]{position:fixed;z-index:999;width:417px;height:350px;margin-top:-10px;background-color:rgba(0,0,0,.04)}",""])},"4bef":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAABAElEQVR42s3VIY7CUBAG4LkEliC4xKJ6BA6AognXQBLCAVBYNBK3pim7zP8XBAJHSLhAZVURi+jC2+681xD4R89nZiYjIhojQRlQicYiolFQ8600EqZNAKbSpB0lyqcCBeYccIA5ihDgtO3JLdseTr7Ap9wFRx+g2HTuge8PH+AsjuBiBzZO4MsOHJzAwQ7kTiD3mcLsoX3muQcaV9s1DtnENUfssssR1i+6hRcD3GPFBaeccoEV9z7AUodoP4yxrUMs/wd26EtN0MeuBuBYDOH4LyDPWhYga1WXugpMxBhMnIBGVqD6S34B9nqvTUwaAUnNpZue689/DnuwTDUSuQJ1pL7YQ6lKkQAAAABJRU5ErkJggg=="},"53ba":function(t,e,a){"use strict";var s=a("5bee"),i=a.n(s);i.a},"5bee":function(t,e,a){var s=a("3f05");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("499e").default;i("025a2efd",s,!0,{sourceMap:!1,shadowMode:!1})},6215:function(t,e,a){var s=a("9ebf");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("499e").default;i("23c736e8",s,!0,{sourceMap:!1,shadowMode:!1})},"68a1":function(t,e,a){var s=a("4926");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("499e").default;i("261dc6ec",s,!0,{sourceMap:!1,shadowMode:!1})},"69f5":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAQAAABuvaSwAAAAY0lEQVR42r2SQQ1AIQxDkYIEJCFlacMdR+CIOeAnYKAkH7brO7x1DeHplFSSiLJycrJq8Nyrwb5gF43R0WXrW4OMgYF8cCDG/2kg0+mixs0asbGJTzlL46hItmATrS1afJvTB40bQb8Be38ZAAAAAElFTkSuQmCC"},"6c7b":function(t,e,a){var s=a("5ca1");s(s.P,"Array",{fill:a("36bd")}),a("9c6c")("fill")},7528:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.visible?a("a-modal",{attrs:{width:"888px!important",title:"选择门店"},on:{cancel:t.cancelGroup},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("template",{slot:"footer"},[a("a-button",{key:"back",on:{click:t.cancelGroup}},[t._v("取消")]),a("a-button",{key:"submit",attrs:{type:"primary"},on:{click:t.updateGroup}},[t._v("确定\n\t\t\t")])],1),a("div",{staticStyle:{display:"inline-block","border-right":"1px solid #E2E2E2",width:"50%"}},[a("a-input",{staticStyle:{width:"230px",display:"block"},attrs:{placeholder:"请输入门店名称或地址进行查找"},on:{input:t.selectStore},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}}),a("div",{staticClass:"group-tree2",staticStyle:{height:"350px",overflow:"auto"},on:{scroll:t.handleScroll}},[a("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.searchName,expression:"searchName != ''"}],staticClass:"store-list"},[a("a-empty",{directives:[{name:"show",rawName:"v-show",value:0==t.storeList.length&&!t.isLoading,expression:"storeList.length == 0 && !isLoading"}]}),a("a-spin",{staticClass:"store-spin",attrs:{tip:"Loading...",spinning:t.isLoading}}),t.isLoading?a("div",{staticClass:"spin-zhezhao"}):t._e(),t._l(t.storeList,(function(e){return a("div",{staticClass:"store-item",on:{click:function(a){return t.selectId(e.id+"-s",e.shop_name,e.status)}}},[t._v("\n\t\t\t\t\t\t"+t._s(e.shop_name)),0==e.status?[t._v("（门店已关闭）")]:t._e(),a("span",{staticStyle:{color:"rgba(0, 0, 0, 0.3)"}},[t._v("（"+t._s(e.name)+"）")]),t.ids.includes(e.id+"-s")?a("a-icon",{staticStyle:{color:"#1890FF","margin-left":"10px"},attrs:{type:"check"}}):t._e()],2)}))],2),""==t.searchName?a("a-tree",{staticClass:"draggable-tree",attrs:{treeData:t.gData,"load-data":t.onLoadData},on:{select:t.onselect},scopedSlots:t._u([{key:"custom",fn:function(e){var s=e.title,i=e.count,r=e.key,o=e.store;return[t._v("\n\t\t\t\t\t\t"+t._s(s)),o?t._e():[t._v("（"+t._s(i)+"）")],t.ids.includes(r)?a("a-icon",{staticStyle:{color:"#1890FF","margin-left":"10px"},attrs:{type:"check"}}):t._e()]}}],null,!1,3951647589)}):t._e()],1)],1),a("div",{staticStyle:{display:"inline-block",width:"calc(50% - 5px)",height:"390px",overflow:"auto",padding:"4px 20px 10px 20px"}},[t._v("\n\t\t\t已选择的门店\n\t\t\t"),t._l(t.stores,(function(e,s){return a("div",{staticStyle:{margin:"10px 0"}},[t._v("\n\t\t\t\t"+t._s(e.title)+"\n\t\t\t\t"),a("a-icon",{staticStyle:{cursor:"pointer","margin-left":"5px",color:"rgba(0, 0, 0, 0.65)",float:"right"},attrs:{type:"close"},on:{click:function(e){return t.deleteStore(s)}}})],1)}))],2)],2):t._e()],1)},i=[],r=(a("20d6"),a("75fc")),o=(a("ac6a"),a("5df3"),a("96cf"),a("3b8d")),n={name:"Team",props:{groupVisible:{type:Boolean,default:!1},storeIds:{type:Array,default:function(){return[]}},storeDetail:{type:Array,default:function(){return[]}}},watch:{storeIds:function(t,e){this.ids=t},storeDetail:function(t,e){this.stores=t},groupVisible:function(t,e){this.visible=t,this.visible&&this.getGroupList()}},data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{corpId:t,searchName:"",ids:"",stores:[],gData:[],groupData:[],visible:!1,timeInter:0,isLoading:!1,storeList:[],page:1,count:0}},mounted:function(){this.ids=this.storeIds,this.stores=this.storeDetail,this.visible=this.groupVisible,this.getGroupList()},methods:{handleScroll:function(){if(""!=this.searchName&&!this.isLoading){var t=document.getElementsByClassName("group-tree2")[0],e=t.scrollTop,a=t.clientHeight,s=t.scrollHeight;e+a==s&&this.count>this.storeList.length&&(this.isLoading=!0,this.selectStoreList(this.page+1))}},selectStore:function(t){""==t.val&&(this.storeList=[],this.page=1),clearTimeout(this.timeInter),this.timeInter=setTimeout(this.selectStoreList,500)},selectStoreList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:1,this.isLoading=!0,t.next=4,this.axios.post("auth-store/get-store-list",{corp_id:this.corpId,group_id:"",uid:localStorage.getItem("uid"),status:"",search_name:this.searchName,page:e,page_size:20});case 4:a=t.sent,s=a.data,0!=s.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(s.error_msg)):(1==e?(this.storeList=s.data.data,this.count=parseInt(s.data.count)):this.storeList=JSON.parse(JSON.stringify(this.storeList.concat(s.data.data))),this.page=e,this.isLoading=!1);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),cancelGroup:function(){this.searchName="",this.page=1,this.count=0,this.storeList=[],this.$emit("setGroupId","cancle")},updateGroup:function(){this.searchName="",this.page=1,this.count=0,this.storeList=[],this.$emit("setGroupId","ok",this.ids,this.stores)},onLoadData:function(t){var e=this;return new Promise((function(a){Promise.all([e.getGroupList(t.dataRef.key)]).then((function(s){t.dataRef.children=e.groupData;e.gData;e.gData=Object(r["a"])(e.gData),a()})).catch((function(t){}))}))},loopObjByKey:function(t,e,a){var s=this;t.forEach((function(t){return t.key==e?a(t):t.children&&t.children.length>0&&!t.isLeaf?s.loopObjByKey(t.children,e,a):void 0}))},getGroupList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("auth-store/get-group-list",{uid:localStorage.getItem("uid"),corp_id:this.corpId,parent_id:e||"",store:2,choose:1,status:1});case 2:a=t.sent,s=a.data,0!=s.error?(this.isLoading=!1,this.$message.destroy(),this.$message.error(s.error_msg)):(e?this.groupData=s.data.data:this.gData=s.data.data,this.isLoading=!1);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),selectId:function(t,e,a){if(0==a)return!1;var s=this.ids.findIndex((function(e){return e==t}));if(s>-1)this.ids.splice(s,1),this.stores.splice(s,1);else{this.ids.push(t);var i={id:t,title:e};this.stores.push(i)}},onselect:function(t,e){if(t.length>0&&this.id!=t[0]){var a=this.ids.findIndex((function(e){return e==t[0]}));if(a>-1)this.ids.splice(a,1),this.stores.splice(a,1);else{this.ids.push(t[0]);var s=this,i={id:t[0],title:e.node.dataRef.title};s.stores.push(i)}}},deleteStore:function(t){this.ids.splice(t,1),this.stores.splice(t,1)}}},l=n,c=(a("7a21"),a("2877")),d=Object(c["a"])(l,s,i,!1,null,"637129e4",null);e["a"]=d.exports},"7a21":function(t,e,a){"use strict";var s=a("68a1"),i=a.n(s);i.a},"8e18":function(t,e,a){"use strict";var s=a("dd64"),i=a.n(s);i.a},"9ebf":function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".content-msg[data-v-ced30060]{min-width:845px;width:calc(100% - 25px);border:1px solid #ffdda6;background:#fff2db;padding:10px;text-align:left;margin-bottom:20px}.tabBtn[data-v-ced30060]{margin:0;width:125px;height:38px;line-height:38px;text-align:center;display:inline-block;background:#fafafa;border:1px solid #e8e8e8;border-bottom:0;border-radius:4px 4px 0 0;cursor:pointer}.activeBtn[data-v-ced30060]{color:#1890ff;background:#fff}[data-v-ced30060] #map a,[data-v-ced30060] .logo-text{display:none!important}.wx-info[data-v-ced30060]{width:100%;position:absolute;left:0;top:100px;bottom:0;overflow:hidden}.wx-info[data-v-ced30060]::-webkit-scrollbar{width:2px;height:100%}.wx-info[data-v-ced30060]::-webkit-scrollbar-track-piece{background-color:#fff}.wx-info[data-v-ced30060]::-webkit-scrollbar-thumb{background:#fff}#components-layout-demo-basic[data-v-ced30060]{height:100%}#components-layout-demo-basic .ant-layout-header[data-v-ced30060]{background:#fff;border-bottom:1px solid #e2e2e2;height:50px;min-width:885px;width:100%;line-height:50px}[data-v-ced30060] .ant-layout-header{padding:0 20px;font-size:16px;text-align:left}#components-layout-demo-basic .ant-layout-sider[data-v-ced30060]{background:#fff;-webkit-box-flex:0!important;-ms-flex:0 0 250px!important;flex:0 0 250px!important;max-width:250px!important;min-width:250px!important;width:250px!important;border-right:1px solid #e2e2e2}#components-layout-demo-basic .ant-layout-content[data-v-ced30060]{margin:0 20px 20px;min-width:885px;width:100%;padding-right:40px}.content-hd[data-v-ced30060]{height:50px;width:100%;min-width:885px}.msg-info[data-v-ced30060]{color:#ffdda6;margin-right:10px}.content-bd[data-v-ced30060]{background:#fff;min-height:120px;min-width:885px;width:100%;border:1px solid rgba(0,0,0,.05);border-bottom:0}#components-layout-demo-basic>.ant-layout[data-v-ced30060]{margin-bottom:48px}#components-layout-demo-basic>.ant-layout[data-v-ced30060]:last-child{margin:0}.ant-layout.ant-layout-has-sider[data-v-ced30060],.list[data-v-ced30060]{height:100%}.content-hd-left[data-v-ced30060]{float:left}.content-hd-right[data-v-ced30060]{float:right}.btn-primary[data-v-ced30060]{margin-left:10px}.sider-one[data-v-ced30060]{padding:0 20px}.sider-one-txt[data-v-ced30060]{height:60px;line-height:60px;text-align:left}.selectWx[data-v-ced30060]{width:200px;margin-left:20px;height:50px;line-height:50px;cursor:pointer;padding-left:10px}.active[data-v-ced30060]{background:#1e90ff;color:#fff}.tag-name[data-v-ced30060]{padding:6px 14px;height:34px;font-size:13px;border:1px solid #d9d9d9;background-color:transparent!important;color:rgba(0,0,0,.65)}[data-v-ced30060] .dark-row{background:#fafafa}[data-v-ced30060] .light-row{background:#fff}[data-v-ced30060] .ant-radio-button-wrapper{width:200px;height:55px;line-height:47px;padding:0 10px;margin:10px 5px}[data-v-ced30060] .wxtpl .ant-radio-button-wrapper-checked{border:2px solid #1890ff!important}[data-v-ced30060] .ant-dropdown-trigger>.anticon.anticon-down{font-size:14px;color:#000}[data-v-ced30060] .ant-table-tbody>tr>td,[data-v-ced30060] .ant-table-thead>tr>th{border-bottom:1px solid rgba(0,0,0,.02)}[data-v-ced30060] .ant-table table{-webkit-box-shadow:none!important;box-shadow:none!important}",""])},bb7d:function(t,e,a){"use strict";var s=a("6215"),i=a.n(s);i.a},dd64:function(t,e,a){var s=a("ff0e");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=a("499e").default;i("6f8e21c0",s,!0,{sourceMap:!1,shadowMode:!1})},ff0e:function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,".tab[data-v-5ab7a68e]{width:50%;display:inline-block;text-align:center;height:40px;line-height:40px}.active[data-v-5ab7a68e]{color:#1890ff}.team-add[data-v-5ab7a68e]{width:100%;height:50px;line-height:50px}.team-add-icon[data-v-5ab7a68e],.team-add-title[data-v-5ab7a68e]{display:inline-block;margin-left:10px}.team-add-icon[data-v-5ab7a68e]{color:#1e90ff;cursor:pointer;vertical-align:initial}[data-v-5ab7a68e] .ant-tree-node-content-wrapper{display:inline-block;width:calc(100% - 25px)}[data-v-5ab7a68e] .ant-tree-switcher-icon{vertical-align:initial}[data-v-5ab7a68e] .ant-tree-node-content-wrapper.ant-tree-node-selected{background-color:#fff!important}[data-v-5ab7a68e] .ant-popover-inner .ant-popover-inner-content .ant-popover-buttons{display:none!important}.more-operation[data-v-5ab7a68e]:hover{color:#1890ff}[data-v-5ab7a68e] .ant-tree li .ant-tree-node-content-wrapper:hover{background-color:#fff}.ant-tree li span[draggable=true][data-v-5ab7a68e],[data-v-5ab7a68e] .ant-tree li span[draggable]{line-height:25px;height:30px}[data-v-5ab7a68e] .ant-tree li span.ant-tree-switcher{vertical-align:sub}.operation[data-v-5ab7a68e]{margin-bottom:8px;cursor:pointer}.operation2[data-v-5ab7a68e]{margin-bottom:0;cursor:pointer}.operation1[data-v-5ab7a68e]{margin-bottom:0;color:#e2e2e2}.operation[data-v-5ab7a68e]:hover{color:#1890ff}[data-v-5ab7a68e] li.ant-tree-treenode-disabled>.ant-tree-node-content-wrapper span{color:rgba(0,0,0,.65)!important}",""])}}]);