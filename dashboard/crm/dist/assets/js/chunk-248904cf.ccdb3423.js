(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-248904cf"],{"07ce":function(t,i,e){"use strict";var a=e("6161"),s=e.n(a);s.a},"20d6":function(t,i,e){"use strict";var a=e("5ca1"),s=e("0a49")(6),n="findIndex",o=!0;n in[]&&Array(1)[n]((function(){o=!1})),a(a.P+a.F*o,"Array",{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),e("9c6c")(n)},"241a":function(t,i,e){i=t.exports=e("2350")(!1),i.push([t.i,".preview-modal .ant-carousel .slick-slide{text-align:center;height:auto;overflow:hidden}.preview-modal .ant-carousel .custom-slick-arrow{width:50px;height:50px;font-size:50px;color:#545454!important;opacity:.3}.preview-modal .ant-carousel .custom-slick-arrow:before{display:none}.preview-modal .ant-carousel .custom-slick-arrow:hover{opacity:.5}@-webkit-keyframes voiceRun1{0%{border-color:transparent}25%{border-color:transparent}50%{border-color:transparent}75%{border-color:#2390ff}to{border-color:transparent}}@keyframes voiceRun1{0%{border-color:transparent}25%{border-color:transparent}50%{border-color:transparent}75%{border-color:#2390ff}to{border-color:transparent}}@-webkit-keyframes voiceRun2{0%{border-color:transparent}25%{border-color:transparent}50%{border-color:#2390ff}75%{border-color:#2390ff}to{border-color:transparent}}@keyframes voiceRun2{0%{border-color:transparent}25%{border-color:transparent}50%{border-color:#2390ff}75%{border-color:#2390ff}to{border-color:transparent}}@-webkit-keyframes voiceRun3{0%{background:#2390ff;border-color:#2390ff}25%{background:#2390ff;border-color:#2390ff}50%{background:#2390ff;border-color:#2390ff}75%{background:#2390ff;border-color:#2390ff}to{background:#2390ff;border-color:#2390ff}}@keyframes voiceRun3{0%{background:#2390ff;border-color:#2390ff}25%{background:#2390ff;border-color:#2390ff}50%{background:#2390ff;border-color:#2390ff}75%{background:#2390ff;border-color:#2390ff}to{background:#2390ff;border-color:#2390ff}}",""])},"460a":function(t,i,e){i=t.exports=e("2350")(!1),i.push([t.i,".content-bd[data-v-06db997b]{top:43px;left:0;right:0;bottom:0;position:absolute}.content-bd .msg-box[data-v-06db997b],.content-bd .msg-box[data-v-06db997b] .ant-spin-container{height:100%}.content-bd .msg-box .user-box[data-v-06db997b]{height:60px;padding:10px}.content-bd .msg-box .msg-type-box[data-v-06db997b]{height:40px;text-align:center}.content-bd .msg-box .msg-type-box .msg-type[data-v-06db997b]{height:40px;padding:5px 0;line-height:29px;cursor:pointer;border-bottom:1px solid #ececec}.content-bd .msg-box .msg-type-box .msg-type.msg-type-active[data-v-06db997b]{cursor:default;color:#1890ff;font-weight:700}.content-bd .msg-box .chat-list-box[data-v-06db997b]{top:150px;left:0;right:0;bottom:0;position:absolute;overflow-x:hidden;overflow-y:auto}.content-bd .msg-box .chat-list-box .chat-list[data-v-06db997b]{padding:10px;height:60px;border-bottom:1px solid #ececec;cursor:pointer}.content-bd .msg-box .chat-list-box .chat-list[data-v-06db997b]:hover{background-color:#fafafa;border-color:#f5f5f5;cursor:default}.content-bd .msg-box .chat-list-box .chat-list.chat-list-active[data-v-06db997b]{color:#fff;background-color:#1890ff;border-color:#1890ff;cursor:default}.content-bd .msg-box .chat-list-box .chat-list.chat-list-active .chat-right-content[data-v-06db997b]{color:#fff!important}.content-bd .msg-box .chat-list-box .chat-list .chat-left[data-v-06db997b]{float:left;width:40px;height:40px}.content-bd .msg-box .chat-list-box .chat-list .chat-left .chat-img[data-v-06db997b]{width:40px;height:40px}.content-bd .msg-box .chat-list-box .chat-list .chat-right[data-v-06db997b]{float:right;width:calc(100% - 50px);height:40px}.content-bd .msg-box .chat-list-box .chat-list .chat-right .chat-right-title[data-v-06db997b]{height:20px;padding-bottom:5px}.content-bd .msg-box .chat-list-box .chat-list .chat-right .chat-right-title .chat-name[data-v-06db997b]{float:left;height:20px;font-size:14px;line-height:20px;width:calc(100% - 40px);overflow:hidden}.content-bd .msg-box .chat-list-box .chat-list .chat-right .chat-right-title .chat-time[data-v-06db997b]{float:right;font-size:12px;line-height:20px;width:40px;height:20px;overflow:hidden}.content-bd .msg-box .chat-list-box .chat-list .chat-right .chat-right-content[data-v-06db997b]{color:#999;width:100%;height:20px;padding-top:5px}.content-bd .msg-box .chat-list-box .chat-list .chat-right .chat-right-content span[data-v-06db997b]{font-size:12px;height:15px;line-height:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.content-bd .msg-box .chat-info-box[data-v-06db997b]{height:100%}.content-bd .msg-box .chat-info-box .chat-info-title[data-v-06db997b]{padding:10px 10px;line-height:33px;height:53px;border-bottom:1px solid #ececec}.content-bd .msg-box .chat-info-box .chat-info-title .chat-info-name[data-v-06db997b]{display:inline-block;width:260px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.content-bd .msg-box .chat-info-box .chat-info-title .msg-type[data-v-06db997b]{cursor:pointer;text-align:center}.content-bd .msg-box .chat-info-box .chat-info-title .msg-type-active[data-v-06db997b]{color:#1890ff;font-weight:700}.content-bd .msg-box .chat-info-box .chat-info-list[data-v-06db997b]{top:106px;right:0;bottom:0;left:0;position:absolute;padding:10px;overflow-x:hidden;overflow-y:auto}.content-bd .msg-box .chat-info-box .chat-info-list .loading-box[data-v-06db997b],.content-bd .msg-box .chat-info-box .chat-info-list .nomore-box[data-v-06db997b]{text-align:center;font-size:12px;color:grey;height:24px;display:block}.content-bd .msg-box .chat-info-box .chat-info-list .time-divider[data-v-06db997b]{font-size:12px;color:grey}.content-bd .msg-box .chat-info-box .chat-info-list .time-divider[data-v-06db997b] .ant-divider-inner-text{line-height:24px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item[data-v-06db997b]{width:100%;display:inline-block;margin:10px 0;float:left}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .chat-item-img[data-v-06db997b]{width:40px;height:40px;float:left}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content[data-v-06db997b]{color:#000;float:left;width:auto;max-width:70%;margin-left:10px;background-color:#e4e7eb;border:1px solid #e4e7eb;border-radius:5px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content[data-v-06db997b] .wrong-notice{padding:10px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-1[data-v-06db997b]{padding:10px;word-break:normal;word-wrap:break-word;overflow-wrap:break-word}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-2[data-v-06db997b]{border-color:transparent;overflow:hidden}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-3[data-v-06db997b]{padding:0;overflow:hidden;position:relative}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-3[data-v-06db997b] .media-content{border-radius:5px;display:block}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-3[data-v-06db997b] .media-play-btn{width:40px;height:40px;top:50%;left:50%;background:hsla(0,0%,50.2%,.5);border:2px solid #fff;border-radius:20px;margin-top:-20px;margin-left:-20px;display:block;position:absolute;cursor:pointer}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-3[data-v-06db997b] .media-play-btn .play-btn{width:0;height:0;margin-top:8px;margin-left:12.34px;border-top:10px solid transparent;border-right:17.32px solid transparent;border-bottom:10px solid transparent;border-left:17.32px solid #fff;display:block}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-3[data-v-06db997b] .video-duration{right:5px;bottom:5px;color:#fff;font-size:12px;line-height:12px;display:inline-block;position:absolute;cursor:pointer}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-4[data-v-06db997b]{max-width:170px;overflow:hidden;padding:5px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-4[data-v-06db997b] img{margin-bottom:5px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-4[data-v-06db997b] img:last-child{margin-bottom:0}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-4[data-v-06db997b] video{margin-bottom:5px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-4[data-v-06db997b] video:last-child{margin-bottom:0}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-4[data-v-06db997b] .media-play-btn{width:40px;height:40px;top:50%;left:50%;background:hsla(0,0%,50.2%,.5);border:2px solid #fff;border-radius:20px;margin-top:-20px;margin-left:-20px;display:block;position:absolute;cursor:pointer}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-4[data-v-06db997b] .media-play-btn .play-btn{width:0;height:0;margin-top:8px;margin-left:12.34px;border-top:10px solid transparent;border-right:17.32px solid transparent;border-bottom:10px solid transparent;border-left:17.32px solid #fff;display:block}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-5[data-v-06db997b]{overflow:hidden}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-5[data-v-06db997b] .weapp-content{background-color:#fff;width:300px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-5[data-v-06db997b] .weapp-content .weapp-display-name{padding:10px 10px 5px 10px;font-size:12px;line-height:18px;height:33px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-5[data-v-06db997b] .weapp-content .weapp-title{padding:5px 10px 5px 10px;word-break:normal;word-wrap:break-word;overflow-wrap:break-word}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-5[data-v-06db997b] .weapp-content .weapp-description{padding:5px 10px 10px 10px;color:#999;font-size:12px;line-height:18px;word-break:normal;word-wrap:break-word;overflow-wrap:break-word}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-5[data-v-06db997b] .weapp-content .weapp-footer{padding:5px 10px;border-top:1px solid #e4e7eb;color:#999;font-size:12px;line-height:18px;height:28px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-6[data-v-06db997b]{width:300px;padding:10px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-6[data-v-06db997b] .file-content .file-info{width:220px;height:60px;float:left}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-6[data-v-06db997b] .file-content .file-icon{float:right}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-7[data-v-06db997b]{padding:10px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-7[data-v-06db997b] .revoke-content{background-color:rgba(15,15,15,.2);color:#fff;padding:5px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-7[data-v-06db997b] .revoke-content /deep/ .file-content .file-info{width:200px;display:inline-block}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-7[data-v-06db997b] .revoke-content /deep/ .file-content .file-info span{color:#fff!important}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-7[data-v-06db997b] .revoke-content /deep/ .file-content .file-icon{float:right}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-9[data-v-06db997b] .voice-box{padding:6px 11px;height:32px;cursor:pointer;position:relative}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-9[data-v-06db997b] .voice-box .voice-symbol{width:10px;height:10px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transform:rotate(135deg);transform:rotate(135deg);overflow:hidden;position:relative;margin-top:5px;margin-left:5px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-9[data-v-06db997b] .voice-box .voice-symbol .voice-circle{border:2px solid #2390ff;border-radius:50%;position:absolute}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-9[data-v-06db997b] .voice-box .voice-symbol .voice-circle.first{width:20px;height:20px;top:0;left:0}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-9[data-v-06db997b] .voice-box .voice-symbol .voice-circle.second{width:12px;height:12px;top:4px;left:4px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-9[data-v-06db997b] .voice-box .voice-symbol .voice-circle.third{border:none;width:4px;height:4px;background:#2390ff;top:8px;left:8px}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item .content.content-9[data-v-06db997b] .voice-box .voice-time{top:6px;right:15px;bottom:6px;position:absolute;display:inline-block}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item.self[data-v-06db997b],.content-bd .msg-box .chat-info-box .chat-info-list .chat-item.self .chat-item-img[data-v-06db997b]{float:right}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item.self .content[data-v-06db997b]{float:right;margin-left:0;margin-right:15px;background-color:#c6e5ff;border-color:#c6e5ff}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item.self .content.content-6[data-v-06db997b] .file-content .file-info{float:right}.content-bd .msg-box .chat-info-box .chat-info-list .chat-item.self .content.content-6[data-v-06db997b] .file-content .file-icon{float:left}",""])},"4bef":function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAABAElEQVR42s3VIY7CUBAG4LkEliC4xKJ6BA6AognXQBLCAVBYNBK3pim7zP8XBAJHSLhAZVURi+jC2+681xD4R89nZiYjIhojQRlQicYiolFQ8600EqZNAKbSpB0lyqcCBeYccIA5ihDgtO3JLdseTr7Ap9wFRx+g2HTuge8PH+AsjuBiBzZO4MsOHJzAwQ7kTiD3mcLsoX3muQcaV9s1DtnENUfssssR1i+6hRcD3GPFBaeccoEV9z7AUodoP4yxrUMs/wd26EtN0MeuBuBYDOH4LyDPWhYga1WXugpMxBhMnIBGVqD6S34B9nqvTUwaAUnNpZue689/DnuwTDUSuQJ1pL7YQ6lKkQAAAABJRU5ErkJggg=="},6161:function(t,i,e){var a=e("460a");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=e("499e").default;s("1c3b8e76",a,!0,{sourceMap:!1,shadowMode:!1})},"767d":function(t,i,e){var a=e("241a");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=e("499e").default;s("0592f6c4",a,!0,{sourceMap:!1,shadowMode:!1})},"7d42":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticStyle:{width:"100%",height:"100%",position:"absolute","overflow-y":"auto"}},[a("a-card",{staticStyle:{padding:"10px 20px"}},[a("label",{staticClass:"tpl-title"},[t._v("会话内容\n\t\t\t"),a("a-tooltip",{attrs:{placement:"rightTop"}},[a("template",{slot:"title"},[a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n\t\t\t\t\t\t1、企业可设置合规存档的员工范围")]),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n\t\t\t\t\t\t2、经告知员工后，企业可获取开启范围内员工的工作沟通内容")]),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n\t\t\t\t\t\t3、经外部联系人同意后，企业可获取外部联系人与开启范围内员工的会话内容")]),a("p",{staticStyle:{"margin-bottom":"0px"}},[t._v("\n\t\t\t\t\t\t4、准实时获取，员工与内外部单聊、群聊的聊天内容合规存档，包括文本、图片、文件（包括视频文件等）、语音条及撤回消息等消息类型")])]),a("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1)]),a("div",{staticClass:"content-bd"},[a("a-spin",{attrs:{tip:"Loading...",size:"large",spinning:t.isLoading,wrapperClassName:"msg-box"}},[a("a-row",{staticStyle:{height:"100%","background-color":"white"}},[a("a-col",{style:{height:"100%",borderRight:"1px solid #ececec"},attrs:{xs:5,sm:5,md:5,lg:5,xl:5,xxl:4}},[a("div",{staticClass:"user-box"},[a("a-dropdown",{attrs:{visible:t.userVisible,overlayStyle:{boxShadow:"rgba(0, 0, 0, 0.08) 0px 0px 0px 2px"}}},[a("a",{staticClass:"ant-dropdown-link",staticStyle:{"font-weight":"700"},on:{click:t.changeUserVisible,mouseout:t.setUserVisible,mouseover:t.clearInter}},[a("a-avatar",{staticStyle:{"margin-right":"4px"},attrs:{shape:"square",src:t.activeUser.avatar}}),t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.activeUser.name)+"\n\t\t\t\t\t\t\t\t"),a("a-icon",{attrs:{type:"down"}})],1),a("div",{staticStyle:{width:"160px","background-color":"#FFFFFF"},attrs:{slot:"overlay"},on:{mouseleave:t.setUserVisible,mouseover:t.clearInter},slot:"overlay"},[a("a-input",{staticStyle:{width:"94%",margin:"5px 3%"},attrs:{allowClear:!0,placeholder:"搜索成员"},on:{change:t.selectUser},model:{value:t.userName,callback:function(i){t.userName=i},expression:"userName"}}),a("a-menu",{staticStyle:{"max-height":"270px","overflow-y":"auto"}},[t._l(t.selectUserList,(function(i,e){return a("a-menu-item",{key:i.id,attrs:{disabled:i.id==t.activeUser.id},on:{click:function(i){return t.changeUser(e)}}},[a("a-avatar",{staticStyle:{"margin-right":"4px"},attrs:{shape:"square","data-id":i.id,src:i.avatar}}),t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(i.name)+"\n\t\t\t\t\t\t\t\t\t")],1)})),0==t.selectUserList.length?a("a-menu-item",[t._v("\n\t\t\t\t\t\t\t\t\t\t暂无成员\n\t\t\t\t\t\t\t\t\t")]):t._e()],2)],1)]),a("a-tooltip",{staticStyle:{float:"right","margin-top":"5px"},attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v("已开通会话存档功能的企业成员。")])]),a("a-icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"question-circle"}})],2)],1),a("div",{staticClass:"msg-type-box"},[a("a-row",[a("a-col",{staticClass:"msg-type",class:0==t.type?"msg-type-active":"",attrs:{span:8},on:{click:function(i){return t.changeMsgType(0)}}},[t._v("内部\n\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:1==t.type?"msg-type-active":"",attrs:{span:8},on:{click:function(i){return t.changeMsgType(1)}}},[t._v("外部\n\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:2==t.type?"msg-type-active":"",attrs:{span:8},on:{click:function(i){return t.changeMsgType(2)}}},[t._v("群聊\n\t\t\t\t\t\t\t")])],1),a("div",[a("a-input",{staticStyle:{margin:"10px",height:"32px",width:"calc(100% - 20px)"},attrs:{allowClear:!0,placeholder:"按名称搜索"},on:{change:t.changeName},model:{value:t.userOrChatName,callback:function(i){t.userOrChatName=i},expression:"userOrChatName"}})],1)],1),a("div",{staticClass:"chat-list-box"},[a("a-spin",{staticStyle:{height:"100%"},attrs:{tip:"Loading...",size:"large",spinning:t.isChatUserLoading}},[a("a-empty",{directives:[{name:"show",rawName:"v-show",value:0==t.chatList.length&&!t.isChatUserLoading,expression:"chatList.length == 0 && !isChatUserLoading"}],staticStyle:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),t._l(t.chatList,(function(i,s){return(0==t.type||1==t.type)&&t.chatList.length>0?a("div",{key:s,staticClass:"chat-list",class:t.activeChat==i.chatUserId?"chat-list-active":"",attrs:{"data-chat-id":i.chatUserId,"data-chat-name":i.user.name},on:{click:function(e){return t.changeChat(i.chatUserId,i.user.name)}}},[a("div",{staticClass:"chat-left"},[0==t.type&&i.user.thumb_avatar||1==t.type&&i.user.avatar?a("a-avatar",{staticClass:"chat-img",attrs:{shape:"square","data-id":i.chatUserId,src:0==t.type?i.user.thumb_avatar:i.user.avatar}}):t._e(),0==t.type&&!i.user.thumb_avatar||1==t.type&&!i.user.avatar?a("img",{staticStyle:{width:"40px",height:"40px",float:"left"},attrs:{src:e("4bef")}}):t._e()],1),a("div",{staticClass:"chat-right"},[a("div",{staticClass:"chat-right-title"},[a("span",{staticClass:"chat-name",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[a("strong",[t._v(t._s(i.user.name))])]),a("span",{staticClass:"chat-time"},[t._v(t._s(t.formatMsgTime(i.msgtime,!0,"MM-DD")))])]),a("div",{staticClass:"chat-right-content"},[a("span",[t._v(t._s(i.content))])])])]):t._e()})),t._l(t.chatList,(function(i,e){return 2==t.type&&t.chatList.length>0?a("div",{key:e,staticClass:"chat-list",class:t.activeChat==i.chat_id?"chat-list-active":"",staticStyle:{height:"55px"},attrs:{"data-chat-id":i.chat_id,"data-chat-name":i.chat},on:{click:function(e){t.changeChat(i.chat_id,i.chat&&i.chat.length>0?i.chat:"群聊")}}},[a("div",{staticClass:"chat-left",staticStyle:{height:"35px",width:"35px"}},[i.avatarData&&0==i.avatarData.length?a("div",{staticStyle:{background:"#1890FF",width:"36px",height:"36px","border-radius":"4px"}},[a("img",{staticStyle:{width:"20px",margin:"8px",height:"20px"},attrs:{src:t.groupAvatar,"data-id":i.chat_id}})]):i.avatarData&&1==i.avatarData.length?a("div",{staticStyle:{background:"#DFDFDF",width:"36px",height:"36px","border-radius":"4px"}},[i.avatarData&&""!=i.avatarData[0]?a("img",{staticStyle:{width:"36px",height:"36px"},attrs:{src:i.avatarData[0],"data-id":i.chat_id}}):t._e(),i.avatarData&&""==i.avatarData[0]?a("img",{staticStyle:{width:"36px",height:"36px"},attrs:{src:t.img2,"data-id":i.chat_id}}):t._e()]):i.avatarData&&i.avatarData.length>1&&i.avatarData.length<=4?a("div",{staticStyle:{background:"#DFDFDF",width:"36px",height:"36px",display:"flex","flex-wrap":"wrap","justify-content":"space-around","border-radius":"4px","align-items":"center"}},[t._l(i.avatarData,(function(e){return[""!=e?a("img",{staticStyle:{width:"17px",height:"17px"},attrs:{src:e,"data-id":i.chat_id}}):t._e(),""==e?a("img",{staticStyle:{width:"17px",height:"17px"},attrs:{src:t.img2,"data-id":i.chat_id}}):t._e()]}))],2):i.avatarData&&i.avatarData.length>4?a("div",{staticStyle:{background:"#DFDFDF",width:"36px",height:"36px",display:"flex","flex-wrap":"wrap","justify-content":"space-around","border-radius":"4px","align-items":"center"}},[t._l(i.avatarData,(function(e){return[""!=e?a("img",{staticStyle:{width:"10px",height:"10px"},attrs:{src:e,"data-id":i.chat_id}}):t._e(),""==e?a("img",{staticStyle:{width:"10px",height:"10px"},attrs:{src:t.img2,"data-id":i.chat_id}}):t._e()]}))],2):t._e()]),a("div",{staticClass:"chat-right",staticStyle:{height:"35px"}},[a("div",{staticClass:"chat-right-title",staticStyle:{height:"20px","padding-bottom":"2px"}},[a("span",{staticClass:"chat-name",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[a("strong",[t._v(t._s(i.chat&&i.chat.length>0?i.chat:"群聊"))])]),a("span",{staticClass:"chat-time"},[t._v(t._s(t.formatMsgTime(i.msgtime,!0,"MM-DD")))])]),a("div",{staticClass:"chat-right-content",staticStyle:{"padding-top":"0px"}},[a("span",[t._v(t._s(i.content))])])])]):t._e()}))],2)],1)]),a("a-col",{staticStyle:{height:"100%"},attrs:{xs:19,sm:19,md:19,lg:19,xl:19,xxl:20}},[a("a-spin",{staticStyle:{height:"100%"},attrs:{tip:"Loading...",size:"large",spinning:t.isChatListLoading}},[a("div",{staticClass:"chat-info-box"},[a("div",{staticClass:"chat-info-title",staticStyle:{"background-color":"#FAFAFA"}},[a("a-col",{staticClass:"msg-type",class:""==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("")}}},[t._v("全部\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"text"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("text")}}},[t._v("文本\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"image"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("image")}}},[t._v("图片\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"voice"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("voice")}}},[t._v("语音\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"video"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("video")}}},[t._v("视频\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"file"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("file")}}},[t._v("文件\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"weapp"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("weapp")}}},[t._v("小程序\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"news"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("news")}}},[t._v("图文\n\t\t\t\t\t\t\t\t")]),a("a-col",{staticClass:"msg-type",class:"other"==t.msgType?"msg-type-active":"",attrs:{span:2},on:{click:function(i){return t.changeFileType("other")}}},[t._v("其他\n\t\t\t\t\t\t\t\t")])],1),""!=t.activeChatName?a("div",{staticClass:"chat-info-title",staticStyle:{"background-color":"#FAFAFA"}},[a("a-tooltip",{attrs:{placement:"bottom"}},[a("span",{attrs:{slot:"title"},slot:"title"},[a("span",[t._v(t._s(t.activeChatName))])]),a("span",{staticClass:"chat-info-name",staticStyle:{"font-weight":"700"}},[t._v(t._s(t.activeChatName))])]),a("div",{staticStyle:{float:"right"}},[""==t.msgType||"text"==t.msgType?a("a-input",{staticStyle:{width:"210px","margin-right":"10px"},attrs:{allowClear:!0,placeholder:"请输入搜索内容"},on:{keyup:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.findContent(i)}},model:{value:t.msgName,callback:function(i){t.msgName=i},expression:"msgName"}}):t._e(),a("a-range-picker",{staticStyle:{width:"210px","margin-right":"10px"},attrs:{allowClear:!0,disabledDate:t.disabledDateDay,format:"YYYY-MM-DD"},model:{value:t.sendDate,callback:function(i){t.sendDate=i},expression:"sendDate"}}),a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.findContent}},[t._v("搜索\n\t\t\t\t\t\t\t\t\t")]),a("a-button",{staticStyle:{"margin-right":"10px"},on:{click:t.clearContent}},[t._v("清空")])],1)],1):t._e(),0!=t.chatInfoList.length||t.chatItemLoading?t._e():a("a-empty",{staticStyle:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),a("a-row",{directives:[{name:"perfect-scroll-bar",rawName:"v-perfect-scroll-bar",value:t.perfectScrollBarOptions,expression:"perfectScrollBarOptions"}],ref:"chat_info_list",staticClass:"chat-info-list",on:{"ps-scroll-up":t.handlePullOnLoad,"ps-scroll-down":t.handleInfiniteOnLoad,"ps-scroll-y":t.changeScrollPosition}},[a("a-col",{attrs:{span:24}},[t.chatItemLoading?a("div",{staticClass:"loading-box"},[a("a-spin",[a("a-icon",{staticStyle:{"font-size":"12px",color:"grey","margin-right":"5px"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1),a("span",[t._v("正在加载")])],1):t._e(),t._l(t.chatInfoList,(function(i,s){return t.chatInfoList.length>0?[t.showTimeDivider(i.msgid,i.msgtime)?a("div",{staticStyle:{"text-align":"center",width:"100%",float:"left",margin:"8px 0px"}},[t._v("\n\t\t\t\t\t\t\t\t\t\t\t"+t._s(t.formatMsgTime(i.msgtime,!0))+"\n\t\t\t\t\t\t\t\t\t\t")]):t._e(),a("div",{staticClass:"chat-item",class:t.isFromUser(i)?"self":""},[1==i.from_type&&i.from_info.thumb_avatar||1!=i.from_type&&i.from_info.avatar?a("a-avatar",{staticClass:"chat-item-img",attrs:{shape:"square",src:1==i.from_type?i.from_info.thumb_avatar:i.from_info.avatar}}):t._e(),1==i.from_type&&!i.from_info.thumb_avatar||1!=i.from_type&&!i.from_info.avatar?a("img",{staticClass:"chat-item-img",attrs:{src:e("4bef")}}):t._e(),2!=t.type||t.isFromUser(i)?t._e():a("div",{staticClass:"chat-item-name",staticStyle:{"margin-bottom":"6px"}},[a("span",{staticStyle:{margin:"0 8px 0 10px"}},[t._v(t._s(i.from_info.name))]),1==i.from_type?a("a-tag",{attrs:{color:"blue"}},[t._v("内部")]):a("a-tag",{attrs:{color:"orange"}},[t._v("外部")])],1),a("div",{ref:i.msgid,refInFor:!0,staticClass:"content",class:"content-"+t.getMsgType(i),domProps:{innerHTML:t._s(t.initMsgContent(i))},on:{click:t.addComment}})],1)]:t._e()}))],2)],1)],1)])],1)],1)],1)],1),"undefined"!=typeof t.previewInfo[t.activeUser.id+"_"+t.activeChat]?a("a-modal",{staticClass:"preview-modal",attrs:{visible:t.previewVisible,footer:null,width:"100%",centered:""},on:{cancel:t.handleCancel}},[a("a-carousel",{ref:"previewCarousel",attrs:{arrows:"",dots:!1,effect:"fade",adaptiveHeight:!0},scopedSlots:t._u([{key:"prevArrow",fn:function(i){return a("div",{staticClass:"custom-slick-arrow",staticStyle:{left:"10px",zIndex:"1"}},[a("a-icon",{attrs:{type:"left-circle"},on:{click:t.videoStop}})],1)}},{key:"nextArrow",fn:function(i){return a("div",{staticClass:"custom-slick-arrow",staticStyle:{right:"10px"}},[a("a-icon",{attrs:{type:"right-circle"},on:{click:t.videoStop}})],1)}}],null,!1,4242784060)},t._l(t.previewInfo[t.activeUser.id+"_"+t.activeChat],(function(i,e){return a("div",["undefined"!=typeof i.previewType&&"IMG"==i.previewType?a("img",{staticStyle:{margin:"0 auto",display:"block"},attrs:{alt:i.previewAlt,src:i.previewUrl,width:i.previewWidth,height:i.previewHeight}}):t._e(),"undefined"!=typeof i.previewType&&"VIDEO"==i.previewType?a("video",{staticStyle:{margin:"0 auto",display:"block"},attrs:{src:i.previewUrl,width:i.previewWidth,height:i.previewHeight,preload:"",controls:"","data-key":e},on:{play:t.videoPlay,pause:t.videoPause}}):t._e()])})),0)],1):t._e()],1)},s=[],n=(e("20d6"),e("28a5"),e("96cf"),e("3b8d")),o=(e("a481"),e("3b2b"),e("386d"),e("5df3"),e("7f7f"),e("ac4d"),e("8a81"),e("ac6a"),e("c1df")),c=e.n(o),r=e("40cf"),h=e("e306"),l=e.n(h),d=e("4bef"),p=e.n(d),f=e("ea7d"),g=e.n(f),m=e("a4b7"),v=e.n(m),b={name:"Msg",data:function(){var t=localStorage.getItem("corpId")?localStorage.getItem("corpId"):"";return{corpId:t,isLoading:!1,isChatUserLoading:!0,isChatListLoading:!0,chatItemLoading:!0,activeUser:{},userVisible:!1,userName:"",userList:[],selectUserList:[],type:0,userOrChatName:"",allChatList:[],chatList:[],activeChat:0,msgType:"",msgName:"",sendDate:null,activeChatName:"",lastTime:0,perfectScrollBarOptions:{suppressScrollX:!0,minScrollbarLength:15},scrollData:[],noMore:[],newMsg:[],chatInfoList:[],timeDivider:[],previewVisible:!1,previewInfo:[],previewRelation:[],playAudio:{isPlay:!1,key:0,dom:"",interval:""},playVideo:{isPlay:!1,key:-1,dom:""},groupAvatar:l.a,img2:p.a,miniApp:g.a,fileIcon:v.a,inter:0}},methods:{setUserVisible:function(){var t=this;clearInterval(this.inter),this.inter=setTimeout((function(){t.userVisible=!1}),500)},clearInter:function(){clearInterval(this.inter)},changeUserVisible:function(){this.userName="",this.selectUserList=JSON.parse(JSON.stringify(this.userList)),this.userVisible=!this.userVisible},selectUser:function(){if(""==this.userName)this.selectUserList=JSON.parse(JSON.stringify(this.userList));else{this.selectUserList=[];var t=!0,i=!1,e=void 0;try{for(var a,s=this.userList[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var n=a.value;n.name.indexOf(this.userName)>-1&&this.selectUserList.push(n)}}catch(o){i=!0,e=o}finally{try{t||null==s.return||s.return()}finally{if(i)throw e}}}},changeUser:function(t){this.activeUser=this.selectUserList[t],this.type=0,this.lastTime=0,this.allChatList=[],this.userOrChatName="",this.msgType="",this.msgName="",this.sendDate=null,this.chatList=[],this.isChatUserLoading=!0,this.isChatListLoading=!0,this.userVisible=!1,this.selectUserList=JSON.parse(JSON.stringify(this.userList));var i=this;Promise.all([i.getChatList()]).then((function(t){i.$nextTick((function(){if("undefined"==typeof i.scrollData[i.activeUser.id+"_"+i.activeChat]){var t={first_id:0,old_first_id:0,last_id:0,position:null};i.$set(i.scrollData,i.activeUser.id+"_"+i.activeChat,t)}i.chatItemLoading=!0,i.chatInfoList=[],i.getChatInfoList()}))})).catch((function(t){}))},changeMsgType:function(t){var i=this;if(t!=this.type){this.type=t,this.lastTime=0,this.userOrChatName="",this.msgType="",this.msgName="",this.sendDate=null,this.chatList=[],this.allChatList=[],this.activeChat=0,this.isChatUserLoading=!0,this.isChatListLoading=!0;var e=this;Promise.all([e.getChatList()]).then((function(t){e.$nextTick((function(){if(0!=i.activeChat){if("undefined"==typeof e.scrollData[e.activeUser.id+"_"+e.activeChat]){var t={first_id:0,old_first_id:0,last_id:0,position:null};e.$set(e.scrollData,e.activeUser.id+"_"+e.activeChat,t)}e.chatItemLoading=!0,e.chatInfoList=[],e.getChatInfoList()}else i.isChatListLoading=!1,i.chatItemLoading=!1,i.chatInfoList=[]}))})).catch((function(t){}))}},changeFileType:function(t){if(this.msgType!=t){this.msgType=t,this.msgName="",this.lastTime=0,this.sendDate=null;var i={first_id:0,old_first_id:0,last_id:0,position:null};this.$set(this.scrollData,this.activeUser.id+"_"+this.activeChat,i),this.chatItemLoading=!0,this.chatInfoList=[],this.getChatInfoList()}},disabledDateDay:function(t){return t.valueOf()>(new Date).getTime()},findContent:function(){var t={first_id:0,old_first_id:0,last_id:0,position:null};this.$set(this.scrollData,this.activeUser.id+"_"+this.activeChat,t),this.lastTime=0,this.chatItemLoading=!0,this.chatInfoList=[],this.getChatInfoList()},clearContent:function(){this.msgName="",this.sendDate=null,this.lastTime=0;var t={first_id:0,old_first_id:0,last_id:0,position:null};this.$set(this.scrollData,this.activeUser.id+"_"+this.activeChat,t),this.chatItemLoading=!0,this.chatInfoList=[],this.getChatInfoList()},changeChat:function(t,i){if(this.activeChat!=t){if(this.activeChat=t,this.activeChatName=i,this.lastTime=0,this.isChatListLoading=!0,this.msgType="",this.msgName="",this.sendDate=null,"undefined"==typeof this.scrollData[this.activeUser.id+"_"+this.activeChat]){var e={first_id:0,old_first_id:0,last_id:0,position:null};this.$set(this.scrollData,this.activeUser.id+"_"+this.activeChat,e)}this.chatItemLoading=!0,this.chatInfoList=[],this.getChatInfoList()}},changeName:function(){var t=[];if(0==this.type||1==this.type){var i=!0,e=!1,a=void 0;try{for(var s,n=this.allChatList[Symbol.iterator]();!(i=(s=n.next()).done);i=!0){var o=s.value;null!=o.user.name&&o.user.name.indexOf(this.userOrChatName)>-1&&t.push(o)}}catch(f){e=!0,a=f}finally{try{i||null==n.return||n.return()}finally{if(e)throw a}}}else if(2==this.type){var c=!0,r=!1,h=void 0;try{for(var l,d=this.allChatList[Symbol.iterator]();!(c=(l=d.next()).done);c=!0){var p=l.value;p.chat.indexOf(this.userOrChatName)>-1&&t.push(p)}}catch(f){r=!0,h=f}finally{try{c||null==d.return||d.return()}finally{if(r)throw h}}}this.chatList=JSON.parse(JSON.stringify(t))},handlePullOnLoad:function(){var t=this.$refs.chat_info_list.$el._ps_.reach.y;"start"!==t||this.chatItemLoading||this.noMore[this.activeUser.id+"_"+this.activeChat]||(this.chatItemLoading=!0,this.getChatInfoList())},handleInfiniteOnLoad:function(){var t=this.$refs.chat_info_list.$el._ps_.reach.y;"end"===t&&this.$set(this.newMsg,this.activeUser.id+"_"+this.activeChat,!1)},changeScrollPosition:function(t){0!=this.activeChat&&(this.scrollData[this.activeUser.id+"_"+this.activeChat].position=t.srcElement.scrollTop)},formatMsgTime:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"YYYY-MM-DD HH:mm";return t=parseInt(t),i&&this.utils.isToday(t)?c()(t).format("HH:mm"):c()(t).format(e)},showTimeDivider:function(t,i){if(i=this.formatMsgTime(i),this.timeDivider[this.activeUser.id+"_"+this.activeChat])return!(this.timeDivider[this.activeUser.id+"_"+this.activeChat].time.indexOf(i)>-1&&this.timeDivider[this.activeUser.id+"_"+this.activeChat].show[i]!==t)&&(-1===this.timeDivider[this.activeUser.id+"_"+this.activeChat].time.indexOf(i)&&(this.timeDivider[this.activeUser.id+"_"+this.activeChat].time.push(i),this.timeDivider[this.activeUser.id+"_"+this.activeChat].show[i]=t),!0)},isFromUser:function(t){return 1==t.from_type&&t.user_id==this.activeUser.id},getMsgType:function(t){var i=1;switch(t.msgtype){case"text":i=1;break;case"image":i=2;break;case"video":i=3;break;case"mixed":i=4;break;case"weapp":i=5;break;case"file":i=6;break;case"revoke":i=7;break;case"emotion":i=8;break;case"voice":i=9;break}return i},initTimeDivider:function(){this.timeDivider[this.activeUser.id+"_"+this.activeChat]={time:[],show:[]}},initMsgContent:function(t){var i="暂不支持的信息";switch(t.msgtype){case"text":i=this.initTextMsgContent(t.info);break;case"image":i=this.initImgMsgContent(t.info);break;case"video":i=this.initVideoMsgContent(t.info);break;case"voice":i=this.initVoiceMsgContent(t.info);break;case"emotion":i=this.initEmotionMsgContent(t.info);break;case"weapp":i=this.initWeappMsgContent(t.info);break;case"file":i=this.initFileMsgContent(t.info);break;case"revoke":i=this.initRevokeMsgContent(t.info);break;case"mixed":i=this.initMixedMsgContent(t.info);break;default:console.log("暂不支持的【"+t.content+"】信息");break}return i},initTextMsgContent:function(t){var i=this;return t=t.content,-1!==t.search(/[\/\[\]\(\)\|\$\*\?\+\-\_]/g)&&r["a"].wechatEmojiKey.map((function(e){var a=new RegExp(i.utils.addslashes(e),"g"),s=r["a"].getEmojiUrl(e);t=t.replace(a,'<img src="'+s+'" alt="'+e+'" height="21" width="21"/>')})),t.replace(/[\r\n|\n]/g,"<br/>")},getNewSize:function(t,i){var e=160,a=160,s=840,n=600,o=e,c=a,r=s,h=n;return parseInt(i)>parseInt(t)?(parseInt(i)>a?o=a*t/i:(o=t,c=i),parseInt(i)>n?r=n*t/i:(r=t,h=i),r>s&&(r=s,h=s*i/t)):(parseInt(t)>e?c=e*i/t:(o=t,c=i),parseInt(t)>r?h=s*i/t:(r=t,h=i),h>n&&(r=n*t/i,h=n)),{newWidth:o,newHeight:c,newPreviewWidth:r,newPreviewHeight:h}},initImgMsgContent:function(t){var i="img-"+t.id,e=this.getNewSize(t.width,t.height),a=e.newWidth,s=e.newHeight,n=e.newPreviewWidth,o=e.newPreviewHeight;return t.preview_width=n,t.preview_height=o,this.initPreviewInfo(i,t,"IMG"),'<img class="media-content" src="'+this.$store.state.commonUrl+t.file_path+'" alt="图片" height="'+s+'" width="'+a+'" data-key="'+i+'" />'},getMediaDuration:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",e=Math.floor(t/60);if(e<1)return"voice"==i?t:t<10?"00:0"+t:"00:"+t;var a=Math.floor(e/60);if(a<1){var s=t-60*e;return e<10?s<10?"voice"==i?e+":0"+s:"0"+e+":0"+s:"voice"==i?e+":"+s:"0"+e+":"+s:s<10?e+":0"+s:e+":"+s}},initVideoMsgContent:function(t){var i='<div class="wrong-notice">【视频无法加载】</div>';if(""!==t.local_path){var e="video-"+t.id,a=this.getNewSize(t.width,t.height),s=a.newWidth,n=a.newHeight,o=a.newPreviewWidth,c=a.newPreviewHeight;t.preview_width=o,t.preview_height=c,this.initPreviewInfo(e,t,"VIDEO"),i='<video class="media-content" src="'+this.$store.state.commonUrl+t.local_path+'" preload width="'+s+'" height="'+n+'" data-key="'+e+'"></video><div class="media-play-btn"><span class="play-btn" data-key="'+e+'"></span></div><span class="video-duration" data-key="'+e+'">'+this.getMediaDuration(t.play_length)+"</span>"}return i},initVoiceMsgContent:function(t){var i='<div class="wrong-notice">【音频无法加载】</div>';if(""!==t.local_path){var e="voice-"+t.id,a=240,s=75,n=t.play_length*a/60;n=n<s?s:n,i='<div class="voice-box voice-btn" style="width: '+n+'px;" data-key="'+e+'"><div class="voice-symbol voice-btn" data-key="'+e+'"><span id="voiceCircleFirst'+e+'" class="voice-circle first voice-btn" data-key="'+e+'"></span><span id="voiceCircleSecond'+e+'"  class="voice-circle second voice-btn" data-key="'+e+'"></span><span id="voiceCircleThird'+e+'"  class="voice-circle third voice-btn" data-key="'+e+'"></span></div>',i+='<span class="voice-time voice-btn" data-key="'+e+'">'+this.getMediaDuration(t.play_length,"voice")+"″</span></div>",i+='<audio id="voiceAudio'+e+'" preload src="'+this.$store.state.commonUrl+t.local_path+'" style="display: none; "/>'}return i},initEmotionMsgContent:function(t){return'<img class="emotion-content" src="'+this.$store.state.commonUrl+t.local_path+'" height="'+t.height+'" width="'+t.width+'" />'},initWeappMsgContent:function(t){return'<div class="weapp-content"><div class="weapp-display-name">'+t.displayname+'</div><div class="weapp-title">'+t.title+'</div><div class="weapp-description">'+t.description+'</div><div class="weapp-footer"><img src="'+this.miniApp+'" width="12" height="12" style="margin-right: 5px; vertical-align: middle;"/><span style="vertical-align: middle;">小程序</span></div></div>'},getDisplayFileSize:function(t){var i=t/1024;if(parseInt(i)<1024)return parseInt(i)+"K";var e=i/1024;if(parseInt(e)<1024)return e.toFixed(2)+"M";var a=e/1024;if(parseInt(a)<1024)return a.toFixed(2)+"G";var s=a/1024;return s.toFixed(2)+"T"},initFileMsgContent:function(t){return'<div class="file-content"><div class="file-info"><span style="width: 220px; display: inline-block; height: 40px;">'+t.filename+'</span><span style="font-size: 12px; height: 20px; line-height: 20px; color: #999999; ">'+this.getDisplayFileSize(t.filesize)+'</span></div><img class="file-icon" src="'+v.a+'" height="60"/></div>'},initRevokeMsgContent:function(t){var i='<div class="revoke-box"><span style="display: block;">这是一条【撤回】消息，内容如下：</span> <div class="revoke-content">';if("undefined"!==typeof t.content&&"undefined"!==typeof t.content.msgtype)switch(t.content.msgtype){case"text":i+=this.initTextMsgContent(t.content.info);break;case"image":i+=this.initImgMsgContent(t.content.info);break;case"video":i+=this.initVideoMsgContent(t.content.info);break;case"voice":i+=this.initVoiceMsgContent(t.content.info);break;case"weapp":i+=this.initWeappMsgContent(t.content.info);break;case"file":i+=this.initFileMsgContent(t.content.info);break;case"mixed":i+=this.initMixedMsgContent(t.content.info);break}return i+="</div></div>",i},initMixedMsgContent:function(t){var i=this,e="";return t.map((function(t){switch(t.type){case"text":e+=i.initTextMsgContent(t.content);break;case"image":e+=i.initImgMsgContent(t.content);break;case"video":e+=i.initVideoMsgContent(t.content);break;case"weapp":e+=i.initWeappMsgContent(t.content);break;case"file":e+=i.initFileMsgContent(t.content);break}})),e},changeScrollTop:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$nextTick((function(){if(null===e){var a=0!=t.scrollData[t.activeUser.id+"_"+t.activeChat].old_first_id?t.scrollData[t.activeUser.id+"_"+t.activeChat].old_first_id:t.scrollData[t.activeUser.id+"_"+t.activeChat].last_id;i&&(a=t.scrollData[t.activeUser.id+"_"+t.activeChat].last_id),"undefined"!==typeof t.$refs[a]&&(e=t.$refs[a][0].offsetTop,a!==t.scrollData[t.activeUser.id+"_"+t.activeChat].last_id&&(e-=24,1===t.$refs[a][0].childElementCount&&(e-=56)))}"undefined"!==typeof t.$refs.chat_info_list&&(t.$refs.chat_info_list.$el.scrollTop=e,t.scrollData[t.activeUser.id+"_"+t.activeChat].position=e)}))},initPreviewInfo:function(t,i,e){var a={};switch(e){case"IMG":a={previewType:"IMG",previewUrl:this.$store.state.commonUrl+i.file_path,previewAlt:"图片",previewWidth:i.preview_width,previewHeight:i.preview_height};break;case"VIDEO":a={previewType:"VIDEO",previewUrl:this.$store.state.commonUrl+i.local_path,previewAlt:"视频",previewWidth:i.preview_width,previewHeight:i.preview_height};break;default:break}"undefined"===typeof this.previewInfo[this.activeUser.id+"_"+this.activeChat]&&(this.previewInfo[this.activeUser.id+"_"+this.activeChat]=[]),"undefined"===typeof this.previewRelation[this.activeUser.id+"_"+this.activeChat]&&(this.previewRelation[this.activeUser.id+"_"+this.activeChat]=[]),"undefined"===typeof this.previewRelation[this.activeUser.id+"_"+this.activeChat][t]?(this.previewInfo[this.activeUser.id+"_"+this.activeChat].push(a),this.previewRelation[this.activeUser.id+"_"+this.activeChat][t]=this.previewInfo[this.activeUser.id+"_"+this.activeChat].length-1):this.previewInfo[this.activeUser.id+"_"+this.activeChat][this.previewRelation[this.activeUser.id+"_"+this.activeChat][t]]=a},addComment:function(t){(t.target.classList.contains("media-content")||t.target.classList.contains("play-btn")||t.target.classList.contains("voice-duration"))&&this.preview(t),t.target.classList.contains("voice-btn")&&this.voicePlayOrStop(t)},preview:function(t){var i=this;this.previewVisible=!0,this.$nextTick((function(){i.$refs.previewCarousel.goTo(i.previewRelation[i.activeUser.id+"_"+i.activeChat][t.target.dataset.key],!1)}))},voicePlayOrStop:function(t){var i=this;clearInterval(this.playAudio.interval);var e=t.target.dataset.key,a=document.getElementById("voiceAudio"+e),s=document.getElementById("voiceCircleFirst"+e),n=document.getElementById("voiceCircleSecond"+e),o=document.getElementById("voiceCircleThird"+e);if(this.playAudio.isPlay)if(this.playAudio.dom.pause(),this.playAudio.key==e)this.playAudio.isPlay=!1,this.playAudio.key=0,this.playAudio.dom="",s.setAttribute("style",""),n.setAttribute("style",""),o.setAttribute("style","");else{var c=document.getElementById("voiceCircleFirst"+this.playAudio.key);null!=c&&c.setAttribute("style","");var r=document.getElementById("voiceCircleSecond"+this.playAudio.key);null!=r&&r.setAttribute("style","");var h=document.getElementById("voiceCircleThird"+this.playAudio.key);null!=h&&h.setAttribute("style",""),this.playAudio.key=e,this.playAudio.dom=a,s.setAttribute("style","animation: voiceRun1 3s linear infinite;"),n.setAttribute("style","animation: voiceRun2 3s linear infinite;"),o.setAttribute("style","animation: voiceRun3 3s linear infinite;"),a.currentTime=0,a.play()}else this.playAudio.isPlay=!0,this.playAudio.key=e,this.playAudio.dom=a,s.setAttribute("style","animation: voiceRun1 3s linear infinite;"),n.setAttribute("style","animation: voiceRun2 3s linear infinite;"),o.setAttribute("style","animation: voiceRun3 3s linear infinite;"),a.currentTime=0,a.play();this.playAudio.isPlay&&(this.playAudio.interval=setInterval((function(){i.playAudio.dom.ended&&(document.getElementById("voiceCircleFirst"+i.playAudio.key).setAttribute("style",""),document.getElementById("voiceCircleSecond"+i.playAudio.key).setAttribute("style",""),document.getElementById("voiceCircleThird"+i.playAudio.key).setAttribute("style",""),i.playAudio.isPlay=!1,i.playAudio.key=0,i.playAudio.dom="",clearInterval(i.playAudio.interval))}),10))},videoPlay:function(t){var i=t.target,e=i.dataset.key;this.playVideo.isPlay=!0,this.playVideo.key=e,this.playVideo.dom=i},videoPause:function(t){this.playVideo.isPlay=!1,this.playVideo.key=-1,this.playVideo.dom=""},videoStop:function(){this.playVideo.isPlay&&(this.playVideo.dom.currentTime=0,this.playVideo.dom.pause())},handleCancel:function(){this.previewVisible=!1,this.videoStop()},getUserList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var i,e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axios.post("work-msg-audit/get-permit-user-list",{corp_id:this.corpId});case 2:i=t.sent,e=i.data,0!=e.error?(this.$message.destroy(),this.$message.error(e.error_msg)):(this.activeUser=[],this.userList=[],e.data.length>0&&e.data.map((function(t){a.userList.push({avatar:t.avatar,name:t.name,id:t.id})})),this.selectUserList=JSON.parse(JSON.stringify(this.userList)),this.selectUserList.length>0&&(this.activeUser=this.selectUserList[0]));case 5:case"end":return t.stop()}}),t,this)})));function i(){return t.apply(this,arguments)}return i}(),getChatList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var i,e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=this.activeUser.length){t.next=3;break}return this.isChatUserLoading=!1,t.abrupt("return",!1);case 3:return t.next=5,this.axios.post("work-msg-audit/get-msg-list",{corp_id:this.corpId,user_id:this.activeUser.id,type:this.type});case 5:if(i=t.sent,e=i.data,0==e.error){t.next=13;break}this.isChatUserLoading=!1,this.$message.destroy(),this.$message.error(e.error_msg),t.next=27;break;case 13:if(this.allChatList=e.data,this.chatList=JSON.parse(JSON.stringify(this.allChatList)),this.activeChatName="",!(this.chatList.length>0)){t.next=25;break}this.activeChat=2!=this.type?this.chatList[0].chatUserId:this.chatList[0].chat_id,t.t0=this.type,t.next=0===t.t0?21:1===t.t0?21:2===t.t0?23:25;break;case 21:return this.activeChatName=e.data[0].user.name,t.abrupt("break",25);case 23:return this.activeChatName=e.data[0].chat.length>0?e.data[0].chat:"群聊",t.abrupt("break",25);case 25:this.initTimeDivider(),this.isChatUserLoading=!1;case 27:case"end":return t.stop()}}),t,this)})));function i(){return t.apply(this,arguments)}return i}(),websocketOnMessage:function(t){var i=this;if("undefined"!=typeof t.type&&"audit"==t.type&&t.corp_id&&t.corp_id==localStorage.getItem("corpId")){var e=t.msg_list;if(t.msg_type==this.type)if(2==this.type){if(this.content(t.chat_user_id.split(","),this.activeUser.id)){if(e.chat_id==this.activeChat&&(""==this.msgType||e.msgtype==this.msgType)&&(!this.sendDate||0==this.sendDate.length||this.formatMsgTime(e.msgtime,!1,"YYYY-MM-DD")>c()(this.sendDate[0]).format("YYYY-MM-DD")&&this.formatMsgTime(e.msgtime,!1,"YYYY-MM-DD")<c()(this.sendDate[1]).format("YYYY-MM-DD"))){"text"==e.msgtype?(""==this.msgName||e.content.indexOf(this.msgName)>-1)&&this.chatInfoList.push(e):this.chatInfoList.push(e);var a={first_id:this.chatInfoList[this.chatInfoList.length-1].msgid,old_first_id:this.chatInfoList.length>0?this.chatInfoList[this.chatInfoList.length-1].msgid:0,last_id:this.chatInfoList[this.chatInfoList.length-1].msgid,position:null};this.$set(this.scrollData,this.activeUser.id+"_"+this.activeChat,a),this.changeScrollTop()}var s=this.allChatList.findIndex((function(t){return t.chat_id==e.chat_id}));if(s>-1){this.allChatList[s].msgtime=e.msgtime,this.allChatList[s].content=decodeURIComponent(e.content);var n=JSON.parse(JSON.stringify(this.allChatList[s]));if(this.allChatList.splice(s,1),this.allChatList.unshift(n),s=this.chatList.findIndex((function(t){return t.chat_id==e.chat_id})),s>-1){if(this.chatList.findIndex((function(t){return t.chat_id==i.activeChat}))<s){var o=document.getElementsByClassName("chat-list-box")[0];o&&(o.scrollTop=o.scrollTop+55)}this.chatList[s].msgtime=e.msgtime,this.chatList[s].content=decodeURIComponent(e.content),n=JSON.parse(JSON.stringify(this.chatList[s])),this.chatList.splice(s,1),this.chatList.unshift(n)}var r=this.formatMsgTime(e.msgtime);-1===this.timeDivider[this.activeUser.id+"_"+this.activeChat].time.indexOf(r)&&(this.timeDivider[this.activeUser.id+"_"+this.activeChat].time.push(r),this.timeDivider[this.activeUser.id+"_"+this.activeChat].show[r]="1")}else{var h={chat:t.chat_name,chat_id:e.chat_id,content:decodeURIComponent(e.content),id:"",msgtime:e.msgtime,roomid:e.roomid};this.allChatList.unshift(h),(""==this.userOrChatName||userInfo.name.indexOf(this.userOrChatName)>-1)&&this.chatList.unshift(h)}}}else if(e.user_id==this.activeUser.id||e.to_user_id==this.activeUser.id){var l="";l=0==t.msg_type?e.user_id==this.activeUser.id?e.to_user_id:e.user_id:e.user_id?e.to_external_id:e.external_id;var d=e.user_id==this.activeUser.id?e.to_info:e.from_info;if(this.activeChat==l&&(""==this.msgType||e.msgtype==this.msgType)&&(!this.sendDate||0==this.sendDate.length||this.formatMsgTime(e.msgtime,!1,"YYYY-MM-DD")>c()(this.sendDate[0]).format("YYYY-MM-DD")&&this.formatMsgTime(e.msgtime,!1,"YYYY-MM-DD")<c()(this.sendDate[1]).format("YYYY-MM-DD"))){"text"==e.msgtype?(""==this.msgName||e.content.indexOf(this.msgName)>-1)&&this.chatInfoList.push(e):this.chatInfoList.push(e);var p=this.formatMsgTime(e.msgtime);-1===this.timeDivider[this.activeUser.id+"_"+this.activeChat].time.indexOf(p)&&(this.timeDivider[this.activeUser.id+"_"+this.activeChat].time.push(p),this.timeDivider[this.activeUser.id+"_"+this.activeChat].show[p]="1");var f={first_id:this.chatInfoList[this.chatInfoList.length-1].msgid,old_first_id:this.chatInfoList.length>0?this.chatInfoList[this.chatInfoList.length-1].msgid:0,last_id:this.chatInfoList[this.chatInfoList.length-1].msgid,position:null};this.$set(this.scrollData,this.activeUser.id+"_"+this.activeChat,f),this.changeScrollTop()}var g=this.allChatList.findIndex((function(t){return t.chatUserId==l}));if(g>-1){this.allChatList[g].content=decodeURIComponent(e.content),this.allChatList[g].msgtime=e.msgtime;var m=JSON.parse(JSON.stringify(this.allChatList[g]));if(this.allChatList.splice(g,1),this.allChatList.unshift(m),g=this.chatList.findIndex((function(t){return t.chatUserId==l})),g>-1){var v=document.getElementsByClassName("chat-list-box")[0],b=document.getElementsByClassName("chat-list-active")[0],u=this.chatList.findIndex((function(t){return t.chatUserId==i.activeChat}));if(u<g)v&&(60*(u+1)>=v.clientHeight&&v.clientHeight,v.scrollTop=v.scrollTop+60);else if(this.chatList.findIndex((function(t){return t.chatUserId==i.activeChat}))==g){var x=window.innerHeight,y=v.scrollTop,w=b.offsetTop,_=b.offsetHeight;w<y+x&&w+_>y&&v&&(v.scrollTop=0)}this.chatList[g].msgtime=e.msgtime,this.chatList[g].content=decodeURIComponent(e.content),m=JSON.parse(JSON.stringify(this.chatList[g])),this.chatList.splice(g,1),this.chatList.unshift(m)}}else{var C={chatUserId:l,content:decodeURIComponent(e.content),msgtime:e.msgtime,user:{avatar:d.avatar,id:l,name:d.name,thumb_avatar:d.thumb_avatar}};this.allChatList.unshift(C),(""==this.userOrChatName||d.name.indexOf(this.userOrChatName)>-1)&&this.chatList.unshift(C)}}}},content:function(t,i){var e=!0,a=!1,s=void 0;try{for(var n,o=t[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var c=n.value;if(c==i)return!0}}catch(r){a=!0,s=r}finally{try{e||null==o.return||o.return()}finally{if(a)throw s}}return!1},getChatInfoList:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var i,e,a,s,n,o,r,h,l=this,d=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=!(d.length>0&&void 0!==d[0])||d[0],this.chatItemLoading=!0,0!=this.activeChat){t.next=6;break}return this.isChatListLoading=!1,this.chatItemLoading=!1,t.abrupt("return",!1);case 6:return t.next=8,this.axios.post("work-msg-audit/get-msg-content",{corp_id:this.corpId,from_id:2==this.type?this.activeChat:this.activeUser.id,to_id:this.activeChat,last_time:this.lastTime,msg_type:this.msgType,search_name:this.msgName,start_date:this.sendDate&&this.sendDate.length>1?c()(this.sendDate[0]).format("YYYY-MM-DD"):"",end_date:this.sendDate&&this.sendDate.length>1?c()(this.sendDate[1]).format("YYYY-MM-DD"):"",type:this.type});case 8:e=t.sent,a=e.data,0!=a.error?this.$message.error(a.error_msg):(a.data.length>0?(s=this.chatInfoList.length>0?this.chatInfoList[0].msgid:0,this.initTimeDivider(),a.data.map((function(t){l.chatInfoList.unshift(t),l.lastTime=t.msgtime})),n=this.chatInfoList[0].msgid,o=this.chatInfoList.length-1,r=this.chatInfoList[o].msgid,h={first_id:n,old_first_id:s,last_id:r,position:null},this.$set(this.scrollData,this.activeUser.id+"_"+this.activeChat,h)):i=!1,this.previewInfo=[],this.previewRelation=[],this.$set(this.noMore,this.activeUser.id+"_"+this.activeChat,a.data.length<15),i&&this.changeScrollTop()),this.chatItemLoading=!1,this.isChatListLoading=!1;case 13:case"end":return t.stop()}}),t,this)})));function i(){return t.apply(this,arguments)}return i}()},created:function(){this.ws.setCallback(this.websocketOnMessage);var t=this;Promise.all([t.getUserList()]).then((function(i){t.$nextTick((function(){Promise.all([t.getChatList()]).then((function(i){t.$nextTick((function(){if("undefined"==typeof t.scrollData[t.activeUser.id+"_"+t.activeChat]){var i={first_id:0,old_first_id:0,last_id:0,position:null};t.$set(t.scrollData,t.activeUser.id+"_"+t.activeChat,i)}t.chatItemLoading=!0,t.getChatInfoList()}))})).catch((function(t){}))}))})).catch((function(t){}))}},u=b,x=(e("07ce"),e("9983"),e("2877")),y=Object(x["a"])(u,a,s,!1,null,"06db997b",null);i["default"]=y.exports},9983:function(t,i,e){"use strict";var a=e("767d"),s=e.n(a);s.a},a4b7:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAABXCAMAAABr5AbkAAAA9lBMVEUAAAAzgP85dv84d/85d/84dv82dP84d/8zc/04d/9AgP84d/8lZvQnaPU4d/8XWuwmZ/U5dv8kZvQ4dv85dv8iZPM4d/8AgP8gY/I3df8fYfEdYPA2dP4cXu8bXe40c/0vb/oaXe4zcv0ubvoZXO0zcvwxcPswcPsxcfsycfwycvw0cv01c/01dP42df42df83dv84d/9wnP/5+//C1f+5z//z9//L2//g6v/////n7v/Z5f+Fq/+jwP+Wt//u8/+vyP/S4P85d/85d/83eP81df84dv85dv86dP83dP85dv84dv84dv84dv83bf84df84eP87dv/cx371AAAAUnRSTlMACnXo/6Qh3/+jCNX//4P//9P//6L//QL/////////////////////////////////pf/////////////////////mi0Ywx1AWLrP24owOMkAanPlJNwAAAZdJREFUeAGkzsEWwTAQheFgCtBBKKgWtAC8/9O5my5y0kVm+u+/c68xptXuUFCRqanbo7D6NPD1cESBjSc1PqZgzlP//0zAee7tk4DD20UTzkvr7icyDh+tGnBeb+D1nLfwel55NecdvJ7Dp/B6znt4Pa+8mnMGr+fwObyAH9jteIKn8M6Z6y9FbBKBt+W1vN0fxTN/pe/P9/dnp451MwpBKAAv54UqIoqi9v1fqqn3b131zpyFEPMRwiC+Nn8T585v4ty5c+fOA0XscAoAJB9zcAm70YqaD3mzlZRX6QCMDEMOOavS0JWiqgA0o5UqmkRkHixf8yqTwiolQoZZ1d9tDriV5bQCQCOKgfjmdJqXMwAYWSMP3PBe7DMD4KAR/YpDqMXU8ERjE5HndBJOOCrRxD8PZp/T2RmfhfrmwNXyQRLHIi85p9yAPtK85/07Zf4bk+ItN+m7mQKA7Xlg/6ycO//ZENfOQgkQYXCiRLszgyEl2l0YXCnQ7QYcvHAnWze3BwMQeHp5k6PZx9ePAQr8A0gGgWCNALL6rRupCN/gAAAAAElFTkSuQmCC"},e306:function(t,i,e){t.exports=e.p+"assets/img/chat.29abd713.png"},ea7d:function(t,i,e){t.exports=e.p+"assets/img/mini-app.1b608561.png"}}]);